Default float: float32
{'mode': 'report', 'type': 'twisted', 'size': 5, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-06T19:21:25.066'}
(5000, 2, 47, 47, 1)
normalized shape: (47, 47, 1) (47, 47, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1466b02c87f0>
[0, 47, 47, 1] -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1466b02c87f0>
<keras.layers.normalization.BatchNormalization object at 0x1466b0061970>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1466b0061970>
<keras.layers.core.Dropout object at 0x1466b0061a30>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1466b0061a30>
<keras.layers.convolutional.Conv2D object at 0x1466b0061a90>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1466b0061a90>
<keras.layers.normalization.BatchNormalization object at 0x1466b0061bb0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1466b0061bb0>
<keras.layers.core.Dropout object at 0x1466b0061c70>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1466b0061c70>
latent space shape is (47, 47, 32) : 50 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1466b027f220>
[0, 47, 47, 32] -> (0, 47, 47, 32) : <keras.layers.core.Reshape object at 0x1466b027f220>
<keras.layers.convolutional.Conv2DTranspose object at 0x1466b027f250>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x1466b027f250>
<keras.layers.normalization.BatchNormalization object at 0x1466b027f490>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1466b027f490>
<keras.layers.core.Dropout object at 0x1466b027f9d0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1466b027f9d0>
<keras.layers.convolutional.Conv2DTranspose object at 0x1466b027f3d0>
(0, 47, 47, 32) -> (0, 47, 47, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x1466b027f3d0>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x14668c96f3d0> with <keras_radam.optimizers.RAdam object at 0x14668c3e2eb0>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x14668c9700d0>.
Network compiled
metrics train {'loss': 3544.7430636935765, 'tau': 5.0, 'pdiff_z1z2': 0.0003457743137712694, 'pdiff_z0z3': 0.00033610733872693445, 'pdiff_z0z1': 0.16732000476784176, 'pdiff_z0z2': 0.1673868563440111, 'kl_z0': 60.132320149739584, 'kl_z1': 60.12987730238173, 'kl_a_z0': 2911.8194905598957, 'kl_a_z1': 2912.3583713107637, 'kl_z1z2': 0.06402321273667945, 'kl_z0z3': 0.06454510550118155, 'x0y0': 10.330778333875868, 'x1y1': 10.605440372890897, 'x0y3': 24.844803704155815, 'x1y2': 24.86201157040066, 'elbo': 3000.3810465494794}
metrics test {'loss': 2536.4287109375, 'tau': 5.0, 'pdiff_z1z2': 0.0007598751690238714, 'pdiff_z0z3': 0.0008978490368463099, 'pdiff_z0z1': 0.1661600023508072, 'pdiff_z0z2': 0.16618309915065765, 'kl_z0': 60.28025817871094, 'kl_z1': 60.23632049560547, 'kl_a_z0': 1868.32568359375, 'kl_a_z1': 1868.4525146484375, 'kl_z1z2': 0.23027296364307404, 'kl_z0z3': 0.20591288805007935, 'x0y0': 10.253170013427734, 'x1y1': 10.555105209350586, 'x0y3': 87.22341918945312, 'x1y2': 68.56037139892578, 'elbo': 1983.3084716796875}
sae mse vanilla train 9.477692736681842e-05
sae mse vanilla test 9.419773708527348e-05
sae mse gaussian train 9.47769274054764e-05
sae mse gaussian test 9.41977344552366e-05
sae activation train 0.4994422197341919
sae activation test 0.5005999803543091
sae ever_1 train 50.0
sae ever_1 test 50.0
sae ever_0 train 50.0
sae ever_0 test 50.0
sae effective train 50.0
sae effective test 50.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 9.477689585137677e-05, 9.477689583118398e-05, 9.477689581426221e-05, 9.477689583187505e-05, 9.477689589631376e-05, 9.477689585085865e-05, 9.477689587281712e-05, 9.477689584247478e-05, 9.477689579599199e-05], 'xs12': [9.477689585137677e-05, 5.3257706101871466e-17, 5.342432674701925e-17, 5.300660053767997e-17, 5.3002312433384494e-17, 5.2940230874051164e-17, 5.3112314219964246e-17, 5.285514376752151e-17, 5.331379556484746e-17, 5.260166915805566e-17], 'xs13': [0.0900946325683742, 5.288792989828066e-17, 5.275982939989825e-17, 5.2839132859584933e-17, 5.295733035167386e-17, 5.2977037102587324e-17, 5.316217997601139e-17, 5.354447969407625e-17, 5.332800321904867e-17, 5.2778924037158423e-17], 'xs34': [0.09009463256946439, 5.2876782812345897e-17, 5.323297340155613e-17, 5.289161912381265e-17, 5.3548579201192063e-17, 5.35155813121961e-17, 5.289902073593377e-17, 5.2874890223104375e-17, 5.3254384144531454e-17, 5.292381299325321e-17], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 9.419770574858326e-05, 9.419770555871984e-05, 9.4197705400437e-05, 9.419770678888296e-05, 9.419770610875813e-05, 9.419770553771704e-05, 9.419770489582894e-05, 9.419770604041513e-05, 9.419770480265362e-05], 'xs12': [9.419770574858326e-05, 2.402225884236427e-15, 2.4014326378813235e-15, 2.408810930126619e-15, 2.399263598261642e-15, 2.407365044885656e-15, 2.404957989007796e-15, 2.3958146918586594e-15, 2.400306507577949e-15, 2.4066097032549418e-15], 'xs13': [0.09011815139840224, 2.3988369054144627e-15, 2.4188207419807966e-15, 2.4194384407575818e-15, 2.4030697408101293e-15, 2.4132548884843886e-15, 2.4151109494300596e-15, 2.4149112614127444e-15, 2.414849004491121e-15, 2.4012022449196703e-15], 'xs34': [0.09011815143564297, 2.4023914791776154e-15, 2.4140477113230186e-15, 2.4029727555376686e-15, 2.4061736930453426e-15, 2.408018954320936e-15, 2.4054674793255694e-15, 2.408554067385364e-15, 2.413316721889538e-15, 2.4103076373444172e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.00022509745074820284
x1y2 mse vanilla test 0.0006207368416867971
x1y2 mse gaussian train 0.00022509745073939243
x1y2 mse gaussian test 0.0006207368381136336
z1z2 mae vanilla train 9.333333582617342e-05
z1z2 mae vanilla test 0.00039999998989515007
z1z2 mae gaussian train 9.333333582617342e-05
z1z2 mae gaussian test 0.00039999998989515007
z1z2 match_prob vanilla train 0.9953428
z1z2 match_prob vanilla test 0.9801593
z1z2 match_prob gaussian train 0.9953428
z1z2 match_prob gaussian test 0.9801593
z1z2 allmatch_prob vanilla train 0.99777776
z1z2 allmatch_prob vanilla test 0.988
z1z2 allmatch_prob gaussian train 0.99777776
z1z2 allmatch_prob gaussian test 0.988
[0 0 0 ... 0 0 0]
771
z1z2 xor train 0.0
[0 0 0 ... 0 0 0]
198
z1z2 xor test 0.0
[0 0 0 ... 0 0 0]
771
z1z2 compiled_action train 771.0
[0 0 0 ... 0 0 0]
198
z1z2 compiled_action test 198.0
kl_a_z0 train 2911.8194905598957
kl_a_z0 test 1868.32568359375
x0y3 mse vanilla train 0.00022494167480105402
x0y3 mse vanilla test 0.0007897096089470923
x0y3 mse gaussian train 0.0002249416747743246
x0y3 mse gaussian test 0.0007897096166615897
z0z3 mae vanilla train 9.333333582617342e-05
z0z3 mae vanilla test 0.0004799999878741801
z0z3 mae gaussian train 9.333333582617342e-05
z0z3 mae gaussian test 0.0004799999878741801
z0z3 match_prob vanilla train 0.9953428
z0z3 match_prob vanilla test 0.9762386
z0z3 match_prob gaussian train 0.9953428
z0z3 match_prob gaussian test 0.9762386
z0z3 allmatch_prob vanilla train 0.99777776
z0z3 allmatch_prob vanilla test 0.988
z0z3 allmatch_prob gaussian train 0.99777776
z0z3 allmatch_prob gaussian test 0.988
[0 0 0 ... 0 0 0]
771
z0z3 xor train 0.0
[0 0 0 ... 0 0 0]
198
z0z3 xor test 0.0
[0 0 0 ... 0 0 0]
771
z0z3 compiled_action train 771.0
[0 0 0 ... 0 0 0]
198
z0z3 compiled_action test 198.0
action true_num_actions train 771
action true_num_actions test 198
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 3544.7430636935765, 'tau': 5.0, 'pdiff_z1z2': 0.0003457743137712694, 'pdiff_z0z3': 0.00033610733872693445, 'pdiff_z0z1': 0.16732000476784176, 'pdiff_z0z2': 0.1673868563440111, 'kl_z0': 60.132320149739584, 'kl_z1': 60.12987730238173, 'kl_a_z0': 2911.8194905598957, 'kl_a_z1': 2912.3583713107637, 'kl_z1z2': 0.06402321273667945, 'kl_z0z3': 0.06454510550118155, 'x0y0': 10.330778333875868, 'x1y1': 10.605440372890897, 'x0y3': 24.844803704155815, 'x1y2': 24.86201157040066, 'elbo': 3000.3810465494794}, 'test': {'loss': 2536.4287109375, 'tau': 5.0, 'pdiff_z1z2': 0.0007598751690238714, 'pdiff_z0z3': 0.0008978490368463099, 'pdiff_z0z1': 0.1661600023508072, 'pdiff_z0z2': 0.16618309915065765, 'kl_z0': 60.28025817871094, 'kl_z1': 60.23632049560547, 'kl_a_z0': 1868.32568359375, 'kl_a_z1': 1868.4525146484375, 'kl_z1z2': 0.23027296364307404, 'kl_z0z3': 0.20591288805007935, 'x0y0': 10.253170013427734, 'x1y1': 10.555105209350586, 'x0y3': 87.22341918945312, 'x1y2': 68.56037139892578, 'elbo': 1983.3084716796875}}, 'sae': {'mse': {'vanilla': {'train': 9.477692736681842e-05, 'test': 9.419773708527348e-05}, 'gaussian': {'train': 9.47769274054764e-05, 'test': 9.41977344552366e-05}}, 'activation': {'train': 0.4994422197341919, 'test': 0.5005999803543091}, 'ever_1': {'train': 50.0, 'test': 50.0}, 'ever_0': {'train': 50.0, 'test': 50.0}, 'effective': {'train': 50.0, 'test': 50.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 9.477689585137677e-05, 9.477689583118398e-05, 9.477689581426221e-05, 9.477689583187505e-05, 9.477689589631376e-05, 9.477689585085865e-05, 9.477689587281712e-05, 9.477689584247478e-05, 9.477689579599199e-05], 'xs12': [9.477689585137677e-05, 5.3257706101871466e-17, 5.342432674701925e-17, 5.300660053767997e-17, 5.3002312433384494e-17, 5.2940230874051164e-17, 5.3112314219964246e-17, 5.285514376752151e-17, 5.331379556484746e-17, 5.260166915805566e-17], 'xs13': [0.0900946325683742, 5.288792989828066e-17, 5.275982939989825e-17, 5.2839132859584933e-17, 5.295733035167386e-17, 5.2977037102587324e-17, 5.316217997601139e-17, 5.354447969407625e-17, 5.332800321904867e-17, 5.2778924037158423e-17], 'xs34': [0.09009463256946439, 5.2876782812345897e-17, 5.323297340155613e-17, 5.289161912381265e-17, 5.3548579201192063e-17, 5.35155813121961e-17, 5.289902073593377e-17, 5.2874890223104375e-17, 5.3254384144531454e-17, 5.292381299325321e-17], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 9.419770574858326e-05, 9.419770555871984e-05, 9.4197705400437e-05, 9.419770678888296e-05, 9.419770610875813e-05, 9.419770553771704e-05, 9.419770489582894e-05, 9.419770604041513e-05, 9.419770480265362e-05], 'xs12': [9.419770574858326e-05, 2.402225884236427e-15, 2.4014326378813235e-15, 2.408810930126619e-15, 2.399263598261642e-15, 2.407365044885656e-15, 2.404957989007796e-15, 2.3958146918586594e-15, 2.400306507577949e-15, 2.4066097032549418e-15], 'xs13': [0.09011815139840224, 2.3988369054144627e-15, 2.4188207419807966e-15, 2.4194384407575818e-15, 2.4030697408101293e-15, 2.4132548884843886e-15, 2.4151109494300596e-15, 2.4149112614127444e-15, 2.414849004491121e-15, 2.4012022449196703e-15], 'xs34': [0.09011815143564297, 2.4023914791776154e-15, 2.4140477113230186e-15, 2.4029727555376686e-15, 2.4061736930453426e-15, 2.408018954320936e-15, 2.4054674793255694e-15, 2.408554067385364e-15, 2.413316721889538e-15, 2.4103076373444172e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.00022509745074820284, 'test': 0.0006207368416867971}, 'gaussian': {'train': 0.00022509745073939243, 'test': 0.0006207368381136336}}}, 'z1z2': {'mae': {'vanilla': {'train': 9.333333582617342e-05, 'test': 0.00039999998989515007}, 'gaussian': {'train': 9.333333582617342e-05, 'test': 0.00039999998989515007}}, 'match_prob': {'vanilla': {'train': 0.9953428, 'test': 0.9801593}, 'gaussian': {'train': 0.9953428, 'test': 0.9801593}}, 'allmatch_prob': {'vanilla': {'train': 0.99777776, 'test': 0.988}, 'gaussian': {'train': 0.99777776, 'test': 0.988}}, 'xor': {'train': 0.0, 'test': 0.0}, 'compiled_action': {'train': 771.0, 'test': 198.0}}, 'kl_a_z0': {'train': 2911.8194905598957, 'test': 1868.32568359375}, 'x0y3': {'mse': {'vanilla': {'train': 0.00022494167480105402, 'test': 0.0007897096089470923}, 'gaussian': {'train': 0.0002249416747743246, 'test': 0.0007897096166615897}}}, 'z0z3': {'mae': {'vanilla': {'train': 9.333333582617342e-05, 'test': 0.0004799999878741801}, 'gaussian': {'train': 9.333333582617342e-05, 'test': 0.0004799999878741801}}, 'match_prob': {'vanilla': {'train': 0.9953428, 'test': 0.9762386}, 'gaussian': {'train': 0.9953428, 'test': 0.9762386}}, 'allmatch_prob': {'vanilla': {'train': 0.99777776, 'test': 0.988}, 'gaussian': {'train': 0.99777776, 'test': 0.988}}, 'xor': {'train': 0.0, 'test': 0.0}, 'compiled_action': {'train': 771.0, 'test': 198.0}}, 'action': {'true_num_actions': {'train': 771, 'test': 198}}}
Default float: float32
{'mode': 'dump', 'type': 'twisted', 'size': 5, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-06T19:21:25.066'}
(5000, 2, 47, 47, 1)
normalized shape: (47, 47, 1) (47, 47, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1532744897f0>
[0, 47, 47, 1] -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1532744897f0>
<keras.layers.normalization.BatchNormalization object at 0x15327336c970>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x15327336c970>
<keras.layers.core.Dropout object at 0x15327336ca30>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x15327336ca30>
<keras.layers.convolutional.Conv2D object at 0x15327336ca90>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x15327336ca90>
<keras.layers.normalization.BatchNormalization object at 0x15327336cbb0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x15327336cbb0>
<keras.layers.core.Dropout object at 0x15327336cc70>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x15327336cc70>
latent space shape is (47, 47, 32) : 50 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x15327443e220>
[0, 47, 47, 32] -> (0, 47, 47, 32) : <keras.layers.core.Reshape object at 0x15327443e220>
<keras.layers.convolutional.Conv2DTranspose object at 0x15327443e250>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x15327443e250>
<keras.layers.normalization.BatchNormalization object at 0x15327443e490>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x15327443e490>
<keras.layers.core.Dropout object at 0x15327443e9d0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x15327443e9d0>
<keras.layers.convolutional.Conv2DTranspose object at 0x15327443e3d0>
(0, 47, 47, 32) -> (0, 47, 47, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x15327443e3d0>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/actions.csv
[0 0 0 ... 0 0 0]
799
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/available_actions.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_add4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_del4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_add4+ids.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_del4+ids.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_pos4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_neg4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_pos4+ids.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/action_neg4+ids.csv
IN DUMP 1
make: Entering directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
make: Nothing to be done for 'all'.
make: Leaving directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
Default float: float32
@[     0.385 +     0.385] loaded puzzle
Loading networks from samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/ (with failure allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x147f20801250>
[0, 47, 47, 1] -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x147f20801250>
<keras.layers.normalization.BatchNormalization object at 0x147f20801a60>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x147f20801a60>
<keras.layers.core.Dropout object at 0x147f208016d0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x147f208016d0>
<keras.layers.convolutional.Conv2D object at 0x147f20801b50>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x147f20801b50>
<keras.layers.normalization.BatchNormalization object at 0x147f207b4280>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x147f207b4280>
<keras.layers.core.Dropout object at 0x147f207b4340>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x147f207b4340>
latent space shape is (47, 47, 32) : 50 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x147f207b4910>
[0, 47, 47, 32] -> (0, 47, 47, 32) : <keras.layers.core.Reshape object at 0x147f207b4910>
<keras.layers.convolutional.Conv2DTranspose object at 0x147f207b4940>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x147f207b4940>
<keras.layers.normalization.BatchNormalization object at 0x147f207b4b20>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x147f207b4b20>
<keras.layers.core.Dropout object at 0x147f207b4eb0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x147f207b4eb0>
<keras.layers.convolutional.Conv2DTranspose object at 0x147f207b4a60>
(0, 47, 47, 32) -> (0, 47, 47, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x147f207b4a60>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
loading additional networks
Network loaded
@[     4.832 +     4.447] loaded sae
@[     4.832 +     0.000] loaded puzzle
@[     4.832 +     0.000] loading init/goal
init (input) min: -1.0234754747926234 max: 1.7298432284194147
init (recon) min: -0.13465284 max: 0.08846468
init MSE: 0.3593199867982258
goal (input) min: -1.0234754747926234 max: 0.0
goal (recon) min: -0.10490612 max: 0.078608
goal MSE: 0.3445321271805616
problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_init_goal_reconstruction.1.png
2 images have some panels which match 0 or >2 panels, out of which
2 images have some panels which are unlike any panels
0 images have some panels which match >2 panels
0 images have panels (all of them) which match exactly 1 panel each
Init/Goal state reconstruction failed!
But we continue anyways...
@[    11.620 +     6.788] loaded init/goal
@[    11.620 +     0.000] start planning
@[    11.620 +     0.000] start generating problem
['helper/ama3-problem.sh', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.ig', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.pddl']
helper/ama3-problem.sh problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.ig problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.pddl
@[    11.915 +     0.295] finished generating problem
@[    11.916 +     0.000] start planning
['helper/fd-latest.sh', '--search astar(blind())', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.pddl', 'samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/domain.pddl']
Running limit.sh(42102): -t 600 -m 8000000 -- planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.pddl samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/domain.pddl
limit.sh(42102): mem: 8000000 kB, time: 600 sec
limit.sh(42102): pwd: /g100_work/uBS21_InfGer_0/latplan-5.0.0
limit.sh(42102): command to execute: planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.pddl samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/domain.pddl
limit.sh(42102): note: time precision is 0.5 sec
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0/planner-scripts ...
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0 ...
found!: /g100_work/uBS21_InfGer_0/latplan-5.0.0/downward
common.sh(42115): exiting...
[32;1m--------------------------------------------------------
Result:
--------------------------------------------------------[0m
limit.sh(42102): Error occured. status: 2
@[    40.130 +    28.215] finished planning
['helper/fd-parser.awk', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.log']
['main.py', 'remove_duplicates', '../samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/domain.pddl', '../problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.pddl']
SELF REQUIREMENTS
['main.py', 'remove_not_from_prob', '../samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T19:21:25.066/domain.pddl', '../problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T19:21:25.066_domain_blind_problem.pddl']
Parsing...
Parsing: [0.160s CPU, 0.162s wall-clock]
Normalizing task... [0.030s CPU, 0.022s wall-clock]
Instantiating...
Generating Datalog program... [0.010s CPU, 0.013s wall-clock]
Normalizing Datalog program...
Trivial rules: Converted to facts.
Normalizing Datalog program: [0.040s CPU, 0.060s wall-clock]
Preparing model... [0.030s CPU, 0.024s wall-clock]
Generated 4326 rules.
Computing model... [0.010s CPU, 0.008s wall-clock]
605 relevant atoms
0 auxiliary atoms
605 final queue length
2981 total queue pushes
Completing instantiation... [0.020s CPU, 0.027s wall-clock]
Instantiating: [0.110s CPU, 0.135s wall-clock]
Computing fact groups...
Finding invariants...
50 initial candidates
Finding invariants: [10.600s CPU, 10.630s wall-clock]
Checking invariant weight... [0.000s CPU, 0.000s wall-clock]
Instantiating groups... [0.000s CPU, 0.000s wall-clock]
Collecting mutex groups... [0.000s CPU, 0.000s wall-clock]
Choosing groups...
34 uncovered facts
Choosing groups: [0.000s CPU, 0.000s wall-clock]
Building translation key... [0.000s CPU, 0.000s wall-clock]
Computing fact groups: [10.600s CPU, 10.630s wall-clock]
Building STRIPS to SAS dictionary... [0.000s CPU, 0.000s wall-clock]
Building dictionary for full mutex groups... [0.000s CPU, 0.000s wall-clock]
Building mutex information...
Building mutex information: [0.000s CPU, 0.000s wall-clock]
Translating task...
Processing axioms...
Simplifying axioms... [0.000s CPU, 0.000s wall-clock]
Translator axioms removed by simplifying: 0
Computing negative axioms... [0.000s CPU, 0.000s wall-clock]
Processing axioms: [0.010s CPU, 0.003s wall-clock]
Goal violates a mutex! Generating unsolvable task...
Translating task: [0.010s CPU, 0.003s wall-clock]
0 effect conditions simplified
0 implied preconditions added
Detecting unreachable propositions...
Simplified to trivially false goal! Generating unsolvable task...
Detecting unreachable propositions: [0.000s CPU, 0.000s wall-clock]
Translator variables: 1
Translator derived variables: 0
Translator facts: 2
Translator goal facts: 1
Translator mutex groups: 0
Translator total mutex groups size: 0
Translator operators: 0
Translator axioms: 0
Translator task size: 4
Translator peak memory: 141120 KB
Writing output... [0.000s CPU, 0.002s wall-clock]
Done! [10.910s CPU, 10.956s wall-clock]
Building causal graph...
The causal graph is acyclic.
1 variables of 1 necessary
0 of 0 mutex groups necessary.
0 of 0 operators necessary.
0 of 0 axiom rules necessary.
Initializing mutex computation...
Mutex computation initialized with 2 fluents.
iteration for mutex detection and operator pruning
Initialize m_index fw
Initialized mvalues forward: reached=1, notReached=1, spurious=2
Initialize m_ops fw
Computing mutexes...
Mutex computation finished with reached=1, notReached=1, spurious=2
0 operators are spurious because were not triggered
Unsolvable task in preprocessor
done
