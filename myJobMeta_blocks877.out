Default float: float32
{'mode': 'report', 'track': 'cylinders-4-flat', 'num_examples': 20000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-06T11:28:54.877'}
loaded. picsize: [100 150   3]
(20000, 2, 30, 45, 3)
normalized shape: (30, 45, 3) (30, 45, 3)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 30 W: 45 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14c5cd3227c0>
[0, 30, 45, 3] -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2D object at 0x14c5cd3227c0>
<keras.layers.normalization.BatchNormalization object at 0x14c5cc205940>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x14c5cc205940>
<keras.layers.core.Dropout object at 0x14c5cc205a00>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x14c5cc205a00>
<keras.layers.convolutional.Conv2D object at 0x14c5cc205a60>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2D object at 0x14c5cc205a60>
<keras.layers.normalization.BatchNormalization object at 0x14c5cc205b80>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x14c5cc205b80>
<keras.layers.core.Dropout object at 0x14c5cc205c40>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x14c5cc205c40>
latent space shape is (30, 45, 32) : 300 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 30 W: 45 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14c5cc21f1f0>
[0, 30, 45, 32] -> (0, 30, 45, 32) : <keras.layers.core.Reshape object at 0x14c5cc21f1f0>
<keras.layers.convolutional.Conv2DTranspose object at 0x14c5cc21f220>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14c5cc21f220>
<keras.layers.normalization.BatchNormalization object at 0x14c5cc21f460>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x14c5cc21f460>
<keras.layers.core.Dropout object at 0x14c5cc21f9a0>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x14c5cc21f9a0>
<keras.layers.convolutional.Conv2DTranspose object at 0x14c5cc21f3a0>
(0, 30, 45, 32) -> (0, 30, 45, 3) : <keras.layers.convolutional.Conv2DTranspose object at 0x14c5cc21f3a0>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x14c5bf5f4490> with <keras_radam.optimizers.RAdam object at 0x14c5bf06be80>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x14c5bf660dc0>.
Network compiled
metrics train {'loss': 9349.12248263889, 'tau': 5.0, 'pdiff_z1z2': 0.010751135750777192, 'pdiff_z0z3': 0.016471340010563534, 'pdiff_z0z1': 0.14010993275377487, 'pdiff_z0z2': 0.1383644653691186, 'kl_z0': 106.50787404378255, 'kl_z1': 128.81448635525174, 'kl_a_z0': 3186.103304036458, 'kl_a_z1': 3185.746858723958, 'kl_z1z2': 21.32528504265679, 'kl_z0z3': 7.502029440138075, 'x0y0': 1482.2180935329861, 'x1y1': 1758.72138671875, 'x0y3': 3534.624929470486, 'x1y2': 3806.167415364583, 'elbo': 7576.695844184028}
metrics test {'loss': 10141.135546875, 'tau': 5.0, 'pdiff_z1z2': 0.015114649944007397, 'pdiff_z0z3': 0.01955897770822048, 'pdiff_z0z1': 0.13914624154567717, 'pdiff_z0z2': 0.13661641180515288, 'kl_z0': 105.72723388671875, 'kl_z1': 127.97700500488281, 'kl_a_z0': 2861.34306640625, 'kl_a_z1': 2862.18916015625, 'kl_z1z2': 26.95033988952637, 'kl_z0z3': 14.553547668457032, 'x0y0': 1539.01396484375, 'x1y1': 1795.3104248046875, 'x0y3': 5102.021728515625, 'x1y2': 5188.0068359375, 'elbo': 8062.24462890625}
sae mse vanilla train 0.008002293296158314
sae mse vanilla test 0.00823290180414915
sae mse gaussian train 0.00797694269567728
sae mse gaussian test 0.008197873830795288
sae activation train 0.13061222434043884
sae activation test 0.12938499450683594
sae ever_1 train 300.0
sae ever_1 test 300.0
sae ever_0 train 300.0
sae ever_0 test 300.0
sae effective train 300.0
sae effective test 300.0
sae variance gaussian train {'max': 0.25, 'min': 0.0, 'mean': 1.6544390746275894e-05, 'median': 0.0}
sae variance gaussian test {'max': 0.25, 'min': 0.0, 'mean': 1.9000002794200554e-05, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.008002293296158314, 0.008074892684817314, 0.008080871775746346, 0.008081524632871151, 0.008081525564193726, 0.008081525564193726, 0.008081525564193726, 0.0080815264955163, 0.008081525564193726], 'xs12': [0.008002293296158314, 5.837361459271051e-05, 3.760889285331359e-06, 1.946051781942515e-07, 8.246135945030788e-15, 8.235564973849054e-15, 8.232203100081402e-15, 8.241895698096833e-15, 8.236551767232606e-15, 8.240256689343896e-15], 'xs13': [0.09809346679592201, 9.635833703214303e-05, 1.423240337317111e-05, 7.999312401807401e-06, 7.648058272025082e-06, 7.648058272025082e-06, 7.648058272025082e-06, 7.64805736253038e-06, 7.648058272025082e-06, 7.648058272025082e-06], 'xs34': [0.09798809854801806, 8.11167192296125e-05, 6.0908737395948265e-06, 3.512549255901831e-07, 8.237652910064036e-15, 8.242018517874185e-15, 8.249715506265885e-15, 8.232549536556829e-15, 8.23311704863149e-15, 8.252334532138795e-15], 'zs01': [0.0, 7.981481758179143e-05, 8.499999967170879e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05], 'zs12': [7.981481758179143e-05, 5.185185273148818e-06, 4.6296295863612613e-07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.00013435185246635228, 2.1574074708041735e-05, 1.3518518244381994e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05], 'zs34': [0.00011333333532093093, 8.05555555416504e-06, 7.407407451864856e-07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.008232902735471725, 0.008341461420059204, 0.008348616771399975, 0.008354236371815205, 0.00835423544049263, 0.008354236371815205, 0.00835423544049263, 0.008354236371815205, 0.008354234509170055], 'xs12': [0.008232902735471725, 9.309691085945815e-05, 3.1112078886508243e-06, 1.006231741484953e-06, 8.162942063017365e-15, 8.121313781791605e-15, 8.108618451978158e-15, 8.137208355046832e-15, 8.118062022307096e-15, 8.130310118724393e-15], 'xs13': [0.09833988930774748, 0.0001453631412005052, 2.007110924751032e-05, 7.237044883368071e-06, 6.230814506125171e-06, 6.230814506125171e-06, 6.230813596630469e-06, 6.230814506125171e-06, 6.230813596630469e-06, 6.230814506125171e-06], 'xs34': [0.09817801257432683, 0.00012312828039284796, 1.1382629963918589e-05, 1.0062320825454663e-06, 8.06068401046009e-15, 8.104855084593507e-15, 8.061149031548132e-15, 8.110201556556576e-15, 8.099669548890416e-15, 8.168583302446079e-15], 'zs01': [0.0, 0.00011333333532093093, 0.00011999999696854502, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795], 'zs12': [0.00011333333532093093, 6.666666649834951e-06, 1.6666666624587378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.000183333337190561, 2.499999936844688e-05, 9.999999747378752e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06], 'zs34': [0.00015833333600312471, 1.4999999621068127e-05, 1.6666666624587378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.018795935437083244
x1y2 mse vanilla test 0.02561977691948414
x1y2 mse gaussian train 0.018797550350427628
x1y2 mse gaussian test 0.02559126727283001
z1z2 mae vanilla train 0.009534259326756
z1z2 mae vanilla test 0.01418666634708643
z1z2 mae gaussian train 0.009494444355368614
z1z2 mae gaussian test 0.014109999872744083
z1z2 match_prob vanilla train 0.05526294
z1z2 match_prob vanilla test 0.013395239
z1z2 match_prob gaussian train 0.056022044
z1z2 match_prob gaussian test 0.01368781
z1z2 allmatch_prob vanilla train 0.23544444
z1z2 allmatch_prob vanilla test 0.155
z1z2 allmatch_prob gaussian train 0.23594445
z1z2 allmatch_prob gaussian test 0.155
[0 9 3 ... 2 0 2]
2550
z1z2 xor train 0.014901961
[0 1 1 ... 0 0 0]
773
z1z2 xor test 0.015523933
[0 9 3 ... 2 0 2]
2550
z1z2 compiled_action train 2589.0
[0 1 1 ... 0 0 0]
773
z1z2 compiled_action test 785.0
kl_a_z0 train 3186.103304036458
kl_a_z0 test 2861.34306640625
x0y3 mse vanilla train 0.017454924061894417
x0y3 mse vanilla test 0.025195179507136345
x0y3 mse gaussian train 0.017487552016973495
x0y3 mse gaussian test 0.02549040876328945
z0z3 mae vanilla train 0.015170370228588581
z0z3 mae vanilla test 0.018596665933728218
z0z3 mae gaussian train 0.015142407268285751
z0z3 mae gaussian test 0.018559999763965607
z0z3 match_prob vanilla train 0.0075436654
z0z3 match_prob vanilla test 0.0025244027
z0z3 match_prob gaussian train 0.007599866
z0z3 match_prob gaussian test 0.0025502522
z0z3 allmatch_prob vanilla train 0.061666667
z0z3 allmatch_prob vanilla test 0.042
z0z3 allmatch_prob gaussian train 0.061944444
z0z3 allmatch_prob gaussian test 0.042
[0 9 3 ... 2 0 2]
2550
z0z3 xor train 0.009411764
[0 1 1 ... 0 0 0]
773
z0z3 xor test 0.0064683054
[0 9 3 ... 2 0 2]
2550
z0z3 compiled_action train 2611.0
[0 1 1 ... 0 0 0]
773
z0z3 compiled_action test 789.0
action true_num_actions train 2550
action true_num_actions test 773
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 9349.12248263889, 'tau': 5.0, 'pdiff_z1z2': 0.010751135750777192, 'pdiff_z0z3': 0.016471340010563534, 'pdiff_z0z1': 0.14010993275377487, 'pdiff_z0z2': 0.1383644653691186, 'kl_z0': 106.50787404378255, 'kl_z1': 128.81448635525174, 'kl_a_z0': 3186.103304036458, 'kl_a_z1': 3185.746858723958, 'kl_z1z2': 21.32528504265679, 'kl_z0z3': 7.502029440138075, 'x0y0': 1482.2180935329861, 'x1y1': 1758.72138671875, 'x0y3': 3534.624929470486, 'x1y2': 3806.167415364583, 'elbo': 7576.695844184028}, 'test': {'loss': 10141.135546875, 'tau': 5.0, 'pdiff_z1z2': 0.015114649944007397, 'pdiff_z0z3': 0.01955897770822048, 'pdiff_z0z1': 0.13914624154567717, 'pdiff_z0z2': 0.13661641180515288, 'kl_z0': 105.72723388671875, 'kl_z1': 127.97700500488281, 'kl_a_z0': 2861.34306640625, 'kl_a_z1': 2862.18916015625, 'kl_z1z2': 26.95033988952637, 'kl_z0z3': 14.553547668457032, 'x0y0': 1539.01396484375, 'x1y1': 1795.3104248046875, 'x0y3': 5102.021728515625, 'x1y2': 5188.0068359375, 'elbo': 8062.24462890625}}, 'sae': {'mse': {'vanilla': {'train': 0.008002293296158314, 'test': 0.00823290180414915}, 'gaussian': {'train': 0.00797694269567728, 'test': 0.008197873830795288}}, 'activation': {'train': 0.13061222434043884, 'test': 0.12938499450683594}, 'ever_1': {'train': 300.0, 'test': 300.0}, 'ever_0': {'train': 300.0, 'test': 300.0}, 'effective': {'train': 300.0, 'test': 300.0}, 'variance': {'gaussian': {'train': {'max': 0.25, 'min': 0.0, 'mean': 1.6544390746275894e-05, 'median': 0.0}, 'test': {'max': 0.25, 'min': 0.0, 'mean': 1.9000002794200554e-05, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.008002293296158314, 0.008074892684817314, 0.008080871775746346, 0.008081524632871151, 0.008081525564193726, 0.008081525564193726, 0.008081525564193726, 0.0080815264955163, 0.008081525564193726], 'xs12': [0.008002293296158314, 5.837361459271051e-05, 3.760889285331359e-06, 1.946051781942515e-07, 8.246135945030788e-15, 8.235564973849054e-15, 8.232203100081402e-15, 8.241895698096833e-15, 8.236551767232606e-15, 8.240256689343896e-15], 'xs13': [0.09809346679592201, 9.635833703214303e-05, 1.423240337317111e-05, 7.999312401807401e-06, 7.648058272025082e-06, 7.648058272025082e-06, 7.648058272025082e-06, 7.64805736253038e-06, 7.648058272025082e-06, 7.648058272025082e-06], 'xs34': [0.09798809854801806, 8.11167192296125e-05, 6.0908737395948265e-06, 3.512549255901831e-07, 8.237652910064036e-15, 8.242018517874185e-15, 8.249715506265885e-15, 8.232549536556829e-15, 8.23311704863149e-15, 8.252334532138795e-15], 'zs01': [0.0, 7.981481758179143e-05, 8.499999967170879e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05, 8.546296157874167e-05], 'zs12': [7.981481758179143e-05, 5.185185273148818e-06, 4.6296295863612613e-07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.00013435185246635228, 2.1574074708041735e-05, 1.3518518244381994e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05, 1.2777777556038927e-05], 'zs34': [0.00011333333532093093, 8.05555555416504e-06, 7.407407451864856e-07, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.008232902735471725, 0.008341461420059204, 0.008348616771399975, 0.008354236371815205, 0.00835423544049263, 0.008354236371815205, 0.00835423544049263, 0.008354236371815205, 0.008354234509170055], 'xs12': [0.008232902735471725, 9.309691085945815e-05, 3.1112078886508243e-06, 1.006231741484953e-06, 8.162942063017365e-15, 8.121313781791605e-15, 8.108618451978158e-15, 8.137208355046832e-15, 8.118062022307096e-15, 8.130310118724393e-15], 'xs13': [0.09833988930774748, 0.0001453631412005052, 2.007110924751032e-05, 7.237044883368071e-06, 6.230814506125171e-06, 6.230814506125171e-06, 6.230813596630469e-06, 6.230814506125171e-06, 6.230813596630469e-06, 6.230814506125171e-06], 'xs34': [0.09817801257432683, 0.00012312828039284796, 1.1382629963918589e-05, 1.0062320825454663e-06, 8.06068401046009e-15, 8.104855084593507e-15, 8.061149031548132e-15, 8.110201556556576e-15, 8.099669548890416e-15, 8.168583302446079e-15], 'zs01': [0.0, 0.00011333333532093093, 0.00011999999696854502, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795, 0.00012166666419943795], 'zs12': [0.00011333333532093093, 6.666666649834951e-06, 1.6666666624587378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.000183333337190561, 2.499999936844688e-05, 9.999999747378752e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06, 8.333333425980527e-06], 'zs34': [0.00015833333600312471, 1.4999999621068127e-05, 1.6666666624587378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.018795935437083244, 'test': 0.02561977691948414}, 'gaussian': {'train': 0.018797550350427628, 'test': 0.02559126727283001}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.009534259326756, 'test': 0.01418666634708643}, 'gaussian': {'train': 0.009494444355368614, 'test': 0.014109999872744083}}, 'match_prob': {'vanilla': {'train': 0.05526294, 'test': 0.013395239}, 'gaussian': {'train': 0.056022044, 'test': 0.01368781}}, 'allmatch_prob': {'vanilla': {'train': 0.23544444, 'test': 0.155}, 'gaussian': {'train': 0.23594445, 'test': 0.155}}, 'xor': {'train': 0.014901961, 'test': 0.015523933}, 'compiled_action': {'train': 2589.0, 'test': 785.0}}, 'kl_a_z0': {'train': 3186.103304036458, 'test': 2861.34306640625}, 'x0y3': {'mse': {'vanilla': {'train': 0.017454924061894417, 'test': 0.025195179507136345}, 'gaussian': {'train': 0.017487552016973495, 'test': 0.02549040876328945}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.015170370228588581, 'test': 0.018596665933728218}, 'gaussian': {'train': 0.015142407268285751, 'test': 0.018559999763965607}}, 'match_prob': {'vanilla': {'train': 0.0075436654, 'test': 0.0025244027}, 'gaussian': {'train': 0.007599866, 'test': 0.0025502522}}, 'allmatch_prob': {'vanilla': {'train': 0.061666667, 'test': 0.042}, 'gaussian': {'train': 0.061944444, 'test': 0.042}}, 'xor': {'train': 0.009411764, 'test': 0.0064683054}, 'compiled_action': {'train': 2611.0, 'test': 789.0}}, 'action': {'true_num_actions': {'train': 2550, 'test': 773}}}
Default float: float32
{'mode': 'dump', 'track': 'cylinders-4-flat', 'num_examples': 20000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-06T11:28:54.877'}
loaded. picsize: [100 150   3]
(20000, 2, 30, 45, 3)
normalized shape: (30, 45, 3) (30, 45, 3)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 30 W: 45 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x149f980ae790>
[0, 30, 45, 3] -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2D object at 0x149f980ae790>
<keras.layers.normalization.BatchNormalization object at 0x149f883c8910>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x149f883c8910>
<keras.layers.core.Dropout object at 0x149f883c89d0>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x149f883c89d0>
<keras.layers.convolutional.Conv2D object at 0x149f883c8a30>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2D object at 0x149f883c8a30>
<keras.layers.normalization.BatchNormalization object at 0x149f883c8b50>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x149f883c8b50>
<keras.layers.core.Dropout object at 0x149f883c8c10>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x149f883c8c10>
latent space shape is (30, 45, 32) : 300 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 30 W: 45 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x149f9805d1c0>
[0, 30, 45, 32] -> (0, 30, 45, 32) : <keras.layers.core.Reshape object at 0x149f9805d1c0>
<keras.layers.convolutional.Conv2DTranspose object at 0x149f9805d1f0>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x149f9805d1f0>
<keras.layers.normalization.BatchNormalization object at 0x149f9805d430>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x149f9805d430>
<keras.layers.core.Dropout object at 0x149f9805d970>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x149f9805d970>
<keras.layers.convolutional.Conv2DTranspose object at 0x149f9805d370>
(0, 30, 45, 32) -> (0, 30, 45, 3) : <keras.layers.convolutional.Conv2DTranspose object at 0x149f9805d370>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/actions.csv
[ 0 12  4 ...  2  0  2]
2550
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/available_actions.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_add4.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_del4.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_add4+ids.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_del4+ids.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_pos4.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_neg4.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_pos4+ids.csv
Saving to samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/action_neg4+ids.csv
IN DUMP 1
make: Entering directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
make: Nothing to be done for 'all'.
make: Leaving directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
Default float: float32
@[     0.379 +     0.379] loaded puzzle
Loading networks from samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/ (with failure allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 30 W: 45 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14c1f9fb2250>
[0, 30, 45, 3] -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2D object at 0x14c1f9fb2250>
<keras.layers.normalization.BatchNormalization object at 0x14c1f9fb2a60>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x14c1f9fb2a60>
<keras.layers.core.Dropout object at 0x14c1f9fb26d0>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x14c1f9fb26d0>
<keras.layers.convolutional.Conv2D object at 0x14c1f9fb2b50>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2D object at 0x14c1f9fb2b50>
<keras.layers.normalization.BatchNormalization object at 0x14c1f9f54280>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x14c1f9f54280>
<keras.layers.core.Dropout object at 0x14c1f9f54340>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x14c1f9f54340>
latent space shape is (30, 45, 32) : 300 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 30 W: 45 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14c1f9f54910>
[0, 30, 45, 32] -> (0, 30, 45, 32) : <keras.layers.core.Reshape object at 0x14c1f9f54910>
<keras.layers.convolutional.Conv2DTranspose object at 0x14c1f9f54940>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14c1f9f54940>
<keras.layers.normalization.BatchNormalization object at 0x14c1f9f54b20>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.normalization.BatchNormalization object at 0x14c1f9f54b20>
<keras.layers.core.Dropout object at 0x14c1f9f54eb0>
(0, 30, 45, 32) -> (0, 30, 45, 32) : <keras.layers.core.Dropout object at 0x14c1f9f54eb0>
<keras.layers.convolutional.Conv2DTranspose object at 0x14c1f9f54a60>
(0, 30, 45, 32) -> (0, 30, 45, 3) : <keras.layers.convolutional.Conv2DTranspose object at 0x14c1f9f54a60>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
loading additional networks
Network loaded
@[     4.926 +     4.548] loaded sae
@[     4.944 +     0.018] loaded puzzle
@[     4.944 +     0.000] loading init/goal
init (input) min: -3.6593682332786046 max: 3.866742162725241
init (recon) min: -0.36886162 max: 0.47232735
init MSE: 0.6609541665975587
goal (input) min: -3.2243576240263963 max: 4.598648803255706
goal (recon) min: -0.36695707 max: 0.34227908
goal MSE: 0.6589879554278026
problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_init_goal_reconstruction.1.png
@[     9.028 +     4.084] loaded init/goal
@[     9.028 +     0.000] start planning
@[     9.028 +     0.000] start generating problem
['helper/ama3-problem.sh', 'problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.ig', 'problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.pddl']
helper/ama3-problem.sh problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.ig problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.pddl
@[     9.091 +     0.063] finished generating problem
@[     9.091 +     0.000] start planning
['helper/fd-latest.sh', '--search astar(blind())', 'problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.pddl', 'samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/domain.pddl']
Running limit.sh(501845): -t 600 -m 8000000 -- planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.pddl samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/domain.pddl
limit.sh(501845): mem: 8000000 kB, time: 600 sec
limit.sh(501845): pwd: /g100_work/uBS21_InfGer_0/latplan-5.0.0
limit.sh(501845): command to execute: planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.pddl samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/domain.pddl
limit.sh(501845): note: time precision is 0.5 sec
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0/planner-scripts ...
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0 ...
found!: /g100_work/uBS21_InfGer_0/latplan-5.0.0/downward
common.sh(501858): exiting...
[32;1m--------------------------------------------------------
Result:
--------------------------------------------------------[0m
limit.sh(501845): Error occured. status: 2
@[    32.562 +    23.471] finished planning
['helper/fd-parser.awk', 'problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.log']
['main.py', 'remove_duplicates', '../samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/domain.pddl', '../problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.pddl']
SELF REQUIREMENTS
['main.py', 'remove_not_from_prob', '../samples/blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:28:54.877/domain.pddl', '../problem-generators/backup-propositional/vanilla/prob-cylinders-4/007-001/ama3_samples_blocks_cylinders-4-flat_20000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:28:54.877_domain_blind_problem.pddl']
Parsing...
Parsing: [6.320s CPU, 6.339s wall-clock]
Normalizing task... [0.630s CPU, 0.639s wall-clock]
Instantiating...
Generating Datalog program... [0.460s CPU, 0.456s wall-clock]
Normalizing Datalog program...
Normalizing Datalog program: [0.690s CPU, 0.701s wall-clock]
Preparing model... [1.000s CPU, 1.005s wall-clock]
Generated 61129 rules.
Computing model... [0.020s CPU, 0.020s wall-clock]
146 relevant atoms
0 auxiliary atoms
146 final queue length
146 total queue pushes
Completing instantiation... [0.010s CPU, 0.017s wall-clock]
Instantiating: [2.240s CPU, 2.251s wall-clock]
No relaxed solution! Generating unsolvable task...
Translator variables: 1
Translator derived variables: 0
Translator facts: 2
Translator goal facts: 1
Translator mutex groups: 0
Translator total mutex groups size: 0
Translator operators: 0
Translator axioms: 0
Translator task size: 4
Translator peak memory: 352576 KB
Writing output... [0.000s CPU, 0.002s wall-clock]
Done! [9.190s CPU, 9.231s wall-clock]
Building causal graph...
The causal graph is acyclic.
1 variables of 1 necessary
0 of 0 mutex groups necessary.
0 of 0 operators necessary.
0 of 0 axiom rules necessary.
Initializing mutex computation...
Mutex computation initialized with 2 fluents.
iteration for mutex detection and operator pruning
Initialize m_index fw
Initialized mvalues forward: reached=1, notReached=1, spurious=2
Initialize m_ops fw
Computing mutexes...
Mutex computation finished with reached=1, notReached=1, spurious=2
0 operators are spurious because were not triggered
Unsolvable task in preprocessor
done
