Default float: float32
{'mode': 'report', 'track': 'sokoban_image-20000-global-global-2-train', 'num_examples': 20000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-09T16:42:29.689'}
loaded. picsize: [28 28  3]
(19999, 2, 28, 28, 3)
normalized shape: (28, 28, 3) (28, 28, 3)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/sokoban_sokoban_image-20000-global-global-2-train_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-09T16:42:29.689/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 28 W: 28 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14ae95114730>
[0, 28, 28, 3] -> (0, 28, 28, 32) : <keras.layers.convolutional.Conv2D object at 0x14ae95114730>
<keras.layers.normalization.BatchNormalization object at 0x14ae950bb8b0>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ae950bb8b0>
<keras.layers.core.Dropout object at 0x14ae950bb970>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.core.Dropout object at 0x14ae950bb970>
<keras.layers.convolutional.Conv2D object at 0x14ae950bb9d0>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.convolutional.Conv2D object at 0x14ae950bb9d0>
<keras.layers.normalization.BatchNormalization object at 0x14ae950bbaf0>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ae950bbaf0>
<keras.layers.core.Dropout object at 0x14ae950bbbb0>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.core.Dropout object at 0x14ae950bbbb0>
latent space shape is (28, 28, 32) : 50 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 28 W: 28 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14ae950c4160>
[0, 28, 28, 32] -> (0, 28, 28, 32) : <keras.layers.core.Reshape object at 0x14ae950c4160>
<keras.layers.convolutional.Conv2DTranspose object at 0x14ae950c4190>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14ae950c4190>
<keras.layers.normalization.BatchNormalization object at 0x14ae950c43d0>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ae950c43d0>
<keras.layers.core.Dropout object at 0x14ae950c4910>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.core.Dropout object at 0x14ae950c4910>
<keras.layers.convolutional.Conv2DTranspose object at 0x14ae950c4310>
(0, 28, 28, 32) -> (0, 28, 28, 3) : <keras.layers.convolutional.Conv2DTranspose object at 0x14ae950c4310>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x14ae93364400> with <keras_radam.optimizers.RAdam object at 0x14ae92e7cdf0>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x14ae93459d30>.
Network compiled
metrics train {'loss': 2258.8143547986824, 'tau': 5.0, 'pdiff_z1z2': 0.0003873031698694197, 'pdiff_z0z3': 0.00039774545632958655, 'pdiff_z0z1': 0.11887660143497791, 'pdiff_z0z2': 0.11894139951318826, 'kl_z0': 44.2485066075889, 'kl_z1': 43.24836760268251, 'kl_a_z0': 1563.7606612842967, 'kl_a_z1': 1563.4774420247738, 'kl_z1z2': 0.025002941427335015, 'kl_z0z3': 0.02778540715977572, 'x0y0': 116.67027579599555, 'x1y1': 126.44870276148832, 'x0y3': 118.98605828375557, 'x1y2': 129.71230771958983, 'elbo': 1851.8945054781689}
metrics test {'loss': 2093.7544921875, 'tau': 5.0, 'pdiff_z1z2': 0.00039329290739260615, 'pdiff_z0z3': 0.00039787443820387124, 'pdiff_z0z1': 0.11614000350236893, 'pdiff_z0z2': 0.11626291424036025, 'kl_z0': 44.57482147216797, 'kl_z1': 43.667382049560544, 'kl_a_z0': 1392.786962890625, 'kl_a_z1': 1392.5863891601562, 'kl_z1z2': 0.027079805359244348, 'kl_z0z3': 0.02914485111832619, 'x0y0': 117.92550354003906, 'x1y1': 126.6826385498047, 'x0y3': 120.86043395996094, 'x1y2': 128.51728057861328, 'elbo': 1682.6222412109375}
sae mse vanilla train 0.0010336692920484617
sae mse vanilla test 0.0010400007314148533
sae mse gaussian train 0.0010336692920484617
sae mse gaussian test 0.0010400007314148533
sae activation train 0.3503178060054779
sae activation test 0.35370999574661255
sae ever_1 train 50.0
sae ever_1 test 50.0
sae ever_0 train 50.0
sae ever_0 test 50.0
sae effective train 50.0
sae effective test 50.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436], 'xs12': [0.001033669249729436, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs13': [0.09104792131333261, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs34': [0.09104792131333261, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668], 'xs12': [0.0010400006854821668, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs13': [0.09106663262308586, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs34': [0.09106663262308586, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.0011029959643273294
x1y2 mse vanilla test 0.0010928341646751075
x1y2 mse gaussian train 0.0011029959643273294
x1y2 mse gaussian test 0.0010928341646751075
z1z2 mae vanilla train 0.0002333462907699868
z1z2 mae vanilla test 0.00023999999393709004
z1z2 mae gaussian train 0.0002333462907699868
z1z2 mae gaussian test 0.00023999999393709004
z1z2 match_prob vanilla train 0.9883835
z1z2 match_prob vanilla test 0.9880409
z1z2 match_prob gaussian train 0.9883835
z1z2 match_prob gaussian test 0.9880409
z1z2 allmatch_prob vanilla train 0.9885549
z1z2 allmatch_prob vanilla test 0.988
z1z2 allmatch_prob gaussian train 0.9885549
z1z2 allmatch_prob gaussian test 0.988
[0 0 0 ... 0 0 0]
918
z1z2 xor train 0.38671023
[0 0 0 ... 0 0 0]
343
z1z2 xor test 0.39941692
[0 0 0 ... 0 0 0]
918
z1z2 compiled_action train 1274.0
[0 0 0 ... 0 0 0]
343
z1z2 compiled_action test 481.0
kl_a_z0 train 1563.7606612842967
kl_a_z0 test 1392.786962890625
x0y3 mse vanilla train 0.0010117863684196149
x0y3 mse vanilla test 0.0010277249595029069
x0y3 mse gaussian train 0.0010117863684196149
x0y3 mse gaussian test 0.0010277249595029069
z0z3 mae vanilla train 0.0001477859914302826
z0z3 mae vanilla test 0.00022000000171829015
z0z3 mae gaussian train 0.0001477859914302826
z0z3 mae gaussian test 0.00022000000171829015
z0z3 match_prob vanilla train 0.9926326
z0z3 match_prob vanilla test 0.989044
z0z3 match_prob gaussian train 0.9926326
z0z3 match_prob gaussian test 0.989044
z0z3 allmatch_prob vanilla train 0.99349964
z0z3 allmatch_prob vanilla test 0.99
z0z3 allmatch_prob gaussian train 0.99349964
z0z3 allmatch_prob gaussian test 0.99
[0 0 0 ... 0 0 0]
918
z0z3 xor train 0.40958604
[0 0 0 ... 0 0 0]
343
z0z3 xor test 0.41982508
[0 0 0 ... 0 0 0]
918
z0z3 compiled_action train 1418.0
[0 0 0 ... 0 0 0]
343
z0z3 compiled_action test 533.0
action true_num_actions train 918
action true_num_actions test 343
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 2258.8143547986824, 'tau': 5.0, 'pdiff_z1z2': 0.0003873031698694197, 'pdiff_z0z3': 0.00039774545632958655, 'pdiff_z0z1': 0.11887660143497791, 'pdiff_z0z2': 0.11894139951318826, 'kl_z0': 44.2485066075889, 'kl_z1': 43.24836760268251, 'kl_a_z0': 1563.7606612842967, 'kl_a_z1': 1563.4774420247738, 'kl_z1z2': 0.025002941427335015, 'kl_z0z3': 0.02778540715977572, 'x0y0': 116.67027579599555, 'x1y1': 126.44870276148832, 'x0y3': 118.98605828375557, 'x1y2': 129.71230771958983, 'elbo': 1851.8945054781689}, 'test': {'loss': 2093.7544921875, 'tau': 5.0, 'pdiff_z1z2': 0.00039329290739260615, 'pdiff_z0z3': 0.00039787443820387124, 'pdiff_z0z1': 0.11614000350236893, 'pdiff_z0z2': 0.11626291424036025, 'kl_z0': 44.57482147216797, 'kl_z1': 43.667382049560544, 'kl_a_z0': 1392.786962890625, 'kl_a_z1': 1392.5863891601562, 'kl_z1z2': 0.027079805359244348, 'kl_z0z3': 0.02914485111832619, 'x0y0': 117.92550354003906, 'x1y1': 126.6826385498047, 'x0y3': 120.86043395996094, 'x1y2': 128.51728057861328, 'elbo': 1682.6222412109375}}, 'sae': {'mse': {'vanilla': {'train': 0.0010336692920484617, 'test': 0.0010400007314148533}, 'gaussian': {'train': 0.0010336692920484617, 'test': 0.0010400007314148533}}, 'activation': {'train': 0.3503178060054779, 'test': 0.35370999574661255}, 'ever_1': {'train': 50.0, 'test': 50.0}, 'ever_0': {'train': 50.0, 'test': 50.0}, 'effective': {'train': 50.0, 'test': 50.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436, 0.001033669249729436], 'xs12': [0.001033669249729436, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs13': [0.09104792131333261, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs34': [0.09104792131333261, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668, 0.0010400006854821668], 'xs12': [0.0010400006854821668, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs13': [0.09106663262308586, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'xs34': [0.09106663262308586, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.0011029959643273294, 'test': 0.0010928341646751075}, 'gaussian': {'train': 0.0011029959643273294, 'test': 0.0010928341646751075}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.0002333462907699868, 'test': 0.00023999999393709004}, 'gaussian': {'train': 0.0002333462907699868, 'test': 0.00023999999393709004}}, 'match_prob': {'vanilla': {'train': 0.9883835, 'test': 0.9880409}, 'gaussian': {'train': 0.9883835, 'test': 0.9880409}}, 'allmatch_prob': {'vanilla': {'train': 0.9885549, 'test': 0.988}, 'gaussian': {'train': 0.9885549, 'test': 0.988}}, 'xor': {'train': 0.38671023, 'test': 0.39941692}, 'compiled_action': {'train': 1274.0, 'test': 481.0}}, 'kl_a_z0': {'train': 1563.7606612842967, 'test': 1392.786962890625}, 'x0y3': {'mse': {'vanilla': {'train': 0.0010117863684196149, 'test': 0.0010277249595029069}, 'gaussian': {'train': 0.0010117863684196149, 'test': 0.0010277249595029069}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.0001477859914302826, 'test': 0.00022000000171829015}, 'gaussian': {'train': 0.0001477859914302826, 'test': 0.00022000000171829015}}, 'match_prob': {'vanilla': {'train': 0.9926326, 'test': 0.989044}, 'gaussian': {'train': 0.9926326, 'test': 0.989044}}, 'allmatch_prob': {'vanilla': {'train': 0.99349964, 'test': 0.99}, 'gaussian': {'train': 0.99349964, 'test': 0.99}}, 'xor': {'train': 0.40958604, 'test': 0.41982508}, 'compiled_action': {'train': 1418.0, 'test': 533.0}}, 'action': {'true_num_actions': {'train': 918, 'test': 343}}}
