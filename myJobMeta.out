in Meta 0
Default float: float32
{'mode': 'dump', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x15213acf41f0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x15213acf41f0>
<keras.layers.normalization.BatchNormalization object at 0x152139dfd130>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x152139dfd130>
<keras.layers.core.Dropout object at 0x152139dfd430>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x152139dfd430>
<keras.layers.convolutional.Conv2D object at 0x152139dfd490>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x152139dfd490>
<keras.layers.normalization.BatchNormalization object at 0x152139dfd5b0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x152139dfd5b0>
<keras.layers.core.Dropout object at 0x152139dfd670>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x152139dfd670>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x152139dfdc40>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x152139dfdc40>
<keras.layers.convolutional.Conv2DTranspose object at 0x152139dfdc70>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x152139dfdc70>
<keras.layers.normalization.BatchNormalization object at 0x152139dfde50>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x152139dfde50>
<keras.layers.core.Dropout object at 0x152139dfdf70>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x152139dfdf70>
<keras.layers.convolutional.Conv2DTranspose object at 0x152139dfdd90>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x152139dfdd90>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
failed to find weights for additional networks
Network loaded
samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/actions.csv
[1 1 0 ... 0 0 0]
1378
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/available_actions.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_add4.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_del4.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_add4+ids.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_del4+ids.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_pos4.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_neg4.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_pos4+ids.csv
Saving to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/action_neg4+ids.csv
IN DUMP 1
make: Entering directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
make: Nothing to be done for 'all'.
make: Leaving directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
Default float: float32
@[     0.411 +     0.411] loaded puzzle
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14f47d14a5b0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14f47d14a5b0>
<keras.layers.normalization.BatchNormalization object at 0x14f47d14ab80>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14f47d14ab80>
<keras.layers.core.Dropout object at 0x14f47d14aaf0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14f47d14aaf0>
<keras.layers.convolutional.Conv2D object at 0x14f47d14a8b0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14f47d14a8b0>
<keras.layers.normalization.BatchNormalization object at 0x14f47d15c2e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14f47d15c2e0>
<keras.layers.core.Dropout object at 0x14f47d15c3a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14f47d15c3a0>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14f47d15c970>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x14f47d15c970>
<keras.layers.convolutional.Conv2DTranspose object at 0x14f47d15c9a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14f47d15c9a0>
<keras.layers.normalization.BatchNormalization object at 0x14f47d15cb80>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14f47d15cb80>
<keras.layers.core.Dropout object at 0x14f47d15cf10>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14f47d15cf10>
<keras.layers.convolutional.Conv2DTranspose object at 0x14f47d15cac0>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x14f47d15cac0>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
failed to find weights for additional networks
Network loaded
@[     4.585 +     4.174] loaded sae
@[     4.585 +     0.000] loaded puzzle
@[     4.585 +     0.000] loading init/goal
init (input) min: -1.9382502640929606 max: 3.0022268296181864
init (recon) min: -1.9714085 max: 2.9336557
init MSE: 0.0002683279117808314
goal (input) min: -2.146440791804289 max: 3.158903413052018
goal (recon) min: -2.0523126 max: 3.0793047
goal MSE: 0.000256065561733363
problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_init_goal_reconstruction.1.png
threshold value: 0.25
0 images have some panels which are unlike any panels
0 images have all panels which match exactly 1 panel each
2 images have some panels which match >2 panels
threshold value: 0.125
0 images have some panels which are unlike any panels
0 images have all panels which match exactly 1 panel each
2 images have some panels which match >2 panels
threshold value: 0.0625
0 images have some panels which are unlike any panels
2 images have all panels which match exactly 1 panel each
0 images have some panels which match >2 panels
threshold found
0 images have duplicated tiles
2 images have no duplicated tiles
@[    13.719 +     9.134] loaded init/goal
@[    13.719 +     0.000] start planning
@[    13.719 +     0.000] start generating problem
['helper/ama3-problem.sh', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.ig', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl']
helper/ama3-problem.sh problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.ig problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl
@[    13.807 +     0.088] finished generating problem
@[    13.807 +     0.000] start planning
['helper/fd-latest.sh', '--search astar(blind())', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl', 'samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/domain.pddl']
Running limit.sh(845819): -t 600 -m 8000000 -- planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/domain.pddl
limit.sh(845819): mem: 8000000 kB, time: 600 sec
limit.sh(845819): pwd: /g100_work/uBS21_InfGer_0/latplan-5.0.0
limit.sh(845819): command to execute: planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/domain.pddl
limit.sh(845819): note: time precision is 0.5 sec
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0/planner-scripts ...
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0 ...
found!: /g100_work/uBS21_InfGer_0/latplan-5.0.0/downward
common.sh(845832): exiting...
[32;1m--------------------------------------------------------
Result:
[t=0.0232904s, 19720 KB] Plan cost: 7
--------------------------------------------------------[0m
/g100_work/uBS21_InfGer_0/latplan-5.0.0/problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.plan
limit.sh(845819): The program successfully finished.
@[    33.977 +    20.169] finished planning
@[    33.977 +     0.000] start running a validator
['arrival', 'samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/domain.pddl', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.plan', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.trace']
@[    36.801 +     2.824] finished running a validator
@[    36.801 +     0.000] start parsing the plan
['lisp/ama3-read-latent-state-traces.bin', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.trace', '100']
@[    36.932 +     0.131] finished parsing the plan
@[    36.932 +     0.000] start plotting the plan
problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.png
@[    37.233 +     0.301] finished plotting the plan
@[    37.233 +     0.000] start archiving the plan
@[    37.247 +     0.014] finished archiving the plan
@[    37.247 +     0.000] start visually validating the plan image : transitions
[True, True, True, True, True, True, True]
@[    43.874 +     6.627] finished visually validating the plan image : transitions
@[    43.874 +     0.000] start visually validating the plan image : states
threshold value: 0.25
0 images have some panels which are unlike any panels
0 images have all panels which match exactly 1 panel each
8 images have some panels which match >2 panels
threshold value: 0.125
0 images have some panels which are unlike any panels
0 images have all panels which match exactly 1 panel each
8 images have some panels which match >2 panels
threshold value: 0.0625
0 images have some panels which are unlike any panels
8 images have all panels which match exactly 1 panel each
0 images have some panels which match >2 panels
threshold found
0 images have duplicated tiles
8 images have no duplicated tiles
[ True  True  True  True  True  True  True  True]
@[    45.629 +     1.755] finished visually validating the plan image : states
['helper/fd-parser.awk', 'problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.log']
['main.py', 'remove_duplicates', '../samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/domain.pddl', '../problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl']
SELF REQUIREMENTS
['main.py', 'remove_not_from_prob', '../samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/domain.pddl', '../problem-generators/backup-propositional/vanilla/puzzle-mnist-3-3/007-000/ama3_samples_puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_SomeTime480_domain_blind_problem.pddl']
Parsing...
Parsing: [0.360s CPU, 0.358s wall-clock]
Normalizing task... [0.050s CPU, 0.042s wall-clock]
Instantiating...
Generating Datalog program... [0.030s CPU, 0.038s wall-clock]
Normalizing Datalog program...
Normalizing Datalog program: [0.070s CPU, 0.067s wall-clock]
Preparing model... [0.060s CPU, 0.063s wall-clock]
Generated 7524 rules.
Computing model... [0.020s CPU, 0.022s wall-clock]
1530 relevant atoms
0 auxiliary atoms
1530 final queue length
7555 total queue pushes
Completing instantiation... [0.080s CPU, 0.083s wall-clock]
Instantiating: [0.270s CPU, 0.277s wall-clock]
Computing fact groups...
Finding invariants...
99 initial candidates
Finding invariants: [25.060s CPU, 25.124s wall-clock]
Checking invariant weight... [0.000s CPU, 0.000s wall-clock]
Instantiating groups... [0.000s CPU, 0.000s wall-clock]
Collecting mutex groups... [0.000s CPU, 0.000s wall-clock]
Choosing groups...
99 uncovered facts
Choosing groups: [0.000s CPU, 0.000s wall-clock]
Building translation key... [0.000s CPU, 0.000s wall-clock]
Computing fact groups: [25.060s CPU, 25.125s wall-clock]
Building STRIPS to SAS dictionary... [0.000s CPU, 0.000s wall-clock]
Building dictionary for full mutex groups... [0.000s CPU, 0.000s wall-clock]
Building mutex information...
Building mutex information: [0.000s CPU, 0.000s wall-clock]
Translating task...
Processing axioms...
Simplifying axioms... [0.000s CPU, 0.000s wall-clock]
Translator axioms removed by simplifying: 0
Computing negative axioms... [0.000s CPU, 0.000s wall-clock]
Processing axioms: [0.020s CPU, 0.014s wall-clock]
Translating task: [0.190s CPU, 0.190s wall-clock]
5976 effect conditions simplified
0 implied preconditions added
Detecting unreachable propositions...
0 operators removed
0 axioms removed
0 propositions removed
Detecting unreachable propositions: [0.060s CPU, 0.059s wall-clock]
Reordering and filtering variables...
99 of 99 variables necessary.
0 of 0 mutex groups necessary.
1430 of 1430 operators necessary.
0 of 0 axiom rules necessary.
Reordering and filtering variables: [0.070s CPU, 0.073s wall-clock]
Translator variables: 99
Translator derived variables: 0
Translator facts: 198
Translator goal facts: 99
Translator mutex groups: 0
Translator total mutex groups size: 0
Translator operators: 1430
Translator axioms: 0
Translator task size: 36591
Translator peak memory: 275520 KB
Writing output... [0.020s CPU, 0.025s wall-clock]
Done! [26.090s CPU, 26.155s wall-clock]
Building causal graph...
The causal graph is not acyclic.
99 variables of 99 necessary
0 of 0 mutex groups necessary.
1430 of 1430 operators necessary.
0 of 0 axiom rules necessary.
Initializing mutex computation...
Mutex computation initialized with 198 fluents.
iteration for mutex detection and operator pruning
Initialize m_index fw
Initialized mvalues forward: reached=9801, notReached=29205, spurious=198
Initialize m_ops fw
Computing mutexes...
Mutex computation finished with reached=38992, notReached=14, spurious=198
0 operators are spurious because were not triggered
H^2 mutexes added fw: 14, unreachable: 0
0 of 1430 operators detected as spurious
Total mutex and disambiguation time: 0.064006 iterations: 2
7 of 7 mutex groups necessary.
1430 of 1430 operators necessary.
0 of 0 axiom rules necessary.
Change id of operators: 1430
Change id of mutexes
Change id of goals
Change id of initial state
Remove unreachable facts from variables: 99
7 of 7 mutex groups necessary.
1430 of 1430 operators necessary.
0 of 0 axiom rules necessary.
Updating causal graph and pruning unnecessary facts
99 variables of 99 of 99 necessary
The causal graph is not acyclic.
99 variables of 99 necessary
7 of 7 mutex groups necessary.
1430 of 1430 operators necessary.
0 of 0 axiom rules necessary.
Building domain transition graphs...
solveable in poly time 0
Building successor generator...
Preprocessor variables: 99
Preprocessor facts: 198
Preprocessor derived variables: 0
Preprocessor operators: 1430
mutexE type: 10MutexGroup
mutexE typeEE: St6vectorISt4pairIPK8VariableiESaIS4_EE
Variable : var92
Int : 0
Variable : var93
Int : 0
mutexE type: 10MutexGroup
mutexE typeEE: St6vectorISt4pairIPK8VariableiESaIS4_EE
Variable : var92
Int : 0
Variable : var94
Int : 0
mutexE type: 10MutexGroup
mutexE typeEE: St6vectorISt4pairIPK8VariableiESaIS4_EE
Variable : var92
Int : 0
Variable : var95
Int : 0
mutexE type: 10MutexGroup
mutexE typeEE: St6vectorISt4pairIPK8VariableiESaIS4_EE
Variable : var92
Int : 0
Variable : var96
Int : 0
mutexE type: 10MutexGroup
mutexE typeEE: St6vectorISt4pairIPK8VariableiESaIS4_EE
Variable : var92
Int : 0
Variable : var97
Int : 0
mutexE type: 10MutexGroup
mutexE typeEE: St6vectorISt4pairIPK8VariableiESaIS4_EE
Variable : var92
Int : 0
Variable : var98
Int : 0
mutexE type: 10MutexGroup
mutexE typeEE: St6vectorISt4pairIPK8VariableiESaIS4_EE
Variable : var93
Int : 0
Variable : var95
Int : 0
Preprocessor mutex groups: 7
Preprocessor task size: 36605
Writing output...
done
in Meta 2
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x154a28bf3190>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x154a28bf3190>
<keras.layers.normalization.BatchNormalization object at 0x154a289e00d0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x154a289e00d0>
<keras.layers.core.Dropout object at 0x154a289e03d0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x154a289e03d0>
<keras.layers.convolutional.Conv2D object at 0x154a289e0430>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x154a289e0430>
<keras.layers.normalization.BatchNormalization object at 0x154a289e0550>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x154a289e0550>
<keras.layers.core.Dropout object at 0x154a289e0610>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x154a289e0610>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x154a289e0be0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x154a289e0be0>
<keras.layers.convolutional.Conv2DTranspose object at 0x154a289e0c10>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x154a289e0c10>
<keras.layers.normalization.BatchNormalization object at 0x154a289e0df0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x154a289e0df0>
<keras.layers.core.Dropout object at 0x154a289e0d60>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x154a289e0d60>
<keras.layers.convolutional.Conv2DTranspose object at 0x154a289e0d30>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x154a289e0d30>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
failed to find weights for additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x154a28164fd0> with <keras_radam.optimizers.RAdam object at 0x1549c873a700>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x154a281690d0>.
Network compiled
metrics train {'loss': 3000.6815809461805, 'tau': 5.0, 'pdiff_z1z2': 0.0006692775162971682, 'pdiff_z0z3': 0.0005767032956807978, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.08496430549356672, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721664428711, 'kl_a_z0': 2175.4090684678818, 'kl_a_z1': 2176.2663628472224, 'kl_z1z2': 0.06130834023157756, 'kl_z0z3': 0.07470265138480399, 'x0y0': 24.677969784206816, 'x1y1': 24.423379982842338, 'x0y3': 28.90225058661567, 'x1y2': 30.218733427259657, 'elbo': 2304.7677558051214}
metrics test {'loss': 2222.8984375, 'tau': 5.0, 'pdiff_z1z2': 0.0006496605928987265, 'pdiff_z0z3': 0.0005962724681012332, 'pdiff_z0z1': 0.08384525030851364, 'pdiff_z0z2': 0.08436017483472824, 'kl_z0': 77.42523193359375, 'kl_z1': 77.72393798828125, 'kl_a_z0': 1395.2431640625, 'kl_a_z1': 1394.819580078125, 'kl_z1z2': 0.07582630962133408, 'kl_z0z3': 0.0782589390873909, 'x0y0': 24.768159866333008, 'x1y1': 24.418882369995117, 'x0y3': 26.207319259643555, 'x1y2': 33.176055908203125, 'elbo': 1524.3804931640625}
sae mse vanilla train 0.00021311375894583762
sae mse vanilla test 0.0002134854148607701
sae mse gaussian train 0.00021311378804966807
sae mse gaussian test 0.00021348540030885488
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.08999998867511749, 'min': 0.0, 'mean': 1.7999997226070263e-06, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.0002131138026015833, 0.00021311378804966807, 0.00021311378804966807, 0.0002131138026015833, 0.00021311378804966807, 0.00021311378804966807, 0.00021311378804966807, 0.00021311378804966807, 0.0002131138026015833], 'xs12': [0.0002131138026015833, 3.81314962854336e-15, 3.837907554558656e-15, 3.825501062980222e-15, 3.836416776571488e-15, 3.828558428403336e-15, 3.822049827236634e-15, 3.843073184987486e-15, 3.845690516794502e-15, 3.816170148033269e-15], 'xs13': [0.09023256130808875, 3.8189213110459506e-15, 3.834775650236183e-15, 3.837109649522342e-15, 3.818388103805654e-15, 3.840049277365788e-15, 3.832284949854782e-15, 3.8157716190315855e-15, 3.842220646326075e-15, 3.835906015704294e-15], 'xs34': [0.09023256130689696, 3.832833403688129e-15, 3.836161396137891e-15, 3.826379859662998e-15, 3.819838224211353e-15, 3.8344842709023275e-15, 3.828719788179788e-15, 3.8307755371427745e-15, 3.82581023000597e-15, 3.847618363782453e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.00021348542941268533, 0.00021348542941268533, 0.0002134854585165158, 0.00021348542941268533, 0.00021348542941268533, 0.0002134854148607701, 0.00021348540030885488, 0.0002134854148607701, 0.00021348542941268533], 'xs12': [0.00021348542941268533, 3.7961445950942824e-15, 3.793610696032571e-15, 3.831589535805086e-15, 3.848002069707559e-15, 3.76228657061016e-15, 3.800126073462851e-15, 3.8089868851240785e-15, 3.842615363679495e-15, 3.877143391224896e-15], 'xs13': [0.09018520338180203, 3.856660016977919e-15, 3.860167580412499e-15, 3.827741041609236e-15, 3.829160668828834e-15, 3.83456050386758e-15, 3.857045840485393e-15, 3.8742778787643345e-15, 3.80327153031248e-15, 3.804370979078016e-15], 'xs34': [0.0901852034267342, 3.782175751244638e-15, 3.851754425663895e-15, 3.8466883216063674e-15, 3.795008300395541e-15, 3.835514686482662e-15, 3.855921404247913e-15, 3.840031066157422e-15, 3.787667065841688e-15, 3.797296983419022e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.0002623155596666038
x1y2 mse vanilla test 0.00028798668063245714
x1y2 mse gaussian train 0.0002623155596666038
x1y2 mse gaussian test 0.00028798668063245714
z1z2 mae vanilla train 7.111111335689202e-05
z1z2 mae vanilla test 0.00011999999696854502
z1z2 mae gaussian train 7.111111335689202e-05
z1z2 mae gaussian test 0.00011999999696854502
z1z2 match_prob vanilla train 0.99291193
z1z2 match_prob vanilla test 0.9880479
z1z2 match_prob gaussian train 0.99291193
z1z2 match_prob gaussian test 0.9880479
z1z2 allmatch_prob vanilla train 0.9948889
z1z2 allmatch_prob vanilla test 0.988
z1z2 allmatch_prob gaussian train 0.9948889
z1z2 allmatch_prob gaussian test 0.988
[1 1 0 ... 0 0 0]
1305
z1z2 xor train 0.011494253
[0 0 0 ... 0 0 0]
222
z1z2 xor test 0.0045045046
[1 1 0 ... 0 0 0]
1305
z1z2 compiled_action train 1320.0
[0 0 0 ... 0 0 0]
222
z1z2 compiled_action test 223.0
kl_a_z0 train 2175.4090684678818
kl_a_z0 test 1395.2431640625
x0y3 mse vanilla train 0.00025088779511861503
x0y3 mse vanilla test 0.00022749407798983157
x0y3 mse gaussian train 0.0002508877369109541
x0y3 mse gaussian test 0.00026482983957976103
z0z3 mae vanilla train 4.222222196403891e-05
z0z3 mae vanilla test 3.9999998989515007e-05
z0z3 mae gaussian train 4.222222196403891e-05
z0z3 mae gaussian test 3.9999998989515007e-05
z0z3 match_prob vanilla train 0.9957858
z0z3 match_prob vanilla test 0.996
z0z3 match_prob gaussian train 0.9957858
z0z3 match_prob gaussian test 0.996
z0z3 allmatch_prob vanilla train 0.9957778
z0z3 allmatch_prob vanilla test 0.996
z0z3 allmatch_prob gaussian train 0.9957778
z0z3 allmatch_prob gaussian test 0.996
[1 1 0 ... 0 0 0]
1305
z0z3 xor train 0.02605364
[0 0 0 ... 0 0 0]
222
z0z3 xor test 0.022522522
[1 1 0 ... 0 0 0]
1305
z0z3 compiled_action train 1353.0
[0 0 0 ... 0 0 0]
222
z0z3 compiled_action test 228.0
action true_num_actions train 1305
action true_num_actions test 222
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 3000.6815809461805, 'tau': 5.0, 'pdiff_z1z2': 0.0006692775162971682, 'pdiff_z0z3': 0.0005767032956807978, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.08496430549356672, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721664428711, 'kl_a_z0': 2175.4090684678818, 'kl_a_z1': 2176.2663628472224, 'kl_z1z2': 0.06130834023157756, 'kl_z0z3': 0.07470265138480399, 'x0y0': 24.677969784206816, 'x1y1': 24.423379982842338, 'x0y3': 28.90225058661567, 'x1y2': 30.218733427259657, 'elbo': 2304.7677558051214}, 'test': {'loss': 2222.8984375, 'tau': 5.0, 'pdiff_z1z2': 0.0006496605928987265, 'pdiff_z0z3': 0.0005962724681012332, 'pdiff_z0z1': 0.08384525030851364, 'pdiff_z0z2': 0.08436017483472824, 'kl_z0': 77.42523193359375, 'kl_z1': 77.72393798828125, 'kl_a_z0': 1395.2431640625, 'kl_a_z1': 1394.819580078125, 'kl_z1z2': 0.07582630962133408, 'kl_z0z3': 0.0782589390873909, 'x0y0': 24.768159866333008, 'x1y1': 24.418882369995117, 'x0y3': 26.207319259643555, 'x1y2': 33.176055908203125, 'elbo': 1524.3804931640625}}, 'sae': {'mse': {'vanilla': {'train': 0.00021311375894583762, 'test': 0.0002134854148607701}, 'gaussian': {'train': 0.00021311378804966807, 'test': 0.00021348540030885488}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.08999998867511749, 'min': 0.0, 'mean': 1.7999997226070263e-06, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.0002131138026015833, 0.00021311378804966807, 0.00021311378804966807, 0.0002131138026015833, 0.00021311378804966807, 0.00021311378804966807, 0.00021311378804966807, 0.00021311378804966807, 0.0002131138026015833], 'xs12': [0.0002131138026015833, 3.81314962854336e-15, 3.837907554558656e-15, 3.825501062980222e-15, 3.836416776571488e-15, 3.828558428403336e-15, 3.822049827236634e-15, 3.843073184987486e-15, 3.845690516794502e-15, 3.816170148033269e-15], 'xs13': [0.09023256130808875, 3.8189213110459506e-15, 3.834775650236183e-15, 3.837109649522342e-15, 3.818388103805654e-15, 3.840049277365788e-15, 3.832284949854782e-15, 3.8157716190315855e-15, 3.842220646326075e-15, 3.835906015704294e-15], 'xs34': [0.09023256130689696, 3.832833403688129e-15, 3.836161396137891e-15, 3.826379859662998e-15, 3.819838224211353e-15, 3.8344842709023275e-15, 3.828719788179788e-15, 3.8307755371427745e-15, 3.82581023000597e-15, 3.847618363782453e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.00021348542941268533, 0.00021348542941268533, 0.0002134854585165158, 0.00021348542941268533, 0.00021348542941268533, 0.0002134854148607701, 0.00021348540030885488, 0.0002134854148607701, 0.00021348542941268533], 'xs12': [0.00021348542941268533, 3.7961445950942824e-15, 3.793610696032571e-15, 3.831589535805086e-15, 3.848002069707559e-15, 3.76228657061016e-15, 3.800126073462851e-15, 3.8089868851240785e-15, 3.842615363679495e-15, 3.877143391224896e-15], 'xs13': [0.09018520338180203, 3.856660016977919e-15, 3.860167580412499e-15, 3.827741041609236e-15, 3.829160668828834e-15, 3.83456050386758e-15, 3.857045840485393e-15, 3.8742778787643345e-15, 3.80327153031248e-15, 3.804370979078016e-15], 'xs34': [0.0901852034267342, 3.782175751244638e-15, 3.851754425663895e-15, 3.8466883216063674e-15, 3.795008300395541e-15, 3.835514686482662e-15, 3.855921404247913e-15, 3.840031066157422e-15, 3.787667065841688e-15, 3.797296983419022e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.0002623155596666038, 'test': 0.00028798668063245714}, 'gaussian': {'train': 0.0002623155596666038, 'test': 0.00028798668063245714}}}, 'z1z2': {'mae': {'vanilla': {'train': 7.111111335689202e-05, 'test': 0.00011999999696854502}, 'gaussian': {'train': 7.111111335689202e-05, 'test': 0.00011999999696854502}}, 'match_prob': {'vanilla': {'train': 0.99291193, 'test': 0.9880479}, 'gaussian': {'train': 0.99291193, 'test': 0.9880479}}, 'allmatch_prob': {'vanilla': {'train': 0.9948889, 'test': 0.988}, 'gaussian': {'train': 0.9948889, 'test': 0.988}}, 'xor': {'train': 0.011494253, 'test': 0.0045045046}, 'compiled_action': {'train': 1320.0, 'test': 223.0}}, 'kl_a_z0': {'train': 2175.4090684678818, 'test': 1395.2431640625}, 'x0y3': {'mse': {'vanilla': {'train': 0.00025088779511861503, 'test': 0.00022749407798983157}, 'gaussian': {'train': 0.0002508877369109541, 'test': 0.00026482983957976103}}}, 'z0z3': {'mae': {'vanilla': {'train': 4.222222196403891e-05, 'test': 3.9999998989515007e-05}, 'gaussian': {'train': 4.222222196403891e-05, 'test': 3.9999998989515007e-05}}, 'match_prob': {'vanilla': {'train': 0.9957858, 'test': 0.996}, 'gaussian': {'train': 0.9957858, 'test': 0.996}}, 'allmatch_prob': {'vanilla': {'train': 0.9957778, 'test': 0.996}, 'gaussian': {'train': 0.9957778, 'test': 0.996}}, 'xor': {'train': 0.02605364, 'test': 0.022522522}, 'compiled_action': {'train': 1353.0, 'test': 228.0}}, 'action': {'true_num_actions': {'train': 1305, 'test': 222}}}
in Meta 3
1.7999997226070263e-06
in Meta 4
in Meta 5
1.7999997226070263e-06
in Meta 6
7
IN WHILEE
Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
VAL OF RESUME 
RESUME TRUE in nn_task
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
resuming the training
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14e87b0f6f70>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14e87b0f6f70>
<keras.layers.normalization.BatchNormalization object at 0x14e87b0d0460>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14e87b0d0460>
<keras.layers.core.Dropout object at 0x14e87b0d0520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14e87b0d0520>
<keras.layers.convolutional.Conv2D object at 0x14e87b0d0580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14e87b0d0580>
<keras.layers.normalization.BatchNormalization object at 0x14e87b0d06a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14e87b0d06a0>
<keras.layers.core.Dropout object at 0x14e87b0d0760>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14e87b0d0760>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14e87b0d0d30>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x14e87b0d0d30>
<keras.layers.convolutional.Conv2DTranspose object at 0x14e87b0d0d60>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14e87b0d0d60>
<keras.layers.normalization.BatchNormalization object at 0x14e87b0d0dc0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14e87b0d0dc0>
<keras.layers.core.Dropout object at 0x14e87b0d44c0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14e87b0d44c0>
<keras.layers.convolutional.Conv2DTranspose object at 0x14e87b0d0e80>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x14e87b0d0e80>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
failed to find weights for additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x14e87a852fd0> with <keras_radam.optimizers.RAdam object at 0x14e8fd108c40>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x14e87a857160>.
Network compiled
Saving the network to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/
saving additional networks
Network saved
before return NN_TASK
FINISHED TRAINING
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14e748106f40>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14e748106f40>
<keras.layers.normalization.BatchNormalization object at 0x14e725b9f070>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14e725b9f070>
<keras.layers.core.Dropout object at 0x14e725b9f2e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14e725b9f2e0>
<keras.layers.convolutional.Conv2D object at 0x14e725b9f340>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14e725b9f340>
<keras.layers.normalization.BatchNormalization object at 0x14e725b9f460>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14e725b9f460>
<keras.layers.core.Dropout object at 0x14e725b9f520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14e725b9f520>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14e725b9faf0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x14e725b9faf0>
<keras.layers.convolutional.Conv2DTranspose object at 0x14e725b9fb20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14e725b9fb20>
<keras.layers.normalization.BatchNormalization object at 0x14e725b9fd00>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14e725b9fd00>
<keras.layers.core.Dropout object at 0x14e725b9fc70>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14e725b9fc70>
<keras.layers.convolutional.Conv2DTranspose object at 0x14e725b9fc40>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x14e725b9fc40>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x14e725323d90> with <keras_radam.optimizers.RAdam object at 0x14e724dc0700>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x14e7253280d0>.
Network compiled
metrics train {'loss': 48011.475260416664, 'tau': 5.0, 'pdiff_z1z2': 0.17316411601172554, 'pdiff_z0z3': 0.1686352805958854, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.25543999870618184, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2174.191818576389, 'kl_a_z1': 2175.023878309462, 'kl_z1z2': 88.59718950059678, 'kl_z0z3': 92.3544906616211, 'x0y0': 16887.340798611112, 'x1y1': 16968.605989583335, 'x0y3': 38399.267621527775, 'x1y2': 38479.25798611111, 'elbo': 46908.72690972222}
metrics test {'loss': 47467.69140625, 'tau': 5.0, 'pdiff_z1z2': 0.17409847676753998, 'pdiff_z0z3': 0.16927620768547058, 'pdiff_z0z1': 0.08384114503860474, 'pdiff_z0z2': 0.2551141679286957, 'kl_z0': 77.4253921508789, 'kl_z1': 77.72400665283203, 'kl_a_z0': 1394.4739990234375, 'kl_a_z1': 1394.0355224609375, 'kl_z1z2': 87.1777572631836, 'kl_z0z3': 90.49308013916016, 'x0y0': 16929.01953125, 'x1y1': 16939.212890625, 'x0y3': 39097.69921875, 'x1y2': 38711.65625, 'elbo': 46369.76171875}
sae mse vanilla train 0.1469442993402481
sae mse vanilla test 0.14699751138687134
sae mse gaussian train 0.1469443142414093
sae mse gaussian test 0.14699751138687134
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.1469442993402481, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734], 'xs12': [0.1469442993402481, 4.804849595529959e-06, 9.11510535155308e-15, 9.176913345714226e-15, 9.144703223828987e-15, 9.137223922904732e-15, 9.138858696492932e-15, 9.159715188753175e-15, 9.179198640605919e-15, 9.108586585991011e-15], 'xs13': [0.23686650461215433, 4.8048500502773095e-06, 9.152104597722095e-15, 9.164749952591655e-15, 9.152099515524412e-15, 9.147343425525579e-15, 9.14843525099459e-15, 9.192985795888377e-15, 9.138426709689833e-15, 9.142948171562276e-15], 'xs34': [0.2368646581144387, 4.8048500502773095e-06, 9.174291778742474e-15, 9.144016280108764e-15, 9.165667289273531e-15, 9.145324098979325e-15, 9.137372153670501e-15, 9.147168936738444e-15, 9.14128121072208e-15, 9.153785958122395e-15], 'zs01': [0.0, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06], 'zs12': [1.1111111462014378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [1.1111111462014378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [1.1111111462014378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134], 'xs12': [0.14699751138687134, 9.098079142280321e-15, 9.141249023470084e-15, 9.094337797752299e-15, 9.211029291730788e-15, 9.293398163653585e-15, 9.28797969389e-15, 8.954847564965514e-15, 9.122263626990326e-15, 9.06422831757625e-15], 'xs13': [0.23700076934363767, 9.161292364100963e-15, 9.010909287612487e-15, 9.102830150081471e-15, 9.117833644676186e-15, 9.084418194907004e-15, 9.078134904504272e-15, 9.069860239642544e-15, 9.140878870072134e-15, 9.062934051232846e-15], 'xs34': [0.23700076931694516, 9.189762835524074e-15, 9.19560397472834e-15, 8.986433423568627e-15, 9.194535866181852e-15, 9.10436666784779e-15, 9.12676645413793e-15, 9.186633895816917e-15, 9.006336156730261e-15, 8.997449087047669e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.3340212404727936
x1y2 mse vanilla test 0.3360387086868286
x1y2 mse gaussian train 0.3340212404727936
x1y2 mse gaussian test 0.3360387086868286
z1z2 mae vanilla train 0.16860666871070862
z1z2 mae vanilla test 0.1687600016593933
z1z2 mae gaussian train 0.16860666871070862
z1z2 mae gaussian test 0.1687600016593933
z1z2 match_prob vanilla train 4.6272848e-09
z1z2 match_prob vanilla test 3.938809e-09
z1z2 match_prob gaussian train 4.6272848e-09
z1z2 match_prob gaussian test 3.938809e-09
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1445
z1z2 xor train 0.097577855
[0 0 0 ... 0 0 0]
221
z1z2 xor test 0.09049774
[0 1 0 ... 0 0 0]
1445
z1z2 compiled_action train 1588.0
[0 0 0 ... 0 0 0]
221
z1z2 compiled_action test 242.0
kl_a_z0 train 2174.191818576389
kl_a_z0 test 1394.4739990234375
x0y3 mse vanilla train 0.3333272933959961
x0y3 mse vanilla test 0.3393898010253906
x0y3 mse gaussian train 0.3333272933959961
x0y3 mse gaussian test 0.3397405743598938
z0z3 mae vanilla train 0.16520445048809052
z0z3 mae vanilla test 0.16604000329971313
z0z3 mae gaussian train 0.16520445048809052
z0z3 mae gaussian test 0.16604000329971313
z0z3 match_prob vanilla train 8.967301e-09
z0z3 match_prob vanilla test 8.029014e-09
z0z3 match_prob gaussian train 8.967301e-09
z0z3 match_prob gaussian test 8.029014e-09
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1445
z0z3 xor train 0.13910034
[0 0 0 ... 0 0 0]
221
z0z3 xor test 0.122171946
[0 1 0 ... 0 0 0]
1445
z0z3 compiled_action train 1794.0
[0 0 0 ... 0 0 0]
221
z0z3 compiled_action test 268.0
action true_num_actions train 1445
action true_num_actions test 221
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 48011.475260416664, 'tau': 5.0, 'pdiff_z1z2': 0.17316411601172554, 'pdiff_z0z3': 0.1686352805958854, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.25543999870618184, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2174.191818576389, 'kl_a_z1': 2175.023878309462, 'kl_z1z2': 88.59718950059678, 'kl_z0z3': 92.3544906616211, 'x0y0': 16887.340798611112, 'x1y1': 16968.605989583335, 'x0y3': 38399.267621527775, 'x1y2': 38479.25798611111, 'elbo': 46908.72690972222}, 'test': {'loss': 47467.69140625, 'tau': 5.0, 'pdiff_z1z2': 0.17409847676753998, 'pdiff_z0z3': 0.16927620768547058, 'pdiff_z0z1': 0.08384114503860474, 'pdiff_z0z2': 0.2551141679286957, 'kl_z0': 77.4253921508789, 'kl_z1': 77.72400665283203, 'kl_a_z0': 1394.4739990234375, 'kl_a_z1': 1394.0355224609375, 'kl_z1z2': 87.1777572631836, 'kl_z0z3': 90.49308013916016, 'x0y0': 16929.01953125, 'x1y1': 16939.212890625, 'x0y3': 39097.69921875, 'x1y2': 38711.65625, 'elbo': 46369.76171875}}, 'sae': {'mse': {'vanilla': {'train': 0.1469442993402481, 'test': 0.14699751138687134}, 'gaussian': {'train': 0.1469443142414093, 'test': 0.14699751138687134}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.1469442993402481, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734, 0.14694616198539734], 'xs12': [0.1469442993402481, 4.804849595529959e-06, 9.11510535155308e-15, 9.176913345714226e-15, 9.144703223828987e-15, 9.137223922904732e-15, 9.138858696492932e-15, 9.159715188753175e-15, 9.179198640605919e-15, 9.108586585991011e-15], 'xs13': [0.23686650461215433, 4.8048500502773095e-06, 9.152104597722095e-15, 9.164749952591655e-15, 9.152099515524412e-15, 9.147343425525579e-15, 9.14843525099459e-15, 9.192985795888377e-15, 9.138426709689833e-15, 9.142948171562276e-15], 'xs34': [0.2368646581144387, 4.8048500502773095e-06, 9.174291778742474e-15, 9.144016280108764e-15, 9.165667289273531e-15, 9.145324098979325e-15, 9.137372153670501e-15, 9.147168936738444e-15, 9.14128121072208e-15, 9.153785958122395e-15], 'zs01': [0.0, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06, 1.1111111462014378e-06], 'zs12': [1.1111111462014378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [1.1111111462014378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [1.1111111462014378e-06, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134, 0.14699751138687134], 'xs12': [0.14699751138687134, 9.098079142280321e-15, 9.141249023470084e-15, 9.094337797752299e-15, 9.211029291730788e-15, 9.293398163653585e-15, 9.28797969389e-15, 8.954847564965514e-15, 9.122263626990326e-15, 9.06422831757625e-15], 'xs13': [0.23700076934363767, 9.161292364100963e-15, 9.010909287612487e-15, 9.102830150081471e-15, 9.117833644676186e-15, 9.084418194907004e-15, 9.078134904504272e-15, 9.069860239642544e-15, 9.140878870072134e-15, 9.062934051232846e-15], 'xs34': [0.23700076931694516, 9.189762835524074e-15, 9.19560397472834e-15, 8.986433423568627e-15, 9.194535866181852e-15, 9.10436666784779e-15, 9.12676645413793e-15, 9.186633895816917e-15, 9.006336156730261e-15, 8.997449087047669e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.3340212404727936, 'test': 0.3360387086868286}, 'gaussian': {'train': 0.3340212404727936, 'test': 0.3360387086868286}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.16860666871070862, 'test': 0.1687600016593933}, 'gaussian': {'train': 0.16860666871070862, 'test': 0.1687600016593933}}, 'match_prob': {'vanilla': {'train': 4.6272848e-09, 'test': 3.938809e-09}, 'gaussian': {'train': 4.6272848e-09, 'test': 3.938809e-09}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.097577855, 'test': 0.09049774}, 'compiled_action': {'train': 1588.0, 'test': 242.0}}, 'kl_a_z0': {'train': 2174.191818576389, 'test': 1394.4739990234375}, 'x0y3': {'mse': {'vanilla': {'train': 0.3333272933959961, 'test': 0.3393898010253906}, 'gaussian': {'train': 0.3333272933959961, 'test': 0.3397405743598938}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.16520445048809052, 'test': 0.16604000329971313}, 'gaussian': {'train': 0.16520445048809052, 'test': 0.16604000329971313}}, 'match_prob': {'vanilla': {'train': 8.967301e-09, 'test': 8.029014e-09}, 'gaussian': {'train': 8.967301e-09, 'test': 8.029014e-09}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.13910034, 'test': 0.122171946}, 'compiled_action': {'train': 1794.0, 'test': 268.0}}, 'action': {'true_num_actions': {'train': 1445, 'test': 221}}}
current_state_var (after training)
0.0
FIN WHILE
IN WHILEE
Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
VAL OF RESUME 
RESUME TRUE in nn_task
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
resuming the training
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1505c20a1fd0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1505c20a1fd0>
<keras.layers.normalization.BatchNormalization object at 0x1505c207b4c0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1505c207b4c0>
<keras.layers.core.Dropout object at 0x1505c207b580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1505c207b580>
<keras.layers.convolutional.Conv2D object at 0x1505c207b5e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1505c207b5e0>
<keras.layers.normalization.BatchNormalization object at 0x1505c207b700>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1505c207b700>
<keras.layers.core.Dropout object at 0x1505c207b7c0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1505c207b7c0>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1505c207bd90>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x1505c207bd90>
<keras.layers.convolutional.Conv2DTranspose object at 0x1505c207bdc0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x1505c207bdc0>
<keras.layers.normalization.BatchNormalization object at 0x1505c207be20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1505c207be20>
<keras.layers.core.Dropout object at 0x1505c207e520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1505c207e520>
<keras.layers.convolutional.Conv2DTranspose object at 0x1505c207bee0>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x1505c207bee0>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1505b82f00a0> with <keras_radam.optimizers.RAdam object at 0x15059fd67730>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1505b82f2160>.
Network compiled
Saving the network to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/
saving additional networks
Network saved
before return NN_TASK
FINISHED TRAINING
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x147d1815a160>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x147d1815a160>
<keras.layers.normalization.BatchNormalization object at 0x147cb817b0a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x147cb817b0a0>
<keras.layers.core.Dropout object at 0x147cb817b3a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x147cb817b3a0>
<keras.layers.convolutional.Conv2D object at 0x147cb817b400>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x147cb817b400>
<keras.layers.normalization.BatchNormalization object at 0x147cb817b520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x147cb817b520>
<keras.layers.core.Dropout object at 0x147cb817b5e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x147cb817b5e0>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x147cb817bbb0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x147cb817bbb0>
<keras.layers.convolutional.Conv2DTranspose object at 0x147cb817bbe0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x147cb817bbe0>
<keras.layers.normalization.BatchNormalization object at 0x147cb817bdc0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x147cb817bdc0>
<keras.layers.core.Dropout object at 0x147cb817bd30>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x147cb817bd30>
<keras.layers.convolutional.Conv2DTranspose object at 0x147cb817bd00>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x147cb817bd00>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x147c966f1fd0> with <keras_radam.optimizers.RAdam object at 0x147c96178760>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x147c966f60d0>.
Network compiled
metrics train {'loss': 47004.7890625, 'tau': 5.0, 'pdiff_z1z2': 0.1692339946826299, 'pdiff_z0z3': 0.16508925325340695, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.25159952938556673, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2173.8070570203995, 'kl_a_z1': 2174.608704969618, 'kl_z1z2': 85.60990566677518, 'kl_z0z3': 89.0918236626519, 'x0y0': 16563.67052951389, 'x1y1': 16642.527777777777, 'x0y3': 37432.28506944444, 'x1y2': 37432.83489583333, 'elbo': 45916.10095486111}
metrics test {'loss': 46497.36328125, 'tau': 5.0, 'pdiff_z1z2': 0.17161130905151367, 'pdiff_z0z3': 0.1659032553434372, 'pdiff_z0z1': 0.08384048938751221, 'pdiff_z0z2': 0.25266870856285095, 'kl_z0': 77.4254379272461, 'kl_z1': 77.72412872314453, 'kl_a_z0': 1394.399658203125, 'kl_a_z1': 1393.9444580078125, 'kl_z1z2': 84.59324645996094, 'kl_z0z3': 89.58425903320312, 'x0y0': 16607.12109375, 'x1y1': 16613.9921875, 'x0y3': 38072.3828125, 'x1y2': 37832.2890625, 'elbo': 45407.29296875}
sae mse vanilla train 0.14412420988082886
sae mse vanilla test 0.14418888092041016
sae mse gaussian train 0.14412420988082886
sae mse gaussian test 0.14418888092041016
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886], 'xs12': [0.14412420988082886, 9.103879623903119e-15, 9.087153264293688e-15, 9.072623261116488e-15, 9.065429410295457e-15, 9.073614289664775e-15, 9.069741655029929e-15, 9.08892949238408e-15, 9.079579942712288e-15, 9.057309752463077e-15], 'xs13': [0.2340464567462388, 9.08671450122701e-15, 9.058341438592833e-15, 9.052823865974419e-15, 9.034935377161355e-15, 9.085068716210495e-15, 9.044288314964937e-15, 9.070883455442828e-15, 9.058386331339038e-15, 9.078655829766833e-15], 'xs34': [0.23404645666759222, 9.128422403549812e-15, 9.055995157328939e-15, 9.069868709972017e-15, 9.078457624057176e-15, 9.058904715502757e-15, 9.057321610924339e-15, 9.068804836590266e-15, 9.06575551798015e-15, 9.07184822596975e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016], 'xs12': [0.14418888092041016, 9.16580620267688e-15, 9.226784104549718e-15, 9.10116742440601e-15, 9.160416532033502e-15, 8.861638365383756e-15, 9.045097231429565e-15, 9.101646845054157e-15, 9.156413454324778e-15, 9.03488455518452e-15], 'xs13': [0.23418980042782944, 9.014298266434451e-15, 8.968821914529315e-15, 9.030153029141157e-15, 9.039845627156588e-15, 9.028116761935958e-15, 8.957080343814476e-15, 9.020291871569223e-15, 9.1765974024249e-15, 8.972518366311133e-15], 'xs34': [0.23418980080918506, 9.092127888792913e-15, 8.983022421890034e-15, 9.018301344143175e-15, 9.03196313854944e-15, 8.944524774437326e-15, 8.932990726794564e-15, 9.012636387791938e-15, 9.151181331809588e-15, 9.04824226476272e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.3249377906322479
x1y2 mse vanilla test 0.3284052908420563
x1y2 mse gaussian train 0.3249377906322479
x1y2 mse gaussian test 0.3284052908420563
z1z2 mae vanilla train 0.16445332765579224
z1z2 mae vanilla test 0.1658799946308136
z1z2 mae gaussian train 0.16445332765579224
z1z2 mae gaussian test 0.1658799946308136
z1z2 match_prob vanilla train 7.861192e-09
z1z2 match_prob vanilla test 5.712663e-09
z1z2 match_prob gaussian train 7.861192e-09
z1z2 match_prob gaussian test 5.712663e-09
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1495
z1z2 xor train 0.10367893
[0 0 0 ... 0 0 0]
222
z1z2 xor test 0.0990991
[0 1 0 ... 0 0 0]
1495
z1z2 compiled_action train 1654.0
[0 0 0 ... 0 0 0]
222
z1z2 compiled_action test 245.0
kl_a_z0 train 2173.8070570203995
kl_a_z0 test 1394.399658203125
x0y3 mse vanilla train 0.32493293285369873
x0y3 mse vanilla test 0.33048948645591736
x0y3 mse gaussian train 0.32493293285369873
x0y3 mse gaussian test 0.3304538428783417
z0z3 mae vanilla train 0.16123555600643158
z0z3 mae vanilla test 0.1618800014257431
z0z3 mae gaussian train 0.16123555600643158
z0z3 mae gaussian test 0.1618800014257431
z0z3 match_prob vanilla train 1.4641396e-08
z0z3 match_prob vanilla test 1.34115945e-08
z0z3 match_prob gaussian train 1.4641396e-08
z0z3 match_prob gaussian test 1.34115945e-08
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1495
z0z3 xor train 0.13645485
[0 0 0 ... 0 0 0]
222
z0z3 xor test 0.117117114
[0 1 0 ... 0 0 0]
1495
z0z3 compiled_action train 1866.0
[0 0 0 ... 0 0 0]
222
z0z3 compiled_action test 270.0
action true_num_actions train 1495
action true_num_actions test 222
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 47004.7890625, 'tau': 5.0, 'pdiff_z1z2': 0.1692339946826299, 'pdiff_z0z3': 0.16508925325340695, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.25159952938556673, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2173.8070570203995, 'kl_a_z1': 2174.608704969618, 'kl_z1z2': 85.60990566677518, 'kl_z0z3': 89.0918236626519, 'x0y0': 16563.67052951389, 'x1y1': 16642.527777777777, 'x0y3': 37432.28506944444, 'x1y2': 37432.83489583333, 'elbo': 45916.10095486111}, 'test': {'loss': 46497.36328125, 'tau': 5.0, 'pdiff_z1z2': 0.17161130905151367, 'pdiff_z0z3': 0.1659032553434372, 'pdiff_z0z1': 0.08384048938751221, 'pdiff_z0z2': 0.25266870856285095, 'kl_z0': 77.4254379272461, 'kl_z1': 77.72412872314453, 'kl_a_z0': 1394.399658203125, 'kl_a_z1': 1393.9444580078125, 'kl_z1z2': 84.59324645996094, 'kl_z0z3': 89.58425903320312, 'x0y0': 16607.12109375, 'x1y1': 16613.9921875, 'x0y3': 38072.3828125, 'x1y2': 37832.2890625, 'elbo': 45407.29296875}}, 'sae': {'mse': {'vanilla': {'train': 0.14412420988082886, 'test': 0.14418888092041016}, 'gaussian': {'train': 0.14412420988082886, 'test': 0.14418888092041016}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886, 0.14412420988082886], 'xs12': [0.14412420988082886, 9.103879623903119e-15, 9.087153264293688e-15, 9.072623261116488e-15, 9.065429410295457e-15, 9.073614289664775e-15, 9.069741655029929e-15, 9.08892949238408e-15, 9.079579942712288e-15, 9.057309752463077e-15], 'xs13': [0.2340464567462388, 9.08671450122701e-15, 9.058341438592833e-15, 9.052823865974419e-15, 9.034935377161355e-15, 9.085068716210495e-15, 9.044288314964937e-15, 9.070883455442828e-15, 9.058386331339038e-15, 9.078655829766833e-15], 'xs34': [0.23404645666759222, 9.128422403549812e-15, 9.055995157328939e-15, 9.069868709972017e-15, 9.078457624057176e-15, 9.058904715502757e-15, 9.057321610924339e-15, 9.068804836590266e-15, 9.06575551798015e-15, 9.07184822596975e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016, 0.14418888092041016], 'xs12': [0.14418888092041016, 9.16580620267688e-15, 9.226784104549718e-15, 9.10116742440601e-15, 9.160416532033502e-15, 8.861638365383756e-15, 9.045097231429565e-15, 9.101646845054157e-15, 9.156413454324778e-15, 9.03488455518452e-15], 'xs13': [0.23418980042782944, 9.014298266434451e-15, 8.968821914529315e-15, 9.030153029141157e-15, 9.039845627156588e-15, 9.028116761935958e-15, 8.957080343814476e-15, 9.020291871569223e-15, 9.1765974024249e-15, 8.972518366311133e-15], 'xs34': [0.23418980080918506, 9.092127888792913e-15, 8.983022421890034e-15, 9.018301344143175e-15, 9.03196313854944e-15, 8.944524774437326e-15, 8.932990726794564e-15, 9.012636387791938e-15, 9.151181331809588e-15, 9.04824226476272e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.3249377906322479, 'test': 0.3284052908420563}, 'gaussian': {'train': 0.3249377906322479, 'test': 0.3284052908420563}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.16445332765579224, 'test': 0.1658799946308136}, 'gaussian': {'train': 0.16445332765579224, 'test': 0.1658799946308136}}, 'match_prob': {'vanilla': {'train': 7.861192e-09, 'test': 5.712663e-09}, 'gaussian': {'train': 7.861192e-09, 'test': 5.712663e-09}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.10367893, 'test': 0.0990991}, 'compiled_action': {'train': 1654.0, 'test': 245.0}}, 'kl_a_z0': {'train': 2173.8070570203995, 'test': 1394.399658203125}, 'x0y3': {'mse': {'vanilla': {'train': 0.32493293285369873, 'test': 0.33048948645591736}, 'gaussian': {'train': 0.32493293285369873, 'test': 0.3304538428783417}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.16123555600643158, 'test': 0.1618800014257431}, 'gaussian': {'train': 0.16123555600643158, 'test': 0.1618800014257431}}, 'match_prob': {'vanilla': {'train': 1.4641396e-08, 'test': 1.34115945e-08}, 'gaussian': {'train': 1.4641396e-08, 'test': 1.34115945e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.13645485, 'test': 0.117117114}, 'compiled_action': {'train': 1866.0, 'test': 270.0}}, 'action': {'true_num_actions': {'train': 1495, 'test': 222}}}
current_state_var (after training)
0.0
FIN WHILE
IN WHILEE
Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
VAL OF RESUME 
RESUME TRUE in nn_task
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
resuming the training
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x150d55e52fd0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x150d55e52fd0>
<keras.layers.normalization.BatchNormalization object at 0x150d55e2b520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x150d55e2b520>
<keras.layers.core.Dropout object at 0x150d55e2b5e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x150d55e2b5e0>
<keras.layers.convolutional.Conv2D object at 0x150d55e2b640>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x150d55e2b640>
<keras.layers.normalization.BatchNormalization object at 0x150d55e2b760>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x150d55e2b760>
<keras.layers.core.Dropout object at 0x150d55e2b820>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x150d55e2b820>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x150d55e2bdf0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x150d55e2bdf0>
<keras.layers.convolutional.Conv2DTranspose object at 0x150d55e2be20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x150d55e2be20>
<keras.layers.normalization.BatchNormalization object at 0x150d55e2be80>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x150d55e2be80>
<keras.layers.core.Dropout object at 0x150d55e2e580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x150d55e2e580>
<keras.layers.convolutional.Conv2DTranspose object at 0x150d55e2bf40>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x150d55e2bf40>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x150d555b20d0> with <keras_radam.optimizers.RAdam object at 0x150dec048d30>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x150d555b30d0>.
Network compiled
Saving the network to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/
saving additional networks
Network saved
before return NN_TASK
FINISHED TRAINING
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x15236cb69100>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x15236cb69100>
<keras.layers.normalization.BatchNormalization object at 0x15236c97b040>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x15236c97b040>
<keras.layers.core.Dropout object at 0x15236c97b340>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x15236c97b340>
<keras.layers.convolutional.Conv2D object at 0x15236c97b070>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x15236c97b070>
<keras.layers.normalization.BatchNormalization object at 0x15236c97b490>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x15236c97b490>
<keras.layers.core.Dropout object at 0x15236c97b550>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x15236c97b550>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x15236c97bb50>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x15236c97bb50>
<keras.layers.convolutional.Conv2DTranspose object at 0x15236c97bb80>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x15236c97bb80>
<keras.layers.normalization.BatchNormalization object at 0x15236c97bd60>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x15236c97bd60>
<keras.layers.core.Dropout object at 0x15236c97bcd0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x15236c97bcd0>
<keras.layers.convolutional.Conv2DTranspose object at 0x15236c97bca0>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x15236c97bca0>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x15236c0d8e20> with <keras_radam.optimizers.RAdam object at 0x152352c61a00>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x15236c0dd160>.
Network compiled
metrics train {'loss': 46178.61206597222, 'tau': 5.0, 'pdiff_z1z2': 0.16579587360223133, 'pdiff_z0z3': 0.1621715959575441, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.2482193370660146, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2173.4999891493057, 'kl_a_z1': 2174.2760633680555, 'kl_z1z2': 82.94640570746527, 'kl_z0z3': 86.36282518174913, 'x0y0': 16273.954340277778, 'x1y1': 16351.639713541666, 'x0y3': 36671.019270833334, 'x1y2': 36686.40911458333, 'elbo': 45102.05807291667}
metrics test {'loss': 45745.6015625, 'tau': 5.0, 'pdiff_z1z2': 0.16904740035533905, 'pdiff_z0z3': 0.16276586055755615, 'pdiff_z0z1': 0.08384030312299728, 'pdiff_z0z2': 0.2501002848148346, 'kl_z0': 77.4254379272461, 'kl_z1': 77.72417449951172, 'kl_a_z0': 1394.35986328125, 'kl_a_z1': 1393.89111328125, 'kl_z1z2': 82.49742126464844, 'kl_z0z3': 87.71197509765625, 'x0y0': 16318.12109375, 'x1y1': 16323.87890625, 'x0y3': 37026.84765625, 'x1y2': 37647.9609375, 'elbo': 44664.453125}
sae mse vanilla train 0.14160428941249847
sae mse vanilla test 0.14167533814907074
sae mse gaussian train 0.14160428941249847
sae mse gaussian test 0.14167533814907074
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847], 'xs12': [0.14160428941249847, 9.010509488061383e-15, 8.998732341962759e-15, 9.042307951934257e-15, 8.990668588304898e-15, 9.01950582499417e-15, 9.023532619625418e-15, 9.009127977324411e-15, 9.010428172898446e-15, 9.02037911596279e-15], 'xs13': [0.2315280586722378, 9.010128323235118e-15, 8.98898976900344e-15, 8.992434651999923e-15, 9.000087594678366e-15, 9.013410575905729e-15, 9.02019700387913e-15, 9.027993095125659e-15, 9.008031069657717e-15, 9.025147064422884e-15], 'xs34': [0.23152805874522955, 8.991483434000157e-15, 8.994793638758027e-15, 9.012522885377006e-15, 9.014234738963407e-15, 8.977477744217307e-15, 9.030560451988787e-15, 9.011336192217903e-15, 9.025763704408486e-15, 9.02123377220657e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.14167535305023193, 0.14167533814907074, 0.14167533814907074, 0.14167533814907074, 0.14167533814907074, 0.14167533814907074, 0.14167535305023193, 0.14167535305023193, 0.14167533814907074], 'xs12': [0.14167535305023193, 9.009101719303046e-15, 8.898057393983902e-15, 8.923448053610797e-15, 8.88516301142785e-15, 8.90929667416102e-15, 9.081384122889939e-15, 8.956644968879587e-15, 8.85785805734016e-15, 9.006365802883415e-15], 'xs13': [0.2316747099040861, 9.03286099347353e-15, 8.968331482452855e-15, 8.973285778161345e-15, 9.041978456117775e-15, 9.072070148601931e-15, 8.901060972814866e-15, 8.995002855895998e-15, 9.04449414397112e-15, 9.09516450190882e-15], 'xs34': [0.23167471004486065, 8.916992815519772e-15, 8.805732496799078e-15, 9.049710172860312e-15, 9.145873823362093e-15, 9.09422344830442e-15, 8.961118996906985e-15, 9.119051678054338e-15, 9.079801865344468e-15, 8.987958082873684e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.31845858693122864
x1y2 mse vanilla test 0.3268052637577057
x1y2 mse gaussian train 0.31845858693122864
x1y2 mse gaussian test 0.3268052637577057
z1z2 mae vanilla train 0.1609533280134201
z1z2 mae vanilla test 0.164000004529953
z1z2 mae gaussian train 0.1609533280134201
z1z2 mae gaussian test 0.164000004529953
z1z2 match_prob vanilla train 1.22795685e-08
z1z2 match_prob vanilla test 7.528148e-09
z1z2 match_prob gaussian train 1.22795685e-08
z1z2 match_prob gaussian test 7.528148e-09
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1535
z1z2 xor train 0.104885995
[0 0 0 ... 0 0 0]
225
z1z2 xor test 0.08444444
[0 1 0 ... 0 0 0]
1535
z1z2 compiled_action train 1701.0
[0 0 0 ... 0 0 0]
225
z1z2 compiled_action test 244.0
kl_a_z0 train 2173.4999891493057
kl_a_z0 test 1394.35986328125
x0y3 mse vanilla train 0.3183247148990631
x0y3 mse vanilla test 0.3214135766029358
x0y3 mse gaussian train 0.3183247148990631
x0y3 mse gaussian test 0.3214136064052582
z0z3 mae vanilla train 0.15809999406337738
z0z3 mae vanilla test 0.1592400074005127
z0z3 mae gaussian train 0.15809999406337738
z0z3 mae gaussian test 0.1592400074005127
z0z3 match_prob vanilla train 2.1655737e-08
z0z3 match_prob vanilla test 1.8701138e-08
z0z3 match_prob gaussian train 2.1655737e-08
z0z3 match_prob gaussian test 1.8701138e-08
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1535
z0z3 xor train 0.13615635
[0 0 0 ... 0 0 0]
225
z0z3 xor test 0.12444445
[0 1 0 ... 0 0 0]
1535
z0z3 compiled_action train 1914.0
[0 0 0 ... 0 0 0]
225
z0z3 compiled_action test 272.0
action true_num_actions train 1535
action true_num_actions test 225
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 46178.61206597222, 'tau': 5.0, 'pdiff_z1z2': 0.16579587360223133, 'pdiff_z0z3': 0.1621715959575441, 'pdiff_z0z1': 0.08452444573243459, 'pdiff_z0z2': 0.2482193370660146, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2173.4999891493057, 'kl_a_z1': 2174.2760633680555, 'kl_z1z2': 82.94640570746527, 'kl_z0z3': 86.36282518174913, 'x0y0': 16273.954340277778, 'x1y1': 16351.639713541666, 'x0y3': 36671.019270833334, 'x1y2': 36686.40911458333, 'elbo': 45102.05807291667}, 'test': {'loss': 45745.6015625, 'tau': 5.0, 'pdiff_z1z2': 0.16904740035533905, 'pdiff_z0z3': 0.16276586055755615, 'pdiff_z0z1': 0.08384030312299728, 'pdiff_z0z2': 0.2501002848148346, 'kl_z0': 77.4254379272461, 'kl_z1': 77.72417449951172, 'kl_a_z0': 1394.35986328125, 'kl_a_z1': 1393.89111328125, 'kl_z1z2': 82.49742126464844, 'kl_z0z3': 87.71197509765625, 'x0y0': 16318.12109375, 'x1y1': 16323.87890625, 'x0y3': 37026.84765625, 'x1y2': 37647.9609375, 'elbo': 44664.453125}}, 'sae': {'mse': {'vanilla': {'train': 0.14160428941249847, 'test': 0.14167533814907074}, 'gaussian': {'train': 0.14160428941249847, 'test': 0.14167533814907074}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847, 0.14160428941249847], 'xs12': [0.14160428941249847, 9.010509488061383e-15, 8.998732341962759e-15, 9.042307951934257e-15, 8.990668588304898e-15, 9.01950582499417e-15, 9.023532619625418e-15, 9.009127977324411e-15, 9.010428172898446e-15, 9.02037911596279e-15], 'xs13': [0.2315280586722378, 9.010128323235118e-15, 8.98898976900344e-15, 8.992434651999923e-15, 9.000087594678366e-15, 9.013410575905729e-15, 9.02019700387913e-15, 9.027993095125659e-15, 9.008031069657717e-15, 9.025147064422884e-15], 'xs34': [0.23152805874522955, 8.991483434000157e-15, 8.994793638758027e-15, 9.012522885377006e-15, 9.014234738963407e-15, 8.977477744217307e-15, 9.030560451988787e-15, 9.011336192217903e-15, 9.025763704408486e-15, 9.02123377220657e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.14167535305023193, 0.14167533814907074, 0.14167533814907074, 0.14167533814907074, 0.14167533814907074, 0.14167533814907074, 0.14167535305023193, 0.14167535305023193, 0.14167533814907074], 'xs12': [0.14167535305023193, 9.009101719303046e-15, 8.898057393983902e-15, 8.923448053610797e-15, 8.88516301142785e-15, 8.90929667416102e-15, 9.081384122889939e-15, 8.956644968879587e-15, 8.85785805734016e-15, 9.006365802883415e-15], 'xs13': [0.2316747099040861, 9.03286099347353e-15, 8.968331482452855e-15, 8.973285778161345e-15, 9.041978456117775e-15, 9.072070148601931e-15, 8.901060972814866e-15, 8.995002855895998e-15, 9.04449414397112e-15, 9.09516450190882e-15], 'xs34': [0.23167471004486065, 8.916992815519772e-15, 8.805732496799078e-15, 9.049710172860312e-15, 9.145873823362093e-15, 9.09422344830442e-15, 8.961118996906985e-15, 9.119051678054338e-15, 9.079801865344468e-15, 8.987958082873684e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.31845858693122864, 'test': 0.3268052637577057}, 'gaussian': {'train': 0.31845858693122864, 'test': 0.3268052637577057}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.1609533280134201, 'test': 0.164000004529953}, 'gaussian': {'train': 0.1609533280134201, 'test': 0.164000004529953}}, 'match_prob': {'vanilla': {'train': 1.22795685e-08, 'test': 7.528148e-09}, 'gaussian': {'train': 1.22795685e-08, 'test': 7.528148e-09}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.104885995, 'test': 0.08444444}, 'compiled_action': {'train': 1701.0, 'test': 244.0}}, 'kl_a_z0': {'train': 2173.4999891493057, 'test': 1394.35986328125}, 'x0y3': {'mse': {'vanilla': {'train': 0.3183247148990631, 'test': 0.3214135766029358}, 'gaussian': {'train': 0.3183247148990631, 'test': 0.3214136064052582}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.15809999406337738, 'test': 0.1592400074005127}, 'gaussian': {'train': 0.15809999406337738, 'test': 0.1592400074005127}}, 'match_prob': {'vanilla': {'train': 2.1655737e-08, 'test': 1.8701138e-08}, 'gaussian': {'train': 2.1655737e-08, 'test': 1.8701138e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.13615635, 'test': 0.12444445}, 'compiled_action': {'train': 1914.0, 'test': 272.0}}, 'action': {'true_num_actions': {'train': 1535, 'test': 225}}}
current_state_var (after training)
0.0
FIN WHILE
IN WHILEE
Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
VAL OF RESUME 
RESUME TRUE in nn_task
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
resuming the training
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x145f149d1fd0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x145f149d1fd0>
<keras.layers.normalization.BatchNormalization object at 0x145f1c08c520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x145f1c08c520>
<keras.layers.core.Dropout object at 0x145f1c08c5e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x145f1c08c5e0>
<keras.layers.convolutional.Conv2D object at 0x145f1c08c640>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x145f1c08c640>
<keras.layers.normalization.BatchNormalization object at 0x145f1c08c760>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x145f1c08c760>
<keras.layers.core.Dropout object at 0x145f1c08c820>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x145f1c08c820>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x145f1c08cdf0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x145f1c08cdf0>
<keras.layers.convolutional.Conv2DTranspose object at 0x145f1c08ce20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x145f1c08ce20>
<keras.layers.normalization.BatchNormalization object at 0x145f1c08ce80>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x145f1c08ce80>
<keras.layers.core.Dropout object at 0x145f1c090580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x145f1c090580>
<keras.layers.convolutional.Conv2DTranspose object at 0x145f1c08cf40>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x145f1c08cf40>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x145f14130100> with <keras_radam.optimizers.RAdam object at 0x145fa09dad30>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x145f141310d0>.
Network compiled
Saving the network to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/
saving additional networks
Network saved
before return NN_TASK
FINISHED TRAINING
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1537c88371c0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1537c88371c0>
<keras.layers.normalization.BatchNormalization object at 0x1537c8624100>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1537c8624100>
<keras.layers.core.Dropout object at 0x1537c8624400>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1537c8624400>
<keras.layers.convolutional.Conv2D object at 0x1537c8624460>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1537c8624460>
<keras.layers.normalization.BatchNormalization object at 0x1537c8624580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1537c8624580>
<keras.layers.core.Dropout object at 0x1537c8624640>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1537c8624640>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1537c8624c10>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x1537c8624c10>
<keras.layers.convolutional.Conv2DTranspose object at 0x1537c8624c40>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x1537c8624c40>
<keras.layers.normalization.BatchNormalization object at 0x1537c8624e20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1537c8624e20>
<keras.layers.core.Dropout object at 0x1537c8624f40>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1537c8624f40>
<keras.layers.convolutional.Conv2DTranspose object at 0x1537c8624d60>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x1537c8624d60>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1537aeed2ee0> with <keras_radam.optimizers.RAdam object at 0x1537ae96fe50>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1537aeed70d0>.
Network compiled
metrics train {'loss': 45430.725086805556, 'tau': 5.0, 'pdiff_z1z2': 0.16218839519553716, 'pdiff_z0z3': 0.15883679356839922, 'pdiff_z0z1': 0.08452444507016076, 'pdiff_z0z2': 0.24468184875117407, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2173.278397623698, 'kl_a_z1': 2174.035437011719, 'kl_z1z2': 80.31199985080295, 'kl_z0z3': 83.47862192789714, 'x0y0': 16063.403927951389, 'x1y1': 16140.895225694445, 'x0y3': 35892.60703125, 'x1y2': 35793.266493055555, 'elbo': 44366.587934027775}
metrics test {'loss': 45081.79296875, 'tau': 5.0, 'pdiff_z1z2': 0.16591595113277435, 'pdiff_z0z3': 0.15978677570819855, 'pdiff_z0z1': 0.08384022861719131, 'pdiff_z0z2': 0.2469920665025711, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72419738769531, 'kl_a_z0': 1394.34716796875, 'kl_a_z1': 1393.868408203125, 'kl_z1z2': 80.44537353515625, 'kl_z0z3': 85.43672943115234, 'x0y0': 16107.2041015625, 'x1y1': 16113.58203125, 'x0y3': 36279.5859375, 'x1y2': 37046.98046875, 'elbo': 44010.37890625}
sae mse vanilla train 0.1397755891084671
sae mse vanilla test 0.13984714448451996
sae mse gaussian train 0.1397756040096283
sae mse gaussian test 0.13984714448451996
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283], 'xs12': [0.1397756040096283, 8.952281055135333e-15, 8.94780872117383e-15, 8.982948730023622e-15, 8.955356631766814e-15, 8.968390774759163e-15, 8.973024044980644e-15, 8.973005410255804e-15, 8.91893082690309e-15, 8.940576753870173e-15], 'xs13': [0.22970075941330692, 8.94564963419128e-15, 8.94606298626954e-15, 8.967052462702501e-15, 8.93786286030717e-15, 8.941256074293871e-15, 8.957215869086037e-15, 8.959923833418409e-15, 8.956817763600827e-15, 8.9542038199256e-15], 'xs34': [0.22970075940460286, 8.975387266903483e-15, 8.973743175952863e-15, 8.959900963528833e-15, 8.953529581699586e-15, 8.968584745304084e-15, 8.956191806252806e-15, 8.946625416146516e-15, 8.957824038742165e-15, 8.970206813398076e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996], 'xs12': [0.13984714448451996, 9.210281361638362e-15, 8.876109076254649e-15, 8.853219704920996e-15, 8.856129263094814e-15, 8.971200383045205e-15, 8.835641230166627e-15, 8.921461761349486e-15, 8.915364818195149e-15, 8.970015383951997e-15], 'xs13': [0.22984593354707522, 9.02322345259967e-15, 8.871945909318894e-15, 8.919367895903873e-15, 8.923267635593032e-15, 8.934334968081856e-15, 9.02492005959302e-15, 9.040041291767404e-15, 8.961751730518584e-15, 9.149073066803872e-15], 'xs34': [0.22984593368088968, 9.061289960282225e-15, 9.006218419150593e-15, 9.154902347546876e-15, 8.946932042073422e-15, 8.90272539255622e-15, 8.926458408705339e-15, 8.906947004765336e-15, 8.786490449336302e-15, 8.827592723101817e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.3107054829597473
x1y2 mse vanilla test 0.3215882480144501
x1y2 mse gaussian train 0.3107054829597473
x1y2 mse gaussian test 0.3215882480144501
z1z2 mae vanilla train 0.157260000705719
z1z2 mae vanilla test 0.16067999601364136
z1z2 mae gaussian train 0.157260000705719
z1z2 mae gaussian test 0.16067999601364136
z1z2 match_prob vanilla train 1.9716511e-08
z1z2 match_prob vanilla test 1.1439038e-08
z1z2 match_prob gaussian train 1.9716511e-08
z1z2 match_prob gaussian test 1.1439038e-08
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1592
z1z2 xor train 0.109296486
[0 0 0 ... 0 0 0]
225
z1z2 xor test 0.08
[0 1 0 ... 0 0 0]
1592
z1z2 compiled_action train 1773.0
[0 0 0 ... 0 0 0]
225
z1z2 compiled_action test 243.0
kl_a_z0 train 2173.278397623698
kl_a_z0 test 1394.34716796875
x0y3 mse vanilla train 0.31156793236732483
x0y3 mse vanilla test 0.31492698192596436
x0y3 mse gaussian train 0.31156793236732483
x0y3 mse gaussian test 0.31492698192596436
z0z3 mae vanilla train 0.15457555651664734
z0z3 mae vanilla test 0.15612000226974487
z0z3 mae gaussian train 0.15457555651664734
z0z3 mae gaussian test 0.15612000226974487
z0z3 match_prob vanilla train 3.3474038e-08
z0z3 match_prob vanilla test 2.7661992e-08
z0z3 match_prob gaussian train 3.3474038e-08
z0z3 match_prob gaussian test 2.7661992e-08
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1592
z0z3 xor train 0.1356784
[0 0 0 ... 0 0 0]
225
z0z3 xor test 0.12
[0 1 0 ... 0 0 0]
1592
z0z3 compiled_action train 1997.0
[0 0 0 ... 0 0 0]
225
z0z3 compiled_action test 270.0
action true_num_actions train 1592
action true_num_actions test 225
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 45430.725086805556, 'tau': 5.0, 'pdiff_z1z2': 0.16218839519553716, 'pdiff_z0z3': 0.15883679356839922, 'pdiff_z0z1': 0.08452444507016076, 'pdiff_z0z2': 0.24468184875117407, 'kl_z0': 77.30732150607639, 'kl_z1': 77.2721671210395, 'kl_a_z0': 2173.278397623698, 'kl_a_z1': 2174.035437011719, 'kl_z1z2': 80.31199985080295, 'kl_z0z3': 83.47862192789714, 'x0y0': 16063.403927951389, 'x1y1': 16140.895225694445, 'x0y3': 35892.60703125, 'x1y2': 35793.266493055555, 'elbo': 44366.587934027775}, 'test': {'loss': 45081.79296875, 'tau': 5.0, 'pdiff_z1z2': 0.16591595113277435, 'pdiff_z0z3': 0.15978677570819855, 'pdiff_z0z1': 0.08384022861719131, 'pdiff_z0z2': 0.2469920665025711, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72419738769531, 'kl_a_z0': 1394.34716796875, 'kl_a_z1': 1393.868408203125, 'kl_z1z2': 80.44537353515625, 'kl_z0z3': 85.43672943115234, 'x0y0': 16107.2041015625, 'x1y1': 16113.58203125, 'x0y3': 36279.5859375, 'x1y2': 37046.98046875, 'elbo': 44010.37890625}}, 'sae': {'mse': {'vanilla': {'train': 0.1397755891084671, 'test': 0.13984714448451996}, 'gaussian': {'train': 0.1397756040096283, 'test': 0.13984714448451996}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283, 0.1397756040096283], 'xs12': [0.1397756040096283, 8.952281055135333e-15, 8.94780872117383e-15, 8.982948730023622e-15, 8.955356631766814e-15, 8.968390774759163e-15, 8.973024044980644e-15, 8.973005410255804e-15, 8.91893082690309e-15, 8.940576753870173e-15], 'xs13': [0.22970075941330692, 8.94564963419128e-15, 8.94606298626954e-15, 8.967052462702501e-15, 8.93786286030717e-15, 8.941256074293871e-15, 8.957215869086037e-15, 8.959923833418409e-15, 8.956817763600827e-15, 8.9542038199256e-15], 'xs34': [0.22970075940460286, 8.975387266903483e-15, 8.973743175952863e-15, 8.959900963528833e-15, 8.953529581699586e-15, 8.968584745304084e-15, 8.956191806252806e-15, 8.946625416146516e-15, 8.957824038742165e-15, 8.970206813398076e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996, 0.13984714448451996], 'xs12': [0.13984714448451996, 9.210281361638362e-15, 8.876109076254649e-15, 8.853219704920996e-15, 8.856129263094814e-15, 8.971200383045205e-15, 8.835641230166627e-15, 8.921461761349486e-15, 8.915364818195149e-15, 8.970015383951997e-15], 'xs13': [0.22984593354707522, 9.02322345259967e-15, 8.871945909318894e-15, 8.919367895903873e-15, 8.923267635593032e-15, 8.934334968081856e-15, 9.02492005959302e-15, 9.040041291767404e-15, 8.961751730518584e-15, 9.149073066803872e-15], 'xs34': [0.22984593368088968, 9.061289960282225e-15, 9.006218419150593e-15, 9.154902347546876e-15, 8.946932042073422e-15, 8.90272539255622e-15, 8.926458408705339e-15, 8.906947004765336e-15, 8.786490449336302e-15, 8.827592723101817e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.3107054829597473, 'test': 0.3215882480144501}, 'gaussian': {'train': 0.3107054829597473, 'test': 0.3215882480144501}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.157260000705719, 'test': 0.16067999601364136}, 'gaussian': {'train': 0.157260000705719, 'test': 0.16067999601364136}}, 'match_prob': {'vanilla': {'train': 1.9716511e-08, 'test': 1.1439038e-08}, 'gaussian': {'train': 1.9716511e-08, 'test': 1.1439038e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.109296486, 'test': 0.08}, 'compiled_action': {'train': 1773.0, 'test': 243.0}}, 'kl_a_z0': {'train': 2173.278397623698, 'test': 1394.34716796875}, 'x0y3': {'mse': {'vanilla': {'train': 0.31156793236732483, 'test': 0.31492698192596436}, 'gaussian': {'train': 0.31156793236732483, 'test': 0.31492698192596436}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.15457555651664734, 'test': 0.15612000226974487}, 'gaussian': {'train': 0.15457555651664734, 'test': 0.15612000226974487}}, 'match_prob': {'vanilla': {'train': 3.3474038e-08, 'test': 2.7661992e-08}, 'gaussian': {'train': 3.3474038e-08, 'test': 2.7661992e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.1356784, 'test': 0.12}, 'compiled_action': {'train': 1997.0, 'test': 270.0}}, 'action': {'true_num_actions': {'train': 1592, 'test': 225}}}
current_state_var (after training)
0.0
FIN WHILE
IN WHILEE
Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
VAL OF RESUME 
RESUME TRUE in nn_task
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
resuming the training
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1547dca8fee0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1547dca8fee0>
<keras.layers.normalization.BatchNormalization object at 0x1547dca911c0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1547dca911c0>
<keras.layers.core.Dropout object at 0x1547dca91490>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1547dca91490>
<keras.layers.convolutional.Conv2D object at 0x1547dca914f0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1547dca914f0>
<keras.layers.normalization.BatchNormalization object at 0x1547dca91640>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1547dca91640>
<keras.layers.core.Dropout object at 0x1547dca916d0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1547dca916d0>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1547dca91cd0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x1547dca91cd0>
<keras.layers.convolutional.Conv2DTranspose object at 0x1547dca91d00>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x1547dca91d00>
<keras.layers.normalization.BatchNormalization object at 0x1547dca91ee0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1547dca91ee0>
<keras.layers.core.Dropout object at 0x1547dca91df0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1547dca91df0>
<keras.layers.convolutional.Conv2DTranspose object at 0x1547dca91e20>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x1547dca91e20>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1547dc1edfa0> with <keras_radam.optimizers.RAdam object at 0x15486caa8c10>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1547dc1f20d0>.
Network compiled
Saving the network to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/
saving additional networks
Network saved
before return NN_TASK
FINISHED TRAINING
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1501c73cf160>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1501c73cf160>
<keras.layers.normalization.BatchNormalization object at 0x1501c63050a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1501c63050a0>
<keras.layers.core.Dropout object at 0x1501c63053a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1501c63053a0>
<keras.layers.convolutional.Conv2D object at 0x1501c6305400>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x1501c6305400>
<keras.layers.normalization.BatchNormalization object at 0x1501c6305520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1501c6305520>
<keras.layers.core.Dropout object at 0x1501c63055e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1501c63055e0>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1501c6305bb0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x1501c6305bb0>
<keras.layers.convolutional.Conv2DTranspose object at 0x1501c6305be0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x1501c6305be0>
<keras.layers.normalization.BatchNormalization object at 0x1501c6305dc0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x1501c6305dc0>
<keras.layers.core.Dropout object at 0x1501c6305d30>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1501c6305d30>
<keras.layers.convolutional.Conv2DTranspose object at 0x1501c6305d00>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x1501c6305d00>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1501c5a88fd0> with <keras_radam.optimizers.RAdam object at 0x1501c5510760>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1501c5a8d160>.
Network compiled
metrics train {'loss': 44697.60659722222, 'tau': 5.0, 'pdiff_z1z2': 0.15923214422331916, 'pdiff_z0z3': 0.1559652417898178, 'pdiff_z0z1': 0.08452444308333927, 'pdiff_z0z2': 0.2417522109217114, 'kl_z0': 77.30732150607639, 'kl_z1': 77.27216576470269, 'kl_a_z0': 2173.0557237413195, 'kl_a_z1': 2173.794482421875, 'kl_z1z2': 78.0842054578993, 'kl_z0z3': 81.00843166775174, 'x0y0': 15847.757313368056, 'x1y1': 15925.494661458333, 'x0y3': 35081.838368055556, 'x1y2': 35012.616319444445, 'elbo': 43644.040451388886}
metrics test {'loss': 44396.80859375, 'tau': 5.0, 'pdiff_z1z2': 0.1638016402721405, 'pdiff_z0z3': 0.15711691975593567, 'pdiff_z0z1': 0.08384019881486893, 'pdiff_z0z2': 0.24490125477313995, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72420501708984, 'kl_a_z0': 1394.3314208984375, 'kl_a_z1': 1393.84375, 'kl_z1z2': 78.86543273925781, 'kl_z0z3': 84.18128967285156, 'x0y0': 15891.634765625, 'x1y1': 15898.615234375, 'x0y3': 35366.796875, 'x1y2': 36539.859375, 'elbo': 43331.77734375}
sae mse vanilla train 0.13790497183799744
sae mse vanilla test 0.13797856867313385
sae mse gaussian train 0.13790497183799744
sae mse gaussian test 0.13797856867313385
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.13790498673915863, 0.13790497183799744, 0.13790498673915863, 0.13790498673915863, 0.13790498673915863, 0.13790497183799744, 0.13790497183799744, 0.13790497183799744, 0.13790497183799744], 'xs12': [0.13790498673915863, 8.935608905634527e-15, 8.917006368046928e-15, 8.936771881871107e-15, 8.925037087419846e-15, 8.891353975239331e-15, 8.928405737451076e-15, 8.917475624299707e-15, 8.899806517019982e-15, 8.915823910052561e-15], 'xs13': [0.22783077041160216, 8.890205398562855e-15, 8.927844154607047e-15, 8.915744288955519e-15, 8.921566793434945e-15, 8.869325189380089e-15, 8.916044138618847e-15, 8.914022270973751e-15, 8.890071567357188e-15, 8.872820894353407e-15], 'xs34': [0.22783077041969918, 8.91266532419225e-15, 8.899762471306725e-15, 8.905069132721273e-15, 8.918323504279908e-15, 8.917873729784916e-15, 8.901859724884126e-15, 8.8866283784266e-15, 8.904608346797967e-15, 8.88638443293779e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797859847545624, 0.13797856867313385], 'xs12': [0.13797856867313385, 8.948108570837159e-15, 8.936896395714353e-15, 8.980472852718798e-15, 8.859108277970307e-15, 8.776963869778533e-15, 8.967652162029157e-15, 8.811885344127933e-15, 8.769823382033179e-15, 8.984478471526364e-15], 'xs13': [0.22797627355761052, 8.949722168601678e-15, 8.929076587545302e-15, 8.854422491706097e-15, 8.876879029203703e-15, 8.860262783877415e-15, 8.967143942260804e-15, 8.989607256021988e-15, 8.866863711635368e-15, 8.938349057218895e-15], 'xs34': [0.2279762733736531, 8.714622244860616e-15, 8.814406961211909e-15, 8.734108237812201e-15, 8.883209753451481e-15, 8.884932618466197e-15, 9.022910050409186e-15, 8.99640893058844e-15, 9.127441539396892e-15, 9.069100451088857e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.30392879247665405
x1y2 mse vanilla test 0.31718626618385315
x1y2 mse gaussian train 0.30392879247665405
x1y2 mse gaussian test 0.31718626618385315
z1z2 mae vanilla train 0.15400221943855286
z1z2 mae vanilla test 0.1579200029373169
z1z2 mae gaussian train 0.15400221943855286
z1z2 mae gaussian test 0.1579200029373169
z1z2 match_prob vanilla train 2.9801928e-08
z1z2 match_prob vanilla test 1.6414566e-08
z1z2 match_prob gaussian train 2.9801928e-08
z1z2 match_prob gaussian test 1.6414566e-08
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1631
z1z2 xor train 0.10974862
[0 0 0 ... 0 0 0]
228
z1z2 xor test 0.09210526
[0 1 0 ... 0 0 0]
1631
z1z2 compiled_action train 1818.0
[0 0 0 ... 0 0 0]
228
z1z2 compiled_action test 249.0
kl_a_z0 train 2173.0557237413195
kl_a_z0 test 1394.3314208984375
x0y3 mse vanilla train 0.3045300245285034
x0y3 mse vanilla test 0.3070034980773926
x0y3 mse gaussian train 0.3045300245285034
x0y3 mse gaussian test 0.3070034980773926
z0z3 mae vanilla train 0.15167111158370972
z0z3 mae vanilla test 0.15320000052452087
z0z3 mae gaussian train 0.15167111158370972
z0z3 mae gaussian test 0.15320000052452087
z0z3 match_prob vanilla train 4.790143e-08
z0z3 match_prob vanilla test 3.9687592e-08
z0z3 match_prob gaussian train 4.790143e-08
z0z3 match_prob gaussian test 3.9687592e-08
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1631
z0z3 xor train 0.13304721
[0 0 0 ... 0 0 0]
228
z0z3 xor test 0.114035085
[0 1 0 ... 0 0 0]
1631
z0z3 compiled_action train 2048.0
[0 0 0 ... 0 0 0]
228
z0z3 compiled_action test 276.0
action true_num_actions train 1631
action true_num_actions test 228
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 44697.60659722222, 'tau': 5.0, 'pdiff_z1z2': 0.15923214422331916, 'pdiff_z0z3': 0.1559652417898178, 'pdiff_z0z1': 0.08452444308333927, 'pdiff_z0z2': 0.2417522109217114, 'kl_z0': 77.30732150607639, 'kl_z1': 77.27216576470269, 'kl_a_z0': 2173.0557237413195, 'kl_a_z1': 2173.794482421875, 'kl_z1z2': 78.0842054578993, 'kl_z0z3': 81.00843166775174, 'x0y0': 15847.757313368056, 'x1y1': 15925.494661458333, 'x0y3': 35081.838368055556, 'x1y2': 35012.616319444445, 'elbo': 43644.040451388886}, 'test': {'loss': 44396.80859375, 'tau': 5.0, 'pdiff_z1z2': 0.1638016402721405, 'pdiff_z0z3': 0.15711691975593567, 'pdiff_z0z1': 0.08384019881486893, 'pdiff_z0z2': 0.24490125477313995, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72420501708984, 'kl_a_z0': 1394.3314208984375, 'kl_a_z1': 1393.84375, 'kl_z1z2': 78.86543273925781, 'kl_z0z3': 84.18128967285156, 'x0y0': 15891.634765625, 'x1y1': 15898.615234375, 'x0y3': 35366.796875, 'x1y2': 36539.859375, 'elbo': 43331.77734375}}, 'sae': {'mse': {'vanilla': {'train': 0.13790497183799744, 'test': 0.13797856867313385}, 'gaussian': {'train': 0.13790497183799744, 'test': 0.13797856867313385}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.13790498673915863, 0.13790497183799744, 0.13790498673915863, 0.13790498673915863, 0.13790498673915863, 0.13790497183799744, 0.13790497183799744, 0.13790497183799744, 0.13790497183799744], 'xs12': [0.13790498673915863, 8.935608905634527e-15, 8.917006368046928e-15, 8.936771881871107e-15, 8.925037087419846e-15, 8.891353975239331e-15, 8.928405737451076e-15, 8.917475624299707e-15, 8.899806517019982e-15, 8.915823910052561e-15], 'xs13': [0.22783077041160216, 8.890205398562855e-15, 8.927844154607047e-15, 8.915744288955519e-15, 8.921566793434945e-15, 8.869325189380089e-15, 8.916044138618847e-15, 8.914022270973751e-15, 8.890071567357188e-15, 8.872820894353407e-15], 'xs34': [0.22783077041969918, 8.91266532419225e-15, 8.899762471306725e-15, 8.905069132721273e-15, 8.918323504279908e-15, 8.917873729784916e-15, 8.901859724884126e-15, 8.8866283784266e-15, 8.904608346797967e-15, 8.88638443293779e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797856867313385, 0.13797859847545624, 0.13797856867313385], 'xs12': [0.13797856867313385, 8.948108570837159e-15, 8.936896395714353e-15, 8.980472852718798e-15, 8.859108277970307e-15, 8.776963869778533e-15, 8.967652162029157e-15, 8.811885344127933e-15, 8.769823382033179e-15, 8.984478471526364e-15], 'xs13': [0.22797627355761052, 8.949722168601678e-15, 8.929076587545302e-15, 8.854422491706097e-15, 8.876879029203703e-15, 8.860262783877415e-15, 8.967143942260804e-15, 8.989607256021988e-15, 8.866863711635368e-15, 8.938349057218895e-15], 'xs34': [0.2279762733736531, 8.714622244860616e-15, 8.814406961211909e-15, 8.734108237812201e-15, 8.883209753451481e-15, 8.884932618466197e-15, 9.022910050409186e-15, 8.99640893058844e-15, 9.127441539396892e-15, 9.069100451088857e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.30392879247665405, 'test': 0.31718626618385315}, 'gaussian': {'train': 0.30392879247665405, 'test': 0.31718626618385315}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.15400221943855286, 'test': 0.1579200029373169}, 'gaussian': {'train': 0.15400221943855286, 'test': 0.1579200029373169}}, 'match_prob': {'vanilla': {'train': 2.9801928e-08, 'test': 1.6414566e-08}, 'gaussian': {'train': 2.9801928e-08, 'test': 1.6414566e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.10974862, 'test': 0.09210526}, 'compiled_action': {'train': 1818.0, 'test': 249.0}}, 'kl_a_z0': {'train': 2173.0557237413195, 'test': 1394.3314208984375}, 'x0y3': {'mse': {'vanilla': {'train': 0.3045300245285034, 'test': 0.3070034980773926}, 'gaussian': {'train': 0.3045300245285034, 'test': 0.3070034980773926}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.15167111158370972, 'test': 0.15320000052452087}, 'gaussian': {'train': 0.15167111158370972, 'test': 0.15320000052452087}}, 'match_prob': {'vanilla': {'train': 4.790143e-08, 'test': 3.9687592e-08}, 'gaussian': {'train': 4.790143e-08, 'test': 3.9687592e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.13304721, 'test': 0.114035085}, 'compiled_action': {'train': 2048.0, 'test': 276.0}}, 'action': {'true_num_actions': {'train': 1631, 'test': 228}}}
current_state_var (after training)
0.0
FIN WHILE
IN WHILEE
Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
VAL OF RESUME 
RESUME TRUE in nn_task
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
resuming the training
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x153931946fd0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x153931946fd0>
<keras.layers.normalization.BatchNormalization object at 0x153931920520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x153931920520>
<keras.layers.core.Dropout object at 0x1539319205e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x1539319205e0>
<keras.layers.convolutional.Conv2D object at 0x153931920640>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x153931920640>
<keras.layers.normalization.BatchNormalization object at 0x153931920760>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x153931920760>
<keras.layers.core.Dropout object at 0x153931920820>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x153931920820>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x153931920df0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x153931920df0>
<keras.layers.convolutional.Conv2DTranspose object at 0x153931920e20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x153931920e20>
<keras.layers.normalization.BatchNormalization object at 0x153931920e80>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x153931920e80>
<keras.layers.core.Dropout object at 0x153931923580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x153931923580>
<keras.layers.convolutional.Conv2DTranspose object at 0x153931920f40>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x153931920f40>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1539310a40d0> with <keras_radam.optimizers.RAdam object at 0x1539543f6d30>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1539310a60d0>.
Network compiled
Saving the network to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/
saving additional networks
Network saved
before return NN_TASK
FINISHED TRAINING
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14ce28e341c0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14ce28e341c0>
<keras.layers.normalization.BatchNormalization object at 0x14ce28c21100>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ce28c21100>
<keras.layers.core.Dropout object at 0x14ce28c21400>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14ce28c21400>
<keras.layers.convolutional.Conv2D object at 0x14ce28c21460>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14ce28c21460>
<keras.layers.normalization.BatchNormalization object at 0x14ce28c21580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ce28c21580>
<keras.layers.core.Dropout object at 0x14ce28c21640>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14ce28c21640>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14ce28c21c10>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x14ce28c21c10>
<keras.layers.convolutional.Conv2DTranspose object at 0x14ce28c21c40>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14ce28c21c40>
<keras.layers.normalization.BatchNormalization object at 0x14ce28c21e20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ce28c21e20>
<keras.layers.core.Dropout object at 0x14ce28c21f40>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14ce28c21f40>
<keras.layers.convolutional.Conv2DTranspose object at 0x14ce28c21d60>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x14ce28c21d60>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x14ce283a3ee0> with <keras_radam.optimizers.RAdam object at 0x14ce0ef6fe50>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x14ce283a80d0>.
Network compiled
metrics train {'loss': 44006.705555555556, 'tau': 5.0, 'pdiff_z1z2': 0.15621351533465916, 'pdiff_z0z3': 0.15286621716287402, 'pdiff_z0z1': 0.0845244417587916, 'pdiff_z0z2': 0.23877740568584865, 'kl_z0': 77.30732150607639, 'kl_z1': 77.27216508653429, 'kl_a_z0': 2172.857337782118, 'kl_a_z1': 2173.581012641059, 'kl_z1z2': 75.81296997070312, 'kl_z0z3': 78.68600362141927, 'x0y0': 15639.153580729168, 'x1y1': 15717.0744140625, 'x0y3': 34385.94453125, 'x1y2': 34242.73003472222, 'elbo': 42963.474565972225}
metrics test {'loss': 43997.6484375, 'tau': 5.0, 'pdiff_z1z2': 0.16284509003162384, 'pdiff_z0z3': 0.1560298651456833, 'pdiff_z0z1': 0.08384018391370773, 'pdiff_z0z2': 0.24390099942684174, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72421264648438, 'kl_a_z0': 1394.3162841796875, 'kl_a_z1': 1393.8216552734375, 'kl_z1z2': 78.69683074951172, 'kl_z0z3': 83.9001235961914, 'x0y0': 15682.9775390625, 'x1y1': 15690.375, 'x0y3': 35192.5546875, 'x1y2': 36372.75390625, 'elbo': 42933.63671875}
sae mse vanilla train 0.13609491288661957
sae mse vanilla test 0.13616909086704254
sae mse gaussian train 0.13609489798545837
sae mse gaussian test 0.13616909086704254
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609488308429718, 0.13609491288661957], 'xs12': [0.13609489798545837, 8.880114695062214e-15, 8.886578403482712e-15, 8.92231472352737e-15, 8.891406491282061e-15, 8.886165898437399e-15, 8.91994896050569e-15, 8.919854939848544e-15, 8.869483584541225e-15, 8.934841493784314e-15], 'xs13': [0.2260220416004474, 8.877067070517993e-15, 8.912209620466627e-15, 8.919582195239528e-15, 8.918874922728571e-15, 8.88991994845963e-15, 8.884821657150106e-15, 8.885453543728758e-15, 8.87197809657089e-15, 8.863968553021653e-15], 'xs34': [0.22602204154482441, 8.896013503482177e-15, 8.894630298679311e-15, 8.871855276793537e-15, 8.90873509131699e-15, 8.901593756538689e-15, 8.860783709139976e-15, 8.889399870230016e-15, 8.859658849386023e-15, 8.867555737553275e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616912066936493, 0.13616912066936493, 0.13616909086704254], 'xs12': [0.13616909086704254, 8.861705280986589e-15, 8.86376272401547e-15, 8.812489278619325e-15, 8.768921291944353e-15, 8.785146208049009e-15, 8.951309508344833e-15, 8.913540309226763e-15, 8.74819778385683e-15, 8.71559294461817e-15], 'xs13': [0.22616624920314293, 8.760116384457645e-15, 8.841563684533829e-15, 8.84347628492873e-15, 8.855637983985407e-15, 8.782970180407513e-15, 8.758786542730455e-15, 8.876244601526209e-15, 8.907285817944238e-15, 8.990715175116997e-15], 'xs34': [0.22616624916967243, 8.849712988519363e-15, 8.84750477362587e-15, 8.901135511714224e-15, 8.78358512632722e-15, 8.887683781478879e-15, 8.758650170425947e-15, 8.780281697832928e-15, 9.018934924787721e-15, 8.88157497986328e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.2972460091114044
x1y2 mse vanilla test 0.31573572754859924
x1y2 mse gaussian train 0.2972460091114044
x1y2 mse gaussian test 0.31573572754859924
z1z2 mae vanilla train 0.1511644423007965
z1z2 mae vanilla test 0.15756000578403473
z1z2 mae gaussian train 0.1511644423007965
z1z2 mae gaussian test 0.15756000578403473
z1z2 match_prob vanilla train 4.294337e-08
z1z2 match_prob vanilla test 1.7931157e-08
z1z2 match_prob gaussian train 4.294337e-08
z1z2 match_prob gaussian test 1.7931157e-08
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1658
z1z2 xor train 0.113389626
[0 0 0 ... 0 0 0]
228
z1z2 xor test 0.096491225
[0 1 0 ... 0 0 0]
1658
z1z2 compiled_action train 1852.0
[0 0 0 ... 0 0 0]
228
z1z2 compiled_action test 250.0
kl_a_z0 train 2172.857337782118
kl_a_z0 test 1394.3162841796875
x0y3 mse vanilla train 0.29848912358283997
x0y3 mse vanilla test 0.30549097061157227
x0y3 mse gaussian train 0.29848912358283997
x0y3 mse gaussian test 0.3054909408092499
z0z3 mae vanilla train 0.1487022191286087
z0z3 mae vanilla test 0.15228000283241272
z0z3 mae gaussian train 0.1487022191286087
z0z3 mae gaussian test 0.15228000283241272
z0z3 match_prob vanilla train 6.913934e-08
z0z3 match_prob vanilla test 4.486885e-08
z0z3 match_prob gaussian train 6.913934e-08
z0z3 match_prob gaussian test 4.486885e-08
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1658
z0z3 xor train 0.13088058
[0 0 0 ... 0 0 0]
228
z0z3 xor test 0.10526316
[0 1 0 ... 0 0 0]
1658
z0z3 compiled_action train 2083.0
[0 0 0 ... 0 0 0]
228
z0z3 compiled_action test 274.0
action true_num_actions train 1658
action true_num_actions test 228
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 44006.705555555556, 'tau': 5.0, 'pdiff_z1z2': 0.15621351533465916, 'pdiff_z0z3': 0.15286621716287402, 'pdiff_z0z1': 0.0845244417587916, 'pdiff_z0z2': 0.23877740568584865, 'kl_z0': 77.30732150607639, 'kl_z1': 77.27216508653429, 'kl_a_z0': 2172.857337782118, 'kl_a_z1': 2173.581012641059, 'kl_z1z2': 75.81296997070312, 'kl_z0z3': 78.68600362141927, 'x0y0': 15639.153580729168, 'x1y1': 15717.0744140625, 'x0y3': 34385.94453125, 'x1y2': 34242.73003472222, 'elbo': 42963.474565972225}, 'test': {'loss': 43997.6484375, 'tau': 5.0, 'pdiff_z1z2': 0.16284509003162384, 'pdiff_z0z3': 0.1560298651456833, 'pdiff_z0z1': 0.08384018391370773, 'pdiff_z0z2': 0.24390099942684174, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72421264648438, 'kl_a_z0': 1394.3162841796875, 'kl_a_z1': 1393.8216552734375, 'kl_z1z2': 78.69683074951172, 'kl_z0z3': 83.9001235961914, 'x0y0': 15682.9775390625, 'x1y1': 15690.375, 'x0y3': 35192.5546875, 'x1y2': 36372.75390625, 'elbo': 42933.63671875}}, 'sae': {'mse': {'vanilla': {'train': 0.13609491288661957, 'test': 0.13616909086704254}, 'gaussian': {'train': 0.13609489798545837, 'test': 0.13616909086704254}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609489798545837, 0.13609488308429718, 0.13609491288661957], 'xs12': [0.13609489798545837, 8.880114695062214e-15, 8.886578403482712e-15, 8.92231472352737e-15, 8.891406491282061e-15, 8.886165898437399e-15, 8.91994896050569e-15, 8.919854939848544e-15, 8.869483584541225e-15, 8.934841493784314e-15], 'xs13': [0.2260220416004474, 8.877067070517993e-15, 8.912209620466627e-15, 8.919582195239528e-15, 8.918874922728571e-15, 8.88991994845963e-15, 8.884821657150106e-15, 8.885453543728758e-15, 8.87197809657089e-15, 8.863968553021653e-15], 'xs34': [0.22602204154482441, 8.896013503482177e-15, 8.894630298679311e-15, 8.871855276793537e-15, 8.90873509131699e-15, 8.901593756538689e-15, 8.860783709139976e-15, 8.889399870230016e-15, 8.859658849386023e-15, 8.867555737553275e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616909086704254, 0.13616912066936493, 0.13616912066936493, 0.13616909086704254], 'xs12': [0.13616909086704254, 8.861705280986589e-15, 8.86376272401547e-15, 8.812489278619325e-15, 8.768921291944353e-15, 8.785146208049009e-15, 8.951309508344833e-15, 8.913540309226763e-15, 8.74819778385683e-15, 8.71559294461817e-15], 'xs13': [0.22616624920314293, 8.760116384457645e-15, 8.841563684533829e-15, 8.84347628492873e-15, 8.855637983985407e-15, 8.782970180407513e-15, 8.758786542730455e-15, 8.876244601526209e-15, 8.907285817944238e-15, 8.990715175116997e-15], 'xs34': [0.22616624916967243, 8.849712988519363e-15, 8.84750477362587e-15, 8.901135511714224e-15, 8.78358512632722e-15, 8.887683781478879e-15, 8.758650170425947e-15, 8.780281697832928e-15, 9.018934924787721e-15, 8.88157497986328e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.2972460091114044, 'test': 0.31573572754859924}, 'gaussian': {'train': 0.2972460091114044, 'test': 0.31573572754859924}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.1511644423007965, 'test': 0.15756000578403473}, 'gaussian': {'train': 0.1511644423007965, 'test': 0.15756000578403473}}, 'match_prob': {'vanilla': {'train': 4.294337e-08, 'test': 1.7931157e-08}, 'gaussian': {'train': 4.294337e-08, 'test': 1.7931157e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.113389626, 'test': 0.096491225}, 'compiled_action': {'train': 1852.0, 'test': 250.0}}, 'kl_a_z0': {'train': 2172.857337782118, 'test': 1394.3162841796875}, 'x0y3': {'mse': {'vanilla': {'train': 0.29848912358283997, 'test': 0.30549097061157227}, 'gaussian': {'train': 0.29848912358283997, 'test': 0.3054909408092499}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.1487022191286087, 'test': 0.15228000283241272}, 'gaussian': {'train': 0.1487022191286087, 'test': 0.15228000283241272}}, 'match_prob': {'vanilla': {'train': 6.913934e-08, 'test': 4.486885e-08}, 'gaussian': {'train': 6.913934e-08, 'test': 4.486885e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.13088058, 'test': 0.10526316}, 'compiled_action': {'train': 2083.0, 'test': 274.0}}, 'action': {'true_num_actions': {'train': 1658, 'test': 228}}}
current_state_var (after training)
0.0
FIN WHILE
IN WHILEE
Default float: float32
{'mode': 'learn', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
VAL OF RESUME 
RESUME TRUE in nn_task
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
resuming the training
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14732a26cfd0>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14732a26cfd0>
<keras.layers.normalization.BatchNormalization object at 0x14732a4174c0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14732a4174c0>
<keras.layers.core.Dropout object at 0x14732a417580>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14732a417580>
<keras.layers.convolutional.Conv2D object at 0x14732a4175e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14732a4175e0>
<keras.layers.normalization.BatchNormalization object at 0x14732a417700>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14732a417700>
<keras.layers.core.Dropout object at 0x14732a4177c0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14732a4177c0>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14732a417d90>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x14732a417d90>
<keras.layers.convolutional.Conv2DTranspose object at 0x14732a417dc0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14732a417dc0>
<keras.layers.normalization.BatchNormalization object at 0x14732a417e20>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14732a417e20>
<keras.layers.core.Dropout object at 0x14732a41c520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14732a41c520>
<keras.layers.convolutional.Conv2DTranspose object at 0x14732a417ee0>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x14732a417ee0>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1473299cc0a0> with <keras_radam.optimizers.RAdam object at 0x147329468730>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1473299cd0d0>.
Network compiled
Saving the network to samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/
saving additional networks
Network saved
before return NN_TASK
FINISHED TRAINING
Default float: float32
{'mode': 'report', 'type': 'mnist', 'width': 3, 'height': 3, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': 'SomeTime480'}
loaded. picsize: [48, 48]
(5000, 2, 48, 48, 1)
normalized shape: (48, 48, 1) (48, 48, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/puzzle_mnist_3_3_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/SomeTime480/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14ba8c1c9160>
[0, 48, 48, 1] -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14ba8c1c9160>
<keras.layers.normalization.BatchNormalization object at 0x14ba72aab0a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ba72aab0a0>
<keras.layers.core.Dropout object at 0x14ba72aab3a0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14ba72aab3a0>
<keras.layers.convolutional.Conv2D object at 0x14ba72aab400>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2D object at 0x14ba72aab400>
<keras.layers.normalization.BatchNormalization object at 0x14ba72aab520>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ba72aab520>
<keras.layers.core.Dropout object at 0x14ba72aab5e0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14ba72aab5e0>
latent space shape is (48, 48, 32) : 100 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 48 W: 48 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14ba72aabbb0>
[0, 48, 48, 32] -> (0, 48, 48, 32) : <keras.layers.core.Reshape object at 0x14ba72aabbb0>
<keras.layers.convolutional.Conv2DTranspose object at 0x14ba72aabbe0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14ba72aabbe0>
<keras.layers.normalization.BatchNormalization object at 0x14ba72aabdc0>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.normalization.BatchNormalization object at 0x14ba72aabdc0>
<keras.layers.core.Dropout object at 0x14ba72aabd30>
(0, 48, 48, 32) -> (0, 48, 48, 32) : <keras.layers.core.Dropout object at 0x14ba72aabd30>
<keras.layers.convolutional.Conv2DTranspose object at 0x14ba72aabd00>
(0, 48, 48, 32) -> (0, 48, 48, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x14ba72aabd00>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x14ba7222ee50> with <keras_radam.optimizers.RAdam object at 0x14ba71c7ca60>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x14ba72233160>.
Network compiled
metrics train {'loss': 43458.66970486111, 'tau': 5.0, 'pdiff_z1z2': 0.15345183147324457, 'pdiff_z0z3': 0.1498631371392144, 'pdiff_z0z1': 0.08452443977197012, 'pdiff_z0z2': 0.23604397873083752, 'kl_z0': 77.30732150607639, 'kl_z1': 77.27216508653429, 'kl_a_z0': 2172.6751790364583, 'kl_a_z1': 2173.3877739800346, 'kl_z1z2': 73.66688368055556, 'kl_z0z3': 76.71235504150391, 'x0y0': 15483.717903645833, 'x1y1': 15562.084613715278, 'x0y3': 33670.12703993056, 'x1y2': 33739.64053819444, 'elbo': 42424.71032986111}
metrics test {'loss': 43408.45703125, 'tau': 5.0, 'pdiff_z1z2': 0.159635990858078, 'pdiff_z0z3': 0.15218041837215424, 'pdiff_z0z1': 0.08384020626544952, 'pdiff_z0z2': 0.24069255590438843, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72420501708984, 'kl_a_z0': 1394.29736328125, 'kl_a_z1': 1393.7967529296875, 'kl_z1z2': 75.29890441894531, 'kl_z0z3': 80.98951721191406, 'x0y0': 15527.0703125, 'x1y1': 15535.6337890625, 'x0y3': 34692.921875, 'x1y2': 35510.71484375, 'elbo': 42358.6328125}
sae mse vanilla train 0.1347476691007614
sae mse vanilla test 0.13482080399990082
sae mse gaussian train 0.1347476691007614
sae mse gaussian test 0.13482080399990082
sae activation train 0.30386221408843994
sae activation test 0.3051599860191345
sae ever_1 train 99.0
sae ever_1 test 99.0
sae ever_0 train 100.0
sae ever_0 test 100.0
sae effective train 99.0
sae effective test 99.0
sae variance gaussian train {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614], 'xs12': [0.1347476691007614, 8.846699245293032e-15, 8.825217642717716e-15, 8.842194724079534e-15, 8.824297764936997e-15, 8.839488453813056e-15, 8.814434913299168e-15, 8.81678204159601e-15, 8.797022457002462e-15, 8.805618994384146e-15], 'xs13': [0.22467474807862964, 8.80831086509052e-15, 8.805529208891737e-15, 8.813054249595144e-15, 8.836863498709515e-15, 8.837957865277368e-15, 8.8265025916987e-15, 8.826585600927531e-15, 8.838053580000407e-15, 8.81375559287547e-15], 'xs34': [0.22467474805927778, 8.839314812058869e-15, 8.80162862216963e-15, 8.815886727770762e-15, 8.814694952413975e-15, 8.808847883979079e-15, 8.819225731648839e-15, 8.806931048419443e-15, 8.827333531019957e-15, 8.779332173899056e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
cycle_consistency test {'xs01': [0.0, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082], 'xs12': [0.13482080399990082, 8.724451215180555e-15, 8.84907517271008e-15, 8.832574970897566e-15, 8.86583287253856e-15, 8.807139418524467e-15, 8.646417457881805e-15, 8.839876394902899e-15, 8.779200036759284e-15, 8.834007303611374e-15], 'xs13': [0.22481873700777427, 8.766046462121372e-15, 8.91560198742038e-15, 8.898465663864479e-15, 8.889328719462446e-15, 8.866536756917728e-15, 8.795038705839992e-15, 8.83422753217766e-15, 8.725312647687913e-15, 8.923237989439878e-15], 'xs34': [0.22481873719904455, 8.774583707196748e-15, 8.879789434410468e-15, 8.845704828612955e-15, 8.887001072923392e-15, 8.922685723958268e-15, 8.9014362084105e-15, 8.95927585321376e-15, 8.846607765734728e-15, 8.847966406582124e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.2928786277770996
x1y2 mse vanilla test 0.30825281143188477
x1y2 mse gaussian train 0.2928786277770996
x1y2 mse gaussian test 0.30825281143188477
z1z2 mae vanilla train 0.14849333465099335
z1z2 mae vanilla test 0.15423999726772308
z1z2 mae gaussian train 0.14849333465099335
z1z2 mae gaussian test 0.15423999726772308
z1z2 match_prob vanilla train 5.985723e-08
z1z2 match_prob vanilla test 2.7228472e-08
z1z2 match_prob gaussian train 5.985723e-08
z1z2 match_prob gaussian test 2.7228472e-08
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1684
z1z2 xor train 0.119358666
[0 0 0 ... 0 0 0]
229
z1z2 xor test 0.10043668
[0 1 0 ... 0 0 0]
1684
z1z2 compiled_action train 1892.0
[0 0 0 ... 0 0 0]
229
z1z2 compiled_action test 252.0
kl_a_z0 train 2172.6751790364583
kl_a_z0 test 1394.29736328125
x0y3 mse vanilla train 0.2922755479812622
x0y3 mse vanilla test 0.30115383863449097
x0y3 mse gaussian train 0.2922755479812622
x0y3 mse gaussian test 0.30115383863449097
z0z3 mae vanilla train 0.14535555243492126
z0z3 mae vanilla test 0.1469999998807907
z0z3 mae gaussian train 0.14535555243492126
z0z3 mae gaussian test 0.1469999998807907
z0z3 match_prob vanilla train 1.041284e-07
z0z3 match_prob vanilla test 8.388608e-08
z0z3 match_prob gaussian train 1.041284e-07
z0z3 match_prob gaussian test 8.388608e-08
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 1 0 ... 0 0 0]
1684
z0z3 xor train 0.12707838
[0 0 0 ... 0 0 0]
229
z0z3 xor test 0.11353712
[0 1 0 ... 0 0 0]
1684
z0z3 compiled_action train 2118.0
[0 0 0 ... 0 0 0]
229
z0z3 compiled_action test 277.0
action true_num_actions train 1684
action true_num_actions test 229
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 43458.66970486111, 'tau': 5.0, 'pdiff_z1z2': 0.15345183147324457, 'pdiff_z0z3': 0.1498631371392144, 'pdiff_z0z1': 0.08452443977197012, 'pdiff_z0z2': 0.23604397873083752, 'kl_z0': 77.30732150607639, 'kl_z1': 77.27216508653429, 'kl_a_z0': 2172.6751790364583, 'kl_a_z1': 2173.3877739800346, 'kl_z1z2': 73.66688368055556, 'kl_z0z3': 76.71235504150391, 'x0y0': 15483.717903645833, 'x1y1': 15562.084613715278, 'x0y3': 33670.12703993056, 'x1y2': 33739.64053819444, 'elbo': 42424.71032986111}, 'test': {'loss': 43408.45703125, 'tau': 5.0, 'pdiff_z1z2': 0.159635990858078, 'pdiff_z0z3': 0.15218041837215424, 'pdiff_z0z1': 0.08384020626544952, 'pdiff_z0z2': 0.24069255590438843, 'kl_z0': 77.42545318603516, 'kl_z1': 77.72420501708984, 'kl_a_z0': 1394.29736328125, 'kl_a_z1': 1393.7967529296875, 'kl_z1z2': 75.29890441894531, 'kl_z0z3': 80.98951721191406, 'x0y0': 15527.0703125, 'x1y1': 15535.6337890625, 'x0y3': 34692.921875, 'x1y2': 35510.71484375, 'elbo': 42358.6328125}}, 'sae': {'mse': {'vanilla': {'train': 0.1347476691007614, 'test': 0.13482080399990082}, 'gaussian': {'train': 0.1347476691007614, 'test': 0.13482080399990082}}, 'activation': {'train': 0.30386221408843994, 'test': 0.3051599860191345}, 'ever_1': {'train': 99.0, 'test': 99.0}, 'ever_0': {'train': 100.0, 'test': 100.0}, 'effective': {'train': 99.0, 'test': 99.0}, 'variance': {'gaussian': {'train': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614, 0.1347476691007614], 'xs12': [0.1347476691007614, 8.846699245293032e-15, 8.825217642717716e-15, 8.842194724079534e-15, 8.824297764936997e-15, 8.839488453813056e-15, 8.814434913299168e-15, 8.81678204159601e-15, 8.797022457002462e-15, 8.805618994384146e-15], 'xs13': [0.22467474807862964, 8.80831086509052e-15, 8.805529208891737e-15, 8.813054249595144e-15, 8.836863498709515e-15, 8.837957865277368e-15, 8.8265025916987e-15, 8.826585600927531e-15, 8.838053580000407e-15, 8.81375559287547e-15], 'xs34': [0.22467474805927778, 8.839314812058869e-15, 8.80162862216963e-15, 8.815886727770762e-15, 8.814694952413975e-15, 8.808847883979079e-15, 8.819225731648839e-15, 8.806931048419443e-15, 8.827333531019957e-15, 8.779332173899056e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, 'test': {'xs01': [0.0, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082, 0.13482080399990082], 'xs12': [0.13482080399990082, 8.724451215180555e-15, 8.84907517271008e-15, 8.832574970897566e-15, 8.86583287253856e-15, 8.807139418524467e-15, 8.646417457881805e-15, 8.839876394902899e-15, 8.779200036759284e-15, 8.834007303611374e-15], 'xs13': [0.22481873700777427, 8.766046462121372e-15, 8.91560198742038e-15, 8.898465663864479e-15, 8.889328719462446e-15, 8.866536756917728e-15, 8.795038705839992e-15, 8.83422753217766e-15, 8.725312647687913e-15, 8.923237989439878e-15], 'xs34': [0.22481873719904455, 8.774583707196748e-15, 8.879789434410468e-15, 8.845704828612955e-15, 8.887001072923392e-15, 8.922685723958268e-15, 8.9014362084105e-15, 8.95927585321376e-15, 8.846607765734728e-15, 8.847966406582124e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.2928786277770996, 'test': 0.30825281143188477}, 'gaussian': {'train': 0.2928786277770996, 'test': 0.30825281143188477}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.14849333465099335, 'test': 0.15423999726772308}, 'gaussian': {'train': 0.14849333465099335, 'test': 0.15423999726772308}}, 'match_prob': {'vanilla': {'train': 5.985723e-08, 'test': 2.7228472e-08}, 'gaussian': {'train': 5.985723e-08, 'test': 2.7228472e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.119358666, 'test': 0.10043668}, 'compiled_action': {'train': 1892.0, 'test': 252.0}}, 'kl_a_z0': {'train': 2172.6751790364583, 'test': 1394.29736328125}, 'x0y3': {'mse': {'vanilla': {'train': 0.2922755479812622, 'test': 0.30115383863449097}, 'gaussian': {'train': 0.2922755479812622, 'test': 0.30115383863449097}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.14535555243492126, 'test': 0.1469999998807907}, 'gaussian': {'train': 0.14535555243492126, 'test': 0.1469999998807907}}, 'match_prob': {'vanilla': {'train': 1.041284e-07, 'test': 8.388608e-08}, 'gaussian': {'train': 1.041284e-07, 'test': 8.388608e-08}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.12707838, 'test': 0.11353712}, 'compiled_action': {'train': 2118.0, 'test': 277.0}}, 'action': {'true_num_actions': {'train': 1684, 'test': 229}}}
current_state_var (after training)
0.0
FIN WHILE
