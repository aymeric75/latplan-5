Default float: float32
{'mode': 'report', 'track': 'sokoban_image-20000-global-global-2-train', 'num_examples': 20000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-15T19:34:32.887'}
loaded. picsize: [28 28  3]
(19999, 2, 28, 28, 3)
normalized shape: (28, 28, 3) (28, 28, 3)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/sokoban_sokoban_image-20000-global-global-2-train_20000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-15T19:34:32.887/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 28 W: 28 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x14580498d790>
[0, 28, 28, 3] -> (0, 28, 28, 32) : <keras.layers.convolutional.Conv2D object at 0x14580498d790>
<keras.layers.normalization.BatchNormalization object at 0x145804724910>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.normalization.BatchNormalization object at 0x145804724910>
<keras.layers.core.Dropout object at 0x1458047249d0>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.core.Dropout object at 0x1458047249d0>
<keras.layers.convolutional.Conv2D object at 0x145804724a30>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.convolutional.Conv2D object at 0x145804724a30>
<keras.layers.normalization.BatchNormalization object at 0x145804724b50>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.normalization.BatchNormalization object at 0x145804724b50>
<keras.layers.core.Dropout object at 0x145804724c10>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.core.Dropout object at 0x145804724c10>
latent space shape is (28, 28, 32) : 50 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 28 W: 28 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x14580493d1c0>
[0, 28, 28, 32] -> (0, 28, 28, 32) : <keras.layers.core.Reshape object at 0x14580493d1c0>
<keras.layers.convolutional.Conv2DTranspose object at 0x14580493d1f0>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x14580493d1f0>
<keras.layers.normalization.BatchNormalization object at 0x14580493d430>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.normalization.BatchNormalization object at 0x14580493d430>
<keras.layers.core.Dropout object at 0x14580493d970>
(0, 28, 28, 32) -> (0, 28, 28, 32) : <keras.layers.core.Dropout object at 0x14580493d970>
<keras.layers.convolutional.Conv2DTranspose object at 0x14580493d370>
(0, 28, 28, 32) -> (0, 28, 28, 3) : <keras.layers.convolutional.Conv2DTranspose object at 0x14580493d370>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1457febd1460> with <keras_radam.optimizers.RAdam object at 0x1457fe60fe80>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1457fecc5d30>.
Network compiled
metrics train {'loss': 2052.931076506746, 'tau': 5.0, 'pdiff_z1z2': 0.0011935113930492732, 'pdiff_z0z3': 0.0010142928833020636, 'pdiff_z0z1': 0.12227902505667887, 'pdiff_z0z2': 0.12209619160387024, 'kl_z0': 58.14121725532875, 'kl_z1': 57.25932535756144, 'kl_a_z0': 1597.3669381032778, 'kl_a_z1': 1597.3924207065866, 'kl_z1z2': 0.1662436741268617, 'kl_z0z3': 0.21246622243178037, 'x0y0': 139.14245828344224, 'x1y1': 162.02098002535243, 'x0y3': 141.66933367703913, 'x1y2': 167.53499728442895, 'elbo': 1958.3482689006812}
metrics test {'loss': 1905.026904296875, 'tau': 5.0, 'pdiff_z1z2': 0.0012690716190263628, 'pdiff_z0z3': 0.0011923516634851695, 'pdiff_z0z1': 0.12116897255182266, 'pdiff_z0z2': 0.12099040299654007, 'kl_z0': 58.2077278137207, 'kl_z1': 57.4924560546875, 'kl_a_z0': 1431.9106567382812, 'kl_a_z1': 1431.9404418945312, 'kl_z1z2': 0.20616926848888398, 'kl_z0z3': 0.238665372133255, 'x0y0': 143.50484924316407, 'x1y1': 158.41697387695314, 'x0y3': 148.40286865234376, 'x1y2': 162.00193481445314, 'elbo': 1793.92939453125}
sae mse vanilla train 0.0012804569824360738
sae mse vanilla test 0.001283681408659232
sae mse gaussian train 0.0012802520928147595
sae mse gaussian test 0.0012796912797414287
sae activation train 0.4773687422275543
sae activation test 0.4787299931049347
sae ever_1 train 50.0
sae ever_1 test 50.0
sae ever_0 train 50.0
sae ever_0 test 50.0
sae effective train 50.0
sae effective test 50.0
sae variance gaussian train {'max': 0.25, 'min': 0.0, 'mean': 0.00013488525291904807, 'median': 0.0}
sae variance gaussian test {'max': 0.25, 'min': 0.0, 'mean': 0.00015310000162571669, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.001280457070850356, 0.0012775412271469123, 0.001280764057869651, 0.0012775812129422596, 0.0012806523632056695, 0.0012776529218108937, 0.001280692349001017, 0.0012775412271469123, 0.001280764057869651], 'xs12': [0.001280457070850356, 2.349304486415349e-05, 2.2539901692653075e-05, 2.263403803226538e-05, 2.235912143078167e-05, 2.2539901692653075e-05, 2.263403803226538e-05, 2.235912143078167e-05, 2.2539901692653075e-05, 2.263403803226538e-05], 'xs13': [0.09128878194605401, 1.9080513084190898e-05, 9.326757208327763e-06, 1.4277953596320003e-05, 9.154728104476817e-06, 1.4065643881622236e-05, 9.310544555773959e-06, 1.412213623552816e-05, 9.098236660065595e-06, 1.4277953596320003e-05], 'xs34': [0.09129274110375973, 2.710541957640089e-05, 2.272322672070004e-05, 2.2610503947362304e-05, 2.2427850126405247e-05, 2.249470526294317e-05, 2.2610503947362304e-05, 2.2427850126405247e-05, 2.249470526294317e-05, 2.2610503947362304e-05], 'zs01': [0.0, 0.00037724318099208176, 7.444858056260273e-05, 0.00037502084160223603, 7.222623389679939e-05, 0.0003794655203819275, 7.000388723099604e-05, 0.00037724318099208176, 7.444858056260273e-05, 0.00037502084160223603], 'zs12': [0.00037724318099208176, 0.00034168566344305873, 0.00034390800283290446, 0.00034168566344305873, 0.00034168566344305873, 0.00034390800283290446, 0.00034168566344305873, 0.00034168566344305873, 0.00034390800283290446, 0.00034168566344305873], 'zs13': [0.0002539029810577631, 0.00021778987138532102, 0.00013778543507214636, 0.00021890105563215911, 0.0001366742653772235, 0.00021834546350874007, 0.00013834101264365017, 0.0002172342938138172, 0.00013778543507214636, 0.00021890105563215911], 'zs34': [0.00044502472155727446, 0.0003422412264626473, 0.0003433524107094854, 0.0003422412264626473, 0.00034168566344305873, 0.0003433524107094854, 0.0003422412264626473, 0.00034168566344305873, 0.0003433524107094854, 0.0003422412264626473]}
cycle_consistency test {'xs01': [0.0, 0.001283681496349528, 0.001276768160726415, 0.0012826958721996495, 0.001276768160726415, 0.0012826958721996495, 0.001276768160726415, 0.0012826958721996495, 0.001276768160726415, 0.0012826958721996495], 'xs12': [0.001283681496349528, 3.150239717797376e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05], 'xs13': [0.09130521989549675, 2.3507876903750002e-05, 1.169468214357039e-05, 2.0042156393174082e-05, 1.169468214357039e-05, 2.0042156393174082e-05, 1.169468214357039e-05, 2.0042156393174082e-05, 1.169468214357039e-05, 2.0042156393174082e-05], 'xs34': [0.0913098496237943, 3.394441955606453e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05], 'zs01': [0.0, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801], 'zs12': [0.0004799999878741801, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652], 'zs13': [0.00031999999191612005, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475], 'zs34': [0.0005699999746866524, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652]}
x1y2 mse vanilla train 0.0014246175319823
x1y2 mse vanilla test 0.0013775676710060468
x1y2 mse gaussian train 0.0014286117959802082
x1y2 mse gaussian test 0.0013809272226827161
z1z2 mae vanilla train 0.0008489360334351659
z1z2 mae vanilla test 0.0009599999757483602
z1z2 mae gaussian train 0.0008844935800880194
z1z2 mae gaussian test 0.0010999999940395355
z1z2 match_prob vanilla train 0.9582566
z1z2 match_prob vanilla test 0.9529303
z1z2 match_prob gaussian train 0.9560546
z1z2 match_prob gaussian test 0.94617087
z1z2 allmatch_prob vanilla train 0.96083117
z1z2 allmatch_prob vanilla test 0.955
z1z2 allmatch_prob gaussian train 0.958331
z1z2 allmatch_prob gaussian test 0.957
[0 0 0 ... 0 0 0]
883
z1z2 xor train 0.023782559
[0 0 0 ... 0 0 0]
346
z1z2 xor test 0.028901733
[0 0 0 ... 0 0 0]
883
z1z2 compiled_action train 905.0
[0 0 0 ... 0 0 0]
346
z1z2 compiled_action test 356.0
kl_a_z0 train 1597.3669381032778
kl_a_z0 test 1431.9106567382812
x0y3 mse vanilla train 0.0012046714069727322
x0y3 mse vanilla test 0.0012619293003732607
x0y3 mse gaussian train 0.0012064017450061587
x0y3 mse gaussian test 0.0012650094336932862
z0z3 mae vanilla train 0.0007155953207984567
z0z3 mae vanilla test 0.0009399999980814755
z0z3 mae gaussian train 0.000738929957151413
z0z3 mae gaussian test 0.0009399999980814755
z0z3 match_prob vanilla train 0.96470356
z0z3 match_prob vanilla test 0.953805
z0z3 match_prob gaussian train 0.96308374
z0z3 match_prob gaussian test 0.9490403
z0z3 allmatch_prob vanilla train 0.9662203
z0z3 allmatch_prob vanilla test 0.956
z0z3 allmatch_prob gaussian train 0.965387
z0z3 allmatch_prob gaussian test 0.956
[0 0 0 ... 0 0 0]
883
z0z3 xor train 0.00792752
[0 0 0 ... 0 0 0]
346
z0z3 xor test 0.0057803467
[0 0 0 ... 0 0 0]
883
z0z3 compiled_action train 910.0
[0 0 0 ... 0 0 0]
346
z0z3 compiled_action test 357.0
action true_num_actions train 883
action true_num_actions test 346
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 2052.931076506746, 'tau': 5.0, 'pdiff_z1z2': 0.0011935113930492732, 'pdiff_z0z3': 0.0010142928833020636, 'pdiff_z0z1': 0.12227902505667887, 'pdiff_z0z2': 0.12209619160387024, 'kl_z0': 58.14121725532875, 'kl_z1': 57.25932535756144, 'kl_a_z0': 1597.3669381032778, 'kl_a_z1': 1597.3924207065866, 'kl_z1z2': 0.1662436741268617, 'kl_z0z3': 0.21246622243178037, 'x0y0': 139.14245828344224, 'x1y1': 162.02098002535243, 'x0y3': 141.66933367703913, 'x1y2': 167.53499728442895, 'elbo': 1958.3482689006812}, 'test': {'loss': 1905.026904296875, 'tau': 5.0, 'pdiff_z1z2': 0.0012690716190263628, 'pdiff_z0z3': 0.0011923516634851695, 'pdiff_z0z1': 0.12116897255182266, 'pdiff_z0z2': 0.12099040299654007, 'kl_z0': 58.2077278137207, 'kl_z1': 57.4924560546875, 'kl_a_z0': 1431.9106567382812, 'kl_a_z1': 1431.9404418945312, 'kl_z1z2': 0.20616926848888398, 'kl_z0z3': 0.238665372133255, 'x0y0': 143.50484924316407, 'x1y1': 158.41697387695314, 'x0y3': 148.40286865234376, 'x1y2': 162.00193481445314, 'elbo': 1793.92939453125}}, 'sae': {'mse': {'vanilla': {'train': 0.0012804569824360738, 'test': 0.001283681408659232}, 'gaussian': {'train': 0.0012802520928147595, 'test': 0.0012796912797414287}}, 'activation': {'train': 0.4773687422275543, 'test': 0.4787299931049347}, 'ever_1': {'train': 50.0, 'test': 50.0}, 'ever_0': {'train': 50.0, 'test': 50.0}, 'effective': {'train': 50.0, 'test': 50.0}, 'variance': {'gaussian': {'train': {'max': 0.25, 'min': 0.0, 'mean': 0.00013488525291904807, 'median': 0.0}, 'test': {'max': 0.25, 'min': 0.0, 'mean': 0.00015310000162571669, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.001280457070850356, 0.0012775412271469123, 0.001280764057869651, 0.0012775812129422596, 0.0012806523632056695, 0.0012776529218108937, 0.001280692349001017, 0.0012775412271469123, 0.001280764057869651], 'xs12': [0.001280457070850356, 2.349304486415349e-05, 2.2539901692653075e-05, 2.263403803226538e-05, 2.235912143078167e-05, 2.2539901692653075e-05, 2.263403803226538e-05, 2.235912143078167e-05, 2.2539901692653075e-05, 2.263403803226538e-05], 'xs13': [0.09128878194605401, 1.9080513084190898e-05, 9.326757208327763e-06, 1.4277953596320003e-05, 9.154728104476817e-06, 1.4065643881622236e-05, 9.310544555773959e-06, 1.412213623552816e-05, 9.098236660065595e-06, 1.4277953596320003e-05], 'xs34': [0.09129274110375973, 2.710541957640089e-05, 2.272322672070004e-05, 2.2610503947362304e-05, 2.2427850126405247e-05, 2.249470526294317e-05, 2.2610503947362304e-05, 2.2427850126405247e-05, 2.249470526294317e-05, 2.2610503947362304e-05], 'zs01': [0.0, 0.00037724318099208176, 7.444858056260273e-05, 0.00037502084160223603, 7.222623389679939e-05, 0.0003794655203819275, 7.000388723099604e-05, 0.00037724318099208176, 7.444858056260273e-05, 0.00037502084160223603], 'zs12': [0.00037724318099208176, 0.00034168566344305873, 0.00034390800283290446, 0.00034168566344305873, 0.00034168566344305873, 0.00034390800283290446, 0.00034168566344305873, 0.00034168566344305873, 0.00034390800283290446, 0.00034168566344305873], 'zs13': [0.0002539029810577631, 0.00021778987138532102, 0.00013778543507214636, 0.00021890105563215911, 0.0001366742653772235, 0.00021834546350874007, 0.00013834101264365017, 0.0002172342938138172, 0.00013778543507214636, 0.00021890105563215911], 'zs34': [0.00044502472155727446, 0.0003422412264626473, 0.0003433524107094854, 0.0003422412264626473, 0.00034168566344305873, 0.0003433524107094854, 0.0003422412264626473, 0.00034168566344305873, 0.0003433524107094854, 0.0003422412264626473]}, 'test': {'xs01': [0.0, 0.001283681496349528, 0.001276768160726415, 0.0012826958721996495, 0.001276768160726415, 0.0012826958721996495, 0.001276768160726415, 0.0012826958721996495, 0.001276768160726415, 0.0012826958721996495], 'xs12': [0.001283681496349528, 3.150239717797376e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05], 'xs13': [0.09130521989549675, 2.3507876903750002e-05, 1.169468214357039e-05, 2.0042156393174082e-05, 1.169468214357039e-05, 2.0042156393174082e-05, 1.169468214357039e-05, 2.0042156393174082e-05, 1.169468214357039e-05, 2.0042156393174082e-05], 'xs34': [0.0913098496237943, 3.394441955606453e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05, 3.0478700864478014e-05], 'zs01': [0.0, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801, 7.999999797903001e-05, 0.0004799999878741801], 'zs12': [0.0004799999878741801, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652], 'zs13': [0.00031999999191612005, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475, 0.00016999999934341758, 0.0002699999895412475], 'zs34': [0.0005699999746866524, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652, 0.0004199999966658652]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.0014246175319823, 'test': 0.0013775676710060468}, 'gaussian': {'train': 0.0014286117959802082, 'test': 0.0013809272226827161}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.0008489360334351659, 'test': 0.0009599999757483602}, 'gaussian': {'train': 0.0008844935800880194, 'test': 0.0010999999940395355}}, 'match_prob': {'vanilla': {'train': 0.9582566, 'test': 0.9529303}, 'gaussian': {'train': 0.9560546, 'test': 0.94617087}}, 'allmatch_prob': {'vanilla': {'train': 0.96083117, 'test': 0.955}, 'gaussian': {'train': 0.958331, 'test': 0.957}}, 'xor': {'train': 0.023782559, 'test': 0.028901733}, 'compiled_action': {'train': 905.0, 'test': 356.0}}, 'kl_a_z0': {'train': 1597.3669381032778, 'test': 1431.9106567382812}, 'x0y3': {'mse': {'vanilla': {'train': 0.0012046714069727322, 'test': 0.0012619293003732607}, 'gaussian': {'train': 0.0012064017450061587, 'test': 0.0012650094336932862}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.0007155953207984567, 'test': 0.0009399999980814755}, 'gaussian': {'train': 0.000738929957151413, 'test': 0.0009399999980814755}}, 'match_prob': {'vanilla': {'train': 0.96470356, 'test': 0.953805}, 'gaussian': {'train': 0.96308374, 'test': 0.9490403}}, 'allmatch_prob': {'vanilla': {'train': 0.9662203, 'test': 0.956}, 'gaussian': {'train': 0.965387, 'test': 0.956}}, 'xor': {'train': 0.00792752, 'test': 0.0057803467}, 'compiled_action': {'train': 910.0, 'test': 357.0}}, 'action': {'true_num_actions': {'train': 883, 'test': 346}}}
