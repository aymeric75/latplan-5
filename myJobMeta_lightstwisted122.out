Default float: float32
{'mode': 'report', 'type': 'twisted', 'size': 5, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-06T11:21:59.122'}
(5000, 2, 47, 47, 1)
normalized shape: (47, 47, 1) (47, 47, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1507d0714850>
[0, 47, 47, 1] -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1507d0714850>
<keras.layers.normalization.BatchNormalization object at 0x1507d04ad9d0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1507d04ad9d0>
<keras.layers.core.Dropout object at 0x1507d04ada90>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1507d04ada90>
<keras.layers.convolutional.Conv2D object at 0x1507d04adaf0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1507d04adaf0>
<keras.layers.normalization.BatchNormalization object at 0x1507d04adc10>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1507d04adc10>
<keras.layers.core.Dropout object at 0x1507d04adcd0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1507d04adcd0>
latent space shape is (47, 47, 32) : 300 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1507d06cb2e0>
[0, 47, 47, 32] -> (0, 47, 47, 32) : <keras.layers.core.Reshape object at 0x1507d06cb2e0>
<keras.layers.convolutional.Conv2DTranspose object at 0x1507d06cb310>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x1507d06cb310>
<keras.layers.normalization.BatchNormalization object at 0x1507d06cb4f0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1507d06cb4f0>
<keras.layers.core.Dropout object at 0x1507d06cba30>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1507d06cba30>
<keras.layers.convolutional.Conv2DTranspose object at 0x1507d06cb430>
(0, 47, 47, 32) -> (0, 47, 47, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x1507d06cb430>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
Compiling networks
there are 1 networks.
there are 1 optimizers.
there are 1 losses.
compiling <keras.engine.training.Model object at 0x1507acdb0430> with <keras_radam.optimizers.RAdam object at 0x1507a76f56a0>, <function BaseActionMixinAMA4Plus._build_primary.<locals>.loss at 0x1507acdb10d0>.
Network compiled
metrics train {'loss': 3212.318185763889, 'tau': 5.0, 'pdiff_z1z2': 0.047455944286452396, 'pdiff_z0z3': 0.04744045717848672, 'pdiff_z0z1': 0.0331487596862846, 'pdiff_z0z2': 0.05364714297983381, 'kl_z0': 53.14950264824761, 'kl_z1': 53.21217439439562, 'kl_a_z0': 2589.9506944444443, 'kl_a_z1': 2590.054918077257, 'kl_z1z2': 59.08857964409722, 'kl_z0z3': 59.27135721842448, 'x0y0': 25.4326907687717, 'x1y1': 26.08504727681478, 'x0y3': 47.00312669542101, 'x1y2': 42.1113154941135, 'elbo': 2733.6905883789063}
metrics test {'loss': 2299.242431640625, 'tau': 5.0, 'pdiff_z1z2': 0.047811996191740036, 'pdiff_z0z3': 0.04768093675374985, 'pdiff_z0z1': 0.03294169157743454, 'pdiff_z0z2': 0.05399296432733536, 'kl_z0': 52.96714782714844, 'kl_z1': 52.76738739013672, 'kl_a_z0': 1673.85546875, 'kl_a_z1': 1673.3345947265625, 'kl_z1z2': 59.155574798583984, 'kl_z0z3': 60.286163330078125, 'x0y0': 24.948034286499023, 'x1y1': 25.500797271728516, 'x0y3': 66.6983871459961, 'x1y2': 50.41291809082031, 'elbo': 1823.437255859375}
sae mse vanilla train 0.00023321750695462503
sae mse vanilla test 0.00022837863348481514
sae mse gaussian train 0.0002333557613224976
sae mse gaussian test 0.00022837863348706212
sae activation train 0.05453481525182724
sae activation test 0.05405333265662193
sae ever_1 train 64.0
sae ever_1 test 63.0
sae ever_0 train 300.0
sae ever_0 test 300.0
sae effective train 64.0
sae effective test 63.0
sae variance gaussian train {'max': 0.25, 'min': 0.0, 'mean': 3.4925931231555296e-06, 'median': 0.0}
sae variance gaussian test {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}
cycle_consistency train {'xs01': [0.0, 0.00023321758265568233, 0.00023321290624433622, 0.00023321758262599492, 0.00023321290628184157, 0.00023321758269528688, 0.00023321290620106485, 0.0002332175828111497, 0.00023321290618314832, 0.00023321758278217462], 'xs12': [0.00023321758265568233, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09], 'xs13': [0.09023619952644478, 7.105190036327258e-08, 5.1864833212005674e-17, 4.814547871490049e-09, 5.2703462004236436e-17, 4.814547871490049e-09, 5.166194235135867e-17, 4.814547871490049e-09, 5.2245951716155806e-17, 4.814547871490049e-09], 'xs34': [0.09023624722503967, 7.105190036327258e-08, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09], 'zs01': [0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07], 'zs12': [3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07], 'zs13': [5.555555617320351e-06, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07], 'zs34': [5.925925961491885e-06, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07]}
cycle_consistency test {'xs01': [0.0, 0.00022837870540052654, 0.00022837870915003224, 0.00022837871064631643, 0.00022837870879473197, 0.0002283787083036093, 0.00022837870686284387, 0.00022837871046226863, 0.00022837870801597674, 0.00022837871063288812], 'xs12': [0.00022837870540052654, 2.361810130674662e-15, 2.362112309678595e-15, 2.3498337200751965e-15, 2.339530411304795e-15, 2.3553440929135593e-15, 2.3649458466453973e-15, 2.3532779677969693e-15, 2.351685969372605e-15, 2.3600654545615548e-15], 'xs13': [0.0902520996728307, 2.3530003527485067e-15, 2.3584289869074595e-15, 2.3560903289400904e-15, 2.35137659058862e-15, 2.359634526549639e-15, 2.336394483575823e-15, 2.3515195273984693e-15, 2.3397614395411588e-15, 2.353561088559589e-15], 'xs34': [0.09025209965258733, 2.3453082347962536e-15, 2.366670617484244e-15, 2.3398524955829886e-15, 2.3525427431987525e-15, 2.3389518878018205e-15, 2.345199814579005e-15, 2.343735506371439e-15, 2.347291138925776e-15, 2.3546315264466816e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
x1y2 mse vanilla train 0.0003812704321908655
x1y2 mse vanilla test 0.00045643207043532836
x1y2 mse gaussian train 0.00038379837881239207
x1y2 mse gaussian test 0.00044046141459594016
z1z2 mae vanilla train 0.032539259642362595
z1z2 mae vanilla test 0.03248000144958496
z1z2 mae gaussian train 0.032544445246458054
z1z2 mae gaussian test 0.03248000144958496
z1z2 match_prob vanilla train 3.8512957e-05
z1z2 match_prob vanilla test 3.8710477e-05
z1z2 match_prob gaussian train 3.847643e-05
z1z2 match_prob gaussian test 3.8710477e-05
z1z2 allmatch_prob vanilla train 0.0
z1z2 allmatch_prob vanilla test 0.0
z1z2 allmatch_prob gaussian train 0.0
z1z2 allmatch_prob gaussian test 0.0
[0 0 0 ... 0 0 0]
1069
z1z2 xor train 0.0
[0 0 0 ... 0 0 0]
216
z1z2 xor test 0.0
[0 0 0 ... 0 0 0]
1069
z1z2 compiled_action train 1069.0
[0 0 0 ... 0 0 0]
216
z1z2 compiled_action test 216.0
kl_a_z0 train 2589.9506944444443
kl_a_z0 test 1673.85546875
x0y3 mse vanilla train 0.000425560241529932
x0y3 mse vanilla test 0.000603878594129178
x0y3 mse gaussian train 0.0004089982513930644
x0y3 mse gaussian test 0.0005919601585253747
z0z3 mae vanilla train 0.032605186104774475
z0z3 mae vanilla test 0.032280001789331436
z0z3 mae gaussian train 0.03260963037610054
z0z3 mae gaussian test 0.032280001789331436
z0z3 match_prob vanilla train 3.776163e-05
z0z3 match_prob vanilla test 4.1848743e-05
z0z3 match_prob gaussian train 3.7655835e-05
z0z3 match_prob gaussian test 4.1848743e-05
z0z3 allmatch_prob vanilla train 0.0
z0z3 allmatch_prob vanilla test 0.0
z0z3 allmatch_prob gaussian train 0.0
z0z3 allmatch_prob gaussian test 0.0
[0 0 0 ... 0 0 0]
1069
z0z3 xor train 0.0
[0 0 0 ... 0 0 0]
216
z0z3 xor test 0.0
[0 0 0 ... 0 0 0]
1069
z0z3 compiled_action train 1069.0
[0 0 0 ... 0 0 0]
216
z0z3 compiled_action test 216.0
action true_num_actions train 1069
action true_num_actions test 216
PEEEEERRRRRRRRRRFFFFOOOOOOOOORRRRRRRRRRMMMMMMMMMMMMMAAAAAAAAAAAANNNNNNNNNNCCCCCCCEEEEEEEE
{'metrics': {'train': {'loss': 3212.318185763889, 'tau': 5.0, 'pdiff_z1z2': 0.047455944286452396, 'pdiff_z0z3': 0.04744045717848672, 'pdiff_z0z1': 0.0331487596862846, 'pdiff_z0z2': 0.05364714297983381, 'kl_z0': 53.14950264824761, 'kl_z1': 53.21217439439562, 'kl_a_z0': 2589.9506944444443, 'kl_a_z1': 2590.054918077257, 'kl_z1z2': 59.08857964409722, 'kl_z0z3': 59.27135721842448, 'x0y0': 25.4326907687717, 'x1y1': 26.08504727681478, 'x0y3': 47.00312669542101, 'x1y2': 42.1113154941135, 'elbo': 2733.6905883789063}, 'test': {'loss': 2299.242431640625, 'tau': 5.0, 'pdiff_z1z2': 0.047811996191740036, 'pdiff_z0z3': 0.04768093675374985, 'pdiff_z0z1': 0.03294169157743454, 'pdiff_z0z2': 0.05399296432733536, 'kl_z0': 52.96714782714844, 'kl_z1': 52.76738739013672, 'kl_a_z0': 1673.85546875, 'kl_a_z1': 1673.3345947265625, 'kl_z1z2': 59.155574798583984, 'kl_z0z3': 60.286163330078125, 'x0y0': 24.948034286499023, 'x1y1': 25.500797271728516, 'x0y3': 66.6983871459961, 'x1y2': 50.41291809082031, 'elbo': 1823.437255859375}}, 'sae': {'mse': {'vanilla': {'train': 0.00023321750695462503, 'test': 0.00022837863348481514}, 'gaussian': {'train': 0.0002333557613224976, 'test': 0.00022837863348706212}}, 'activation': {'train': 0.05453481525182724, 'test': 0.05405333265662193}, 'ever_1': {'train': 64.0, 'test': 63.0}, 'ever_0': {'train': 300.0, 'test': 300.0}, 'effective': {'train': 64.0, 'test': 63.0}, 'variance': {'gaussian': {'train': {'max': 0.25, 'min': 0.0, 'mean': 3.4925931231555296e-06, 'median': 0.0}, 'test': {'max': 0.0, 'min': 0.0, 'mean': 0.0, 'median': 0.0}}}}, 'cycle_consistency': {'train': {'xs01': [0.0, 0.00023321758265568233, 0.00023321290624433622, 0.00023321758262599492, 0.00023321290628184157, 0.00023321758269528688, 0.00023321290620106485, 0.0002332175828111497, 0.00023321290618314832, 0.00023321758278217462], 'xs12': [0.00023321758265568233, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09], 'xs13': [0.09023619952644478, 7.105190036327258e-08, 5.1864833212005674e-17, 4.814547871490049e-09, 5.2703462004236436e-17, 4.814547871490049e-09, 5.166194235135867e-17, 4.814547871490049e-09, 5.2245951716155806e-17, 4.814547871490049e-09], 'xs34': [0.09023624722503967, 7.105190036327258e-08, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09, 4.814547871490049e-09], 'zs01': [0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07], 'zs12': [3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07], 'zs13': [5.555555617320351e-06, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07, 0.0, 3.703703725932428e-07], 'zs34': [5.925925961491885e-06, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07, 3.703703725932428e-07]}, 'test': {'xs01': [0.0, 0.00022837870540052654, 0.00022837870915003224, 0.00022837871064631643, 0.00022837870879473197, 0.0002283787083036093, 0.00022837870686284387, 0.00022837871046226863, 0.00022837870801597674, 0.00022837871063288812], 'xs12': [0.00022837870540052654, 2.361810130674662e-15, 2.362112309678595e-15, 2.3498337200751965e-15, 2.339530411304795e-15, 2.3553440929135593e-15, 2.3649458466453973e-15, 2.3532779677969693e-15, 2.351685969372605e-15, 2.3600654545615548e-15], 'xs13': [0.0902520996728307, 2.3530003527485067e-15, 2.3584289869074595e-15, 2.3560903289400904e-15, 2.35137659058862e-15, 2.359634526549639e-15, 2.336394483575823e-15, 2.3515195273984693e-15, 2.3397614395411588e-15, 2.353561088559589e-15], 'xs34': [0.09025209965258733, 2.3453082347962536e-15, 2.366670617484244e-15, 2.3398524955829886e-15, 2.3525427431987525e-15, 2.3389518878018205e-15, 2.345199814579005e-15, 2.343735506371439e-15, 2.347291138925776e-15, 2.3546315264466816e-15], 'zs01': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs12': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs13': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'zs34': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}}, 'x1y2': {'mse': {'vanilla': {'train': 0.0003812704321908655, 'test': 0.00045643207043532836}, 'gaussian': {'train': 0.00038379837881239207, 'test': 0.00044046141459594016}}}, 'z1z2': {'mae': {'vanilla': {'train': 0.032539259642362595, 'test': 0.03248000144958496}, 'gaussian': {'train': 0.032544445246458054, 'test': 0.03248000144958496}}, 'match_prob': {'vanilla': {'train': 3.8512957e-05, 'test': 3.8710477e-05}, 'gaussian': {'train': 3.847643e-05, 'test': 3.8710477e-05}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.0, 'test': 0.0}, 'compiled_action': {'train': 1069.0, 'test': 216.0}}, 'kl_a_z0': {'train': 2589.9506944444443, 'test': 1673.85546875}, 'x0y3': {'mse': {'vanilla': {'train': 0.000425560241529932, 'test': 0.000603878594129178}, 'gaussian': {'train': 0.0004089982513930644, 'test': 0.0005919601585253747}}}, 'z0z3': {'mae': {'vanilla': {'train': 0.032605186104774475, 'test': 0.032280001789331436}, 'gaussian': {'train': 0.03260963037610054, 'test': 0.032280001789331436}}, 'match_prob': {'vanilla': {'train': 3.776163e-05, 'test': 4.1848743e-05}, 'gaussian': {'train': 3.7655835e-05, 'test': 4.1848743e-05}}, 'allmatch_prob': {'vanilla': {'train': 0.0, 'test': 0.0}, 'gaussian': {'train': 0.0, 'test': 0.0}}, 'xor': {'train': 0.0, 'test': 0.0}, 'compiled_action': {'train': 1069.0, 'test': 216.0}}, 'action': {'true_num_actions': {'train': 1069, 'test': 216}}}
Default float: float32
{'mode': 'dump', 'type': 'twisted', 'size': 5, 'num_examples': 5000, 'aeclass': 'CubeSpaceAE_AMA4Conv', 'comment': 'kltune2', 'hash': '05-06T11:21:59.122'}
(5000, 2, 47, 47, 1)
normalized shape: (47, 47, 1) (47, 47, 1)
class precedence list:
  <class 'latplan.model.ConvolutionalConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.mixins.encoder_decoder.StridedConvolutionalMixin'>
  <class 'latplan.mixins.encoder_decoder.ConvolutionalMixin'>
  <class 'latplan.model.ConcreteDetNormalizedLogitAddBidirectionalTransitionAEPlus'>
  <class 'latplan.model.DetActionMixin'>
  <class 'latplan.model.NormalizedLogitAddBidirectionalMixin'>
  <class 'latplan.model.NormalizedLogitAddPreconditionMixin'>
  <class 'latplan.model.NormalizedLogitAddEffectMixin'>
  <class 'latplan.model.LogitEffectMixin'>
  <class 'latplan.model.BaseActionMixinAMA4Plus'>
  <class 'latplan.model.BidirectionalMixin'>
  <class 'latplan.model.PreconditionMixin'>
  <class 'latplan.model.EffectMixin'>
  <class 'latplan.model.BaseActionMixin'>
  <class 'latplan.model.TransitionWrapper'>
  <class 'latplan.model.StateAE'>
  <class 'latplan.mixins.latent.ConcreteLatentMixin'>
  <class 'latplan.model.EarlyStopMixin'>
  <class 'latplan.mixins.encoder_decoder.FullConnectedMixin'>
  <class 'latplan.mixins.encoder_decoder.EncoderDecoderMixin'>
  <class 'latplan.model.AE'>
  <class 'latplan.network.Network'>
  <class 'object'>
clearning tf session
cleared tf session
Loading networks from samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/ (with failure not allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1530300b9850>
[0, 47, 47, 1] -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1530300b9850>
<keras.layers.normalization.BatchNormalization object at 0x1530160cc9d0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1530160cc9d0>
<keras.layers.core.Dropout object at 0x1530160cca90>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1530160cca90>
<keras.layers.convolutional.Conv2D object at 0x1530160ccaf0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1530160ccaf0>
<keras.layers.normalization.BatchNormalization object at 0x1530160ccc10>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1530160ccc10>
<keras.layers.core.Dropout object at 0x1530160cccd0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1530160cccd0>
latent space shape is (47, 47, 32) : 300 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1530300702e0>
[0, 47, 47, 32] -> (0, 47, 47, 32) : <keras.layers.core.Reshape object at 0x1530300702e0>
<keras.layers.convolutional.Conv2DTranspose object at 0x153030070310>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x153030070310>
<keras.layers.normalization.BatchNormalization object at 0x1530300704f0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1530300704f0>
<keras.layers.core.Dropout object at 0x153030070a30>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x153030070a30>
<keras.layers.convolutional.Conv2DTranspose object at 0x153030070430>
(0, 47, 47, 32) -> (0, 47, 47, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x153030070430>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
LOADING WEIGHTS
loading additional networks
Network loaded
samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/actions.csv
[0 0 0 ... 0 0 0]
1110
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/available_actions.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_add4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_del4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_add4+ids.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_del4+ids.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_pos4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_neg4.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_pos4+ids.csv
Saving to samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/action_neg4+ids.csv
IN DUMP 1
make: Entering directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
make: Nothing to be done for 'all'.
make: Leaving directory '/g100_work/uBS21_InfGer_0/latplan-5.0.0/lisp'
Default float: float32
@[     0.364 +     0.364] loaded puzzle
Loading networks from samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/ (with failure allowed)
Building networks
building a convolutional encoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.convolutional.Conv2D object at 0x1490b0803250>
[0, 47, 47, 1] -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1490b0803250>
<keras.layers.normalization.BatchNormalization object at 0x1490b0803a60>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1490b0803a60>
<keras.layers.core.Dropout object at 0x1490b08036d0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1490b08036d0>
<keras.layers.convolutional.Conv2D object at 0x1490b0803b50>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2D object at 0x1490b0803b50>
<keras.layers.normalization.BatchNormalization object at 0x1490b07b6280>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1490b07b6280>
<keras.layers.core.Dropout object at 0x1490b07b6340>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1490b07b6340>
latent space shape is (47, 47, 32) : 300 propositions in total
building a convolutional decoder
pool per layer: 1 depth: 2 total pool: 1 H: 47 W: 47 dH: 0 dW: 0
<keras.layers.core.Reshape object at 0x1490b07b6910>
[0, 47, 47, 32] -> (0, 47, 47, 32) : <keras.layers.core.Reshape object at 0x1490b07b6910>
<keras.layers.convolutional.Conv2DTranspose object at 0x1490b07b6940>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.convolutional.Conv2DTranspose object at 0x1490b07b6940>
<keras.layers.normalization.BatchNormalization object at 0x1490b07b6b20>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.normalization.BatchNormalization object at 0x1490b07b6b20>
<keras.layers.core.Dropout object at 0x1490b07b6eb0>
(0, 47, 47, 32) -> (0, 47, 47, 32) : <keras.layers.core.Dropout object at 0x1490b07b6eb0>
<keras.layers.convolutional.Conv2DTranspose object at 0x1490b07b6a60>
(0, 47, 47, 32) -> (0, 47, 47, 1) : <keras.layers.convolutional.Conv2DTranspose object at 0x1490b07b6a60>
in _build_primary_0
in _build_primary_1
in _build_primary_2
in _build_primary_3
Network built
Building auxiliary networks
Auxiliary network built
loading additional networks
Network loaded
@[     4.995 +     4.631] loaded sae
@[     4.995 +     0.000] loaded puzzle
@[     4.995 +     0.000] loading init/goal
init (input) min: -1.0234754747926234 max: 1.7298432284194147
init (recon) min: -0.28063288 max: 0.23457415
init MSE: 0.3629470175082191
goal (input) min: -1.0234754747926234 max: 0.0
goal (recon) min: -0.27997395 max: 0.2448766
goal MSE: 0.3367017988703595
problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_init_goal_reconstruction.1.png
2 images have some panels which match 0 or >2 panels, out of which
2 images have some panels which are unlike any panels
0 images have some panels which match >2 panels
0 images have panels (all of them) which match exactly 1 panel each
Init/Goal state reconstruction failed!
But we continue anyways...
@[     9.589 +     4.594] loaded init/goal
@[     9.589 +     0.000] start planning
@[     9.589 +     0.000] start generating problem
['helper/ama3-problem.sh', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.ig', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.pddl']
helper/ama3-problem.sh problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.ig problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.pddl
@[     9.769 +     0.180] finished generating problem
@[     9.769 +     0.000] start planning
['helper/fd-latest.sh', '--search astar(blind())', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.pddl', 'samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/domain.pddl']
Running limit.sh(2853390): -t 600 -m 8000000 -- planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.pddl samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/domain.pddl
limit.sh(2853390): mem: 8000000 kB, time: 600 sec
limit.sh(2853390): pwd: /g100_work/uBS21_InfGer_0/latplan-5.0.0
limit.sh(2853390): command to execute: planner-scripts/fd-latest-clean -o '--search astar(blind())' -- problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.pddl samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/domain.pddl
limit.sh(2853390): note: time precision is 0.5 sec
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0/planner-scripts ...
finding FD installation from /g100_work/uBS21_InfGer_0/latplan-5.0.0 ...
found!: /g100_work/uBS21_InfGer_0/latplan-5.0.0/downward
common.sh(2853403): exiting...
[32;1m--------------------------------------------------------
Result:
--------------------------------------------------------[0m
limit.sh(2853390): Error occured. status: 2
@[    22.173 +    12.404] finished planning
['helper/fd-parser.awk', 'problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.log']
['main.py', 'remove_duplicates', '../samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/domain.pddl', '../problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.pddl']
SELF REQUIREMENTS
['main.py', 'remove_not_from_prob', '../samples/lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2/logs/05-06T11:21:59.122/domain.pddl', '../problem-generators/backup-propositional/vanilla/lightsout-twisted-5/007-000/ama3_samples_lightsout_twisted_5_5000_CubeSpaceAE_AMA4Conv_kltune2_logs_05-06T11:21:59.122_domain_blind_problem.pddl']
Parsing...
Parsing: [1.640s CPU, 1.642s wall-clock]
Normalizing task... [0.070s CPU, 0.068s wall-clock]
Instantiating...
Generating Datalog program... [0.040s CPU, 0.039s wall-clock]
Normalizing Datalog program...
Normalizing Datalog program: [0.040s CPU, 0.040s wall-clock]
Preparing model... [0.050s CPU, 0.055s wall-clock]
Generated 3174 rules.
Computing model... [0.010s CPU, 0.006s wall-clock]
156 relevant atoms
0 auxiliary atoms
156 final queue length
156 total queue pushes
Completing instantiation... [0.000s CPU, 0.001s wall-clock]
Instantiating: [0.140s CPU, 0.145s wall-clock]
No relaxed solution! Generating unsolvable task...
Translator variables: 1
Translator derived variables: 0
Translator facts: 2
Translator goal facts: 1
Translator mutex groups: 0
Translator total mutex groups size: 0
Translator operators: 0
Translator axioms: 0
Translator task size: 4
Translator peak memory: 149824 KB
Writing output... [0.000s CPU, 0.002s wall-clock]
Done! [1.850s CPU, 1.858s wall-clock]
Building causal graph...
The causal graph is acyclic.
1 variables of 1 necessary
0 of 0 mutex groups necessary.
0 of 0 operators necessary.
0 of 0 axiom rules necessary.
Initializing mutex computation...
Mutex computation initialized with 2 fluents.
iteration for mutex detection and operator pruning
Initialize m_index fw
Initialized mvalues forward: reached=1, notReached=1, spurious=2
Initialize m_ops fw
Computing mutexes...
Mutex computation finished with reached=1, notReached=1, spurious=2
0 operators are spurious because were not triggered
Unsolvable task in preprocessor
done
